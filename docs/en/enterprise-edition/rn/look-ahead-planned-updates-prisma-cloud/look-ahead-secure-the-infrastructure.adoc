[#ida01a4ab4-6a2c-429d-95be-86d8ac88a7b4]
== Look Ahead—Planned Updates to Secure the Infrastructure

Here are the changes planned in the next Prisma Cloud release to ensure the security of your infrastructure.

Read this section to learn about what is planned in the 25.2.1 CSPM Platform, Agentless Container Host, Agentless Host Security, CIEM, Data Security, and CDEM releases. 

The Look Ahead announcements are for an upcoming release and is not a cumulative list of all announcements.

[NOTE]
====
The details and functionalities listed below are a preview and the actual release date is subject to change.
====

//* <<announcement>>
//* <<changes-in-existing-behavior>>
* <<new-policies>>
* <<policy-updates>>
* <<iam-policy-updates>>
* <<new-compliance-benchmarks-and-updates>>
* <<api-ingestions>>
* <<deprecation-notices>>


//[#changes-in-existing-behavior]
//=== Changes in Existing Behavior

//[cols="50%a,50%a"]
//|===
//|*Feature*
//|*Description*

//|===


[#new-policies]
=== New Policies

Learn about the new policies and upcoming policy changes for new and existing Prisma Cloud System policies.

==== Access the Look Ahead for New Policies

To learn about the new policies that will be added in the next release:


. Find the Prisma Cloud policies folder on GitHub.
+
The folder contains RQL based Config, IAM, Network, and Audit Event policies in JSON format. https://github.com/PaloAltoNetworks/prisma-cloud-policies[View the GitHub repo].

. Select the branch for which you want to review policy updates.
+
The *Master* branch represents the Prisma Cloud release that is generally available. You can switch to a previous release or the next release branch, to review the policies that were published previously or are planned for the upcoming release.
+
Because Prisma Cloud typically has a monthly release, the release naming convention in GitHub is PCS-<year>.<month>.<release-chronology, 1 or 2>. For example, PCS-25.2.1.

. Review the updates.
+
Use the changelog.md file for a cumulative list of all policies that are added to a specific release. The policies are grouped by new policies and updated policies.
+
Use the *policies* folder to review the JSON for each policy that is added or updated as listed in the changelog. The filename for each policy matches the policy name listed in the changelog. Within each policy file, the JSON field names are described aptly to help you easily identify the characteristic it represents. The JSON field named searchModel.query provides the RQL for the policy.


[#policy-updates]
=== Policy Updates

[cols="50%a,50%a"]
|===
|*Policy Updates*
|*Description*

2+|*Policy Updates—RQL*

|*Azure Function App doesn't use latest TLS version*
//RLP-153936

|*Changes—* The policy description and reccomendation steps will be updated. The RQL policy will also be updated to consider the latest TLS version 1.3.

*Current Description–* 
This policy identifies Azure Function Apps that are not set with the latest version of TLS encryption. Azure currently allows the Function App to set TLS versions 1.0, 1.1, and 1.2. Using the latest TLS 1.2 version for Function App secure connections is highly recommended.

*Updated Description–*
This policy identifies Azure Function App which are not set with the latest version of TLS encryption.

Azure currently allows the Function App to set TLS versions 1.0, 1.1, 1.2, and 1.3. TLS 1.0 and 1.1 are no longer regarded as secure protocols and are deemed outdated.

As a security best practice, TLS 1.2 or above is typically advised as the minimum TLS version for Azure function apps. 

*Current RQL–* 
----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = properties.state equal ignore case "Running" AND kind contains "functionapp" AND kind does not contain "workflowapp" AND kind does not equal "app" AND config.minTlsVersion does not equal "1.2"
----

*Updated RQL–*
----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = properties.state equal ignore case "Running" AND kind contains "functionapp" AND kind does not contain "workflowapp" AND kind does not equal "app" AND config.minTlsVersion is not member of ("1.2", "1.3")
----

*Policy Type–* Config

*Policy Severity–* Low

*Impact–* Low. Existing alerts where the minTlsVersion is set to 1.3 will be resolved.

|*Azure Storage Account default network access is set to 'Allow'*
//RLP-154158

|*Changes—* The policy RQL will be updated to reduce false positives.

*Current RQL–* 
----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-storage-account-list' AND json.rule = 'networkRuleSet.defaultAction equals Allow' 
----

*Updated RQL–*
----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-storage-account-list' AND json.rule = properties.publicNetworkAccess equal ignore case "Enabled" AND networkRuleSet.defaultAction equal ignore case "Allow" 
----

*Policy Type–* Config

*Policy Severity–* Informational

*Impact–* Low. Existing alerts where the storage account is not publicly accessible from all networks will be resolved.

|*GCP Log metric filter and alert does not exist for VPC network changes*
//RLP-153451
|*Changes—* The policy description and reccomendation steps will be updated align with current standards of the policy. Also, the RQL will be updated to stay in line with the CSP changes.

*Current Description–* 
This policy identifies the GCP account which does not have a log metric filter and alert for VPC network changes. Monitoring network insertion, patching, deletion, removePeering and addPeering activities will help in identifying VPC traffic flow is not getting impacted. It is recommended to create a metric filter and alarm to detect activities related to the insertion, patching, deletion, removePeering and addPeering of VPC network.

*Updated Description–*
This policy identifies GCP accounts that do not have a log metric filter and alert for VPC network changes.

Without proper monitoring of activities like network insertions, patching, deletions, and peering modifications, organizations risk undetected misconfigurations that could compromise network security and impact traffic flow. Real-time alerts on these events are crucial for rapid response to malicious activity or accidental changes, ensuring network integrity and availability. Establishing these monitoring capabilities provides a critical layer of visibility and control over VPC network configurations.

It is recommended to create a log metric filter and alert configuration in your GCP project for VPC network changes. This will enable proactive detection of unauthorized modifications and ensure the integrity and security of your VPC network.

*Current RQL–* 
----
config from cloud.resource where api.name = 'gcloud-logging-metric' as X; config from cloud.resource where api.name = 'gcloud-monitoring-policies-list' as Y; filter '$.Y.conditions[*].metricThresholdFilter contains $.X.name and ($.X.filter contains "resource.type =" or $.X.filter contains "resource.type=") and ($.X.filter does not contain "resource.type !=" and $.X.filter does not contain "resource.type!=") and $.X.filter contains "gce_network" and ($.X.filter contains "jsonPayload.event_subtype=" or $.X.filter contains "jsonPayload.event_subtype =") and ($.X.filter does not contain "jsonPayload.event_subtype!=" and $.X.filter does not contain "jsonPayload.event_subtype !=") and $.X.filter contains "compute.networks.insert" and $.X.filter contains "compute.networks.patch" and $.X.filter contains "compute.networks.delete" and $.X.filter contains "compute.networks.removePeering" and $.X.filter contains "compute.networks.addPeering"'; show X; count(X) less than 1
----

*Updated RQL–*
----
config from cloud.resource where api.name = 'gcloud-logging-metric' as X; config from cloud.resource where api.name = 'gcloud-monitoring-policies-list' as Y; filter '$.Y.conditions[*].metricThresholdFilter contains $.X.name and ($.X.filter contains "resource.type =" or $.X.filter contains "resource.type=") and ($.X.filter does not contain "resource.type !=" and $.X.filter does not contain "resource.type!=") and $.X.filter contains "gce_network" and ((($.X.filter contains "protoPayload.methodName=" or $.X.filter contains "protoPayload.methodName =") or ($.X.filter contains "protoPayload.methodName:" or $.X.filter contains "protoPayload.methodName :")) and (($.X.filter does not contain "protoPayload.methodName!=" and $.X.filter does not contain "protoPayload.methodName !=") or ($.X.filter does not contain "protoPayload.methodName!:" and $.X.filter does not contain "protoPayload.methodName !:"))) and $.X.filter contains "compute.networks.insert" and $.X.filter contains "compute.networks.patch" and $.X.filter contains "compute.networks.delete" and $.X.filter contains "compute.networks.removePeering" and $.X.filter contains "compute.networks.addPeering"'; show X; count(X) less than 1
----

*Policy Type–* Config

*Policy Severity–* Informational

*Impact–* Low. New alerts will be generated for failing resources.

|*GCP Log metric filter and alert does not exist for VPC Network Firewall rule changes*
//RLP-153453
|*Changes—* The policy description and reccomendation steps will be updated align with current standards of the policy. Also, the RQL will be updated to stay in line with the CSP changes.

*Current Description–* 
This policy identifies the GCP account which does not have a log metric filter and alert for VPC network changes. Monitoring network insertion, patching, deletion, removePeering and addPeering activities will help in identifying VPC traffic flow is not getting impacted. It is recommended to create a metric filter and alarm to detect activities related to the insertion, patching, deletion, removePeering and addPeering of VPC network.

*Updated Description–*
This policy identifies GCP projects that do not have log metric filters and alerts for VPC Network Firewall rule modifications.

VPC Network Firewall rules govern network traffic flow, and unauthorized changes can severely impact security and availability. Without real-time monitoring and alerting on rule modifications (additions, deletions, or updates), organizations are vulnerable to undetected attacks, misconfigurations, and performance issues. Proactive alerts enable swift responses to suspicious activity, preventing breaches and ensuring business continuity. Implementing this monitoring provides crucial visibility and control over network security posture.

It is recommended to configure log metric filters and alerts within your GCP projects to monitor all VPC Network Firewall rule changes. This will enable prompt detection of unauthorized modifications, facilitating rapid remediation and maintaining the integrity and security of your network infrastructure.

*Current RQL–* 
----
config from cloud.resource where api.name = 'gcloud-logging-metric' as X; config from cloud.resource where api.name = 'gcloud-monitoring-policies-list' as Y; filter '($.Y.conditions[*].metricThresholdFilter contains $.X.name) and ($.X.filter contains "resource.type =" or $.X.filter contains "resource.type=") and ($.X.filter does not contain "resource.type !=" and $.X.filter does not contain "resource.type!=") and $.X.filter contains "gce_firewall_rule" and ($.X.filter contains "jsonPayload.event_subtype=" or $.X.filter contains "jsonPayload.event_subtype =") and ($.X.filter does not contain "jsonPayload.event_subtype!=" and $.X.filter does not contain "jsonPayload.event_subtype !=") and $.X.filter contains "compute.firewalls.patch" and $.X.filter contains "compute.firewalls.insert"'; show X; count(X) less than 1
----

*Updated RQL–*
----
config from cloud.resource where api.name = 'gcloud-logging-metric' as X; config from cloud.resource where api.name = 'gcloud-monitoring-policies-list' as Y; filter '($.Y.conditions[*].metricThresholdFilter contains $.X.name) and ($.X.filter contains "resource.type =" or $.X.filter contains "resource.type=") and ($.X.filter does not contain "resource.type !=" and $.X.filter does not contain "resource.type!=") and $.X.filter contains "gce_firewall_rule" and ((($.X.filter contains "protoPayload.methodName=" or $.X.filter contains "protoPayload.methodName =") or ($.X.filter contains "protoPayload.methodName:" or $.X.filter contains "protoPayload.methodName :")) and (($.X.filter does not contain "protoPayload.methodName!=" and $.X.filter does not contain "protoPayload.methodName !=") or ($.X.filter does not contain "protoPayload.methodName!:" and $.X.filter does not contain "protoPayload.methodName !:"))) and $.X.filter contains "compute.firewalls.patch" and $.X.filter contains "compute.firewalls.insert" and $.X.filter contains "compute.firewalls.delete"'; show X; count(X) less than 1
----

*Policy Type–* Config

*Policy Severity–* Informational

*Impact–* Low. New alerts will be generated for failing resources.


2+|*Policy Updates - Metadata*

|*Azure App service HTTP logging is disabled*
//RLP-153983

|*Changes—* The recommendation steps will be updated.

*Current Recommendation Steps–* 
1. Log in to Azure Portal
2. Go to App Services dashboard
3. Click on the reported App service
4. Under the 'Monitoring' menu, click on 'App Service logs'
5. Under 'Web server logging', select Storage to store logs on blob storage, or File System to store logs on the App Service file system.
6. In Retention Period (Days), set the number of days the logs should be retained.
7. Click on 'Save' 

As a security best practice, it is recommended to disable public network access for Azure Virtual Machine disks.

*Updated Recommendation Steps–* 

Configuring http logging via User Interface varies depending on the type of Azure App Service.

Alternatively, you may use the CLI command below to configure http logging for all kinds of Azure App Service: 

`az webapp log config --name <App name> --resource-group <Resource Group Name> --web-server-logging filesystem`

*Policy Type–* Config

*Policy Severity–* Low

*Impact–* No impact on alerts.

|*GCP Log metric filter and alert does not exist for Project Ownership assignments/changes*
//RLP-153450
|*Changes—* The policy description will be updated to better align with the policy.

*Current Description–* 
This policy identifies the GCP account which does not have a log metric filter and alert for Project Ownership assignments/changes. Project Ownership Having highest level of privileges on a project, to avoid misuse of project resources project ownership assignment/change actions mentioned should be monitored and alerted to concerned recipients.

*Updated Description–*
This policy identifies GCP projects that do not have log metric filters and alert for project ownership assignments and changes.

Project ownership grants extensive privileges. Without monitoring ownership changes, organizations risk unauthorized access, resource misappropriation, and potential security breaches. Real-time alerts on ownership transfers enable prompt detection of suspicious activity, facilitating rapid response and minimizing the impact of compromised accounts. Establishing this monitoring provides crucial visibility and control over project access, improving overall security posture.

It is recommended to configure log metric filters and alerts for project ownership changes in all GCP projects. This proactive approach ensures that any changes to project ownership are immediately flagged, allowing for timely investigation and mitigation of potential risks.

*Policy Type–* Config

*Policy Severity–* Informational

*Impact–* Low. New alerts will be generated for the failing resources.

|*GCP IAM user with service account privileges*
//RLP-153760
|*Changes—* The policy name and description will be updated to better align with the policy.

*Current Policy Name–* GCP IAM user with service account privileges

*Updated Policy Name–* GCP IAM principals with service account privileges

*Current Description–* This policy identifies IAM users which have overly permissive service account privileges. Any user should not have Service Account Admin and Service Account User, both roles assigned at a time. Built-in/Predefined IAM role Service Account admin allows the user to create, delete, manage service accounts. Built-in/Predefined IAM role Service Account User allows the user to assign service accounts to Apps/Compute Instances. It is recommended to follow the principle of 'Separation of Duties' ensuring that one individual does not have all the necessary permissions to be able to complete a malicious action or meant to help avoid security or privacy incidents and errors.

*Updated Description–* This policy identifies IAM principals which have overly permissive service account privileges.

Assigning a principals the Service account role in Google Cloud allows them to  impersonate service accounts and use their permissions. This means the principals can perform actions on behalf of the service account, essentially inheriting all permissions granted to that service account.

To maintain the security of your information and resources, it is crucial to assign this role only to authorized and trusted IAM Principals. 

*Policy Type–* Config

*Policy Severity–* Low

*Impact–* No impact on alerts.


|===


[#iam-policy-updates]
=== IAM Policy Updates
//RLP-154372

Prisma Cloud version 25.2.1 will include the following policy severity level changes based on our updated risk assessment. These changes are reflective of previously intended changes (version 24.11.1) which did not take place due to internal circumstances. The upcoming changes are outlined below.

*Impact—* Policies not included under any alert rule after the severity change, will have its alerts disappear.

[cols="70%a,15%a,15%a"]
|===
|*Policy Name*
|*Current Severity*
|*Updated Severity*

|AWS IAM effective permissions are over-privileged (7 days)
|Low
|Informational

|AWS IAM User with AWS Organization management permissions
|Low
|Informational

|AWS IAM User with IAM policy management permissions
|High
|Informational

|AWS IAM User with IAM write permissions
|Low
|Informational

|AWS Okta User with AWS Organization management permissions
|Low
|Informational

|AWS Okta User with IAM write permissions
|Low
|Informational

|Azure AD user with the Azure built-in roles of Contributor
|High
|Informational

|Azure AD user with the Azure built-in roles of Owner
|High
|Informational

|Azure AD user with the Azure built-in roles of Reader
|Low
|Informational

|Azure AD users with broad Key Vault access through Built-in Azure roles
|High
|Informational

|Azure AD users with broad Key Vault management access
|Critical
|Informational

|Azure entities with risky permissions
|Low
|Informational

|Azure IAM effective permissions are over-privileged (7 days)
|Low
|Informational

|Azure Managed Identity (user assigned or system assigned) with broad Key Vault access through Built-in Azure roles
|High
|Informational

|Azure Managed Identity (user assigned or system assigned) with broad Key Vault management access
|High
|Informational

|Azure Managed Identity (user assigned or system assigned) with the Azure built-in roles of Contributor
|High
|Informational

|Azure Managed Identity (user assigned or system assigned) with the Azure built-in roles of Owner
|High
|Informational

|Azure Managed Identity (user assigned or system assigned) with the Azure built-in roles of Reader
|Low
|Informational

|Azure Service Principals with broad Key Vault access through Built-in Azure roles
|High
|Informational

|Azure Service Principals with broad Key Vault management access
|Low
|Informational

|GCP service accounts with permissions to deploy new resources
|High
|Informational

|GCP User with IAM write access level permissions
|Low
|Informational

|GCP users with permissions to deploy new resources
|High
|Informational

|GCP users with Service Account Token Creator role
|High
|Informational

|Okta user with effective permissions to create AWS IAM users
|Low
|Informational

|AWS IAM policy allows access and decrypt Secrets Manager Secrets permissions
|Low
|Informational

|AWS EC2 instance with data destruction permissions
|High
|Low

|AWS Lateral Movement to Data Services Through Redshift Cluster Creation
|High
|Low

|AWS Okta User with IAM policy management permissions
|High
|Low

|Azure AD user with effective permissions to create AWS IAM users
|High
|Low

|GCP App Engine Web Service Assigned Cloud Function Creation Permissions Which Could Lead to Privilege Escalation
|High
|Low

|GCP App Engine Web Service Assigned Cloud Function IAM Policy Edit Permissions Which Could Lead to Privilege Escalation
|High
|Low

|GCP App Engine Web Service Assigned Cloud Run Creation Which Could Lead to Privilege Escalation
|High
|Low

|GCP App Engine Web Service Assigned Cloud Run IAM Policy Edit Permissions Which Could Lead to Privilege Escalation
|High
|Low

|GCP App Engine Web Service Assigned Cloud Run Jobs IAM Policy Edit Permissions Which Could Lead to Privilege Escalation
|High
|Low

|GCP App Engine Web Service Assigned Resource Manager Permissions Which Could Lead to Privilege Escalation
|High
|Low

|GCP Cloud Run Instance Assigned Cloud Function Creation Permissions Which Could Lead to Privilege Escalation
|High
|Low

|GCP Cloud Run Instance Assigned Cloud Function IAM Policy Edit Permissions Which Could Lead to Privilege Escalation
|High
|Low

|GCP Cloud Run Instance Assigned Cloud Run Creation Which Could Lead to Privilege Escalation
|High
|Low

|GCP Cloud Run Instance Assigned Cloud Run Jobs IAM Policy Edit Permissions Which Could Lead to Privilege Escalation
|High
|Low

|GCP Cloud Run Instance Assigned Resource Manager Permissions Which Could Lead to Privilege Escalation
|High
|Low

|GCP Cloud Run Job Public Execution via Default Compute SA Modification
|High
|Low

|GCP Compute Instance (VM/Cloud Function) Assigned Cloud Function Creation Permissions Which Could Lead to Privilege Escalation
|High
|Low

|GCP Compute Instance (VM/Cloud Function) Assigned Cloud Run IAM Policy Edit Permissions Which Could Lead to Privilege Escalation
|High
|Low

|GCP Compute Instance (VM/Cloud Function) Assigned Cloud Run Creation Permissions Which Could Lead to Privilege Escalation
|High
|Low

|GCP Compute Instance (VM/Cloud Function) Assigned Cloud Run Jobs IAM Policy Edit Permissions Which Could Lead to Privilege Escalation
|High
|Low

|GCP Compute Instance (VM/Cloud Function) Assigned Resource Manager Permissions Which Could Lead to Privilege Escalation
|High
|Low

|GCP entities with permissions to impersonate a service account in another project
|High
|Low

|GCP Lateral Access Expansion by Making Cloud Run Publicly Executable
|High
|Low

|Publicly Readable Lambda
|Medium
|Low

|Third-party service account with a Lateral Movement to Data Services Through Redshift Cluster Creation
|High
|Low

|Third-party Service Account With Lateral Movement Through CloudFormation Stack Creation
|High
|Low

|AWS Compute Instance (EC2/Lambda) Assigned CloudFormation Creation Permissions Which Could Lead to Privilege Escalation
|High
|Medium

|AWS Compute Instance (EC2/Lambda) Assigned Glue DevEndpoint Creation Permissions Which Could Lead to Privilege Escalation
|High
|Medium

|AWS Compute Instance (EC2/Lambda) Assigned Lambda Creation Permissions Which Could Lead to Privilege Escalation
|High
|Medium

|AWS Compute Instance (EC2/Lambda) Assigned Permissions to Run EC2 Instances Which Could Lead to Privilege Escalation
|High
|Medium

|AWS EC2 machine with write access permission to resource-based policies
|Low
|Medium

|AWS EC2 with IAM role attached has credentials exposure permissions
|Low
|Medium

|AWS IAM policy allows Privilege escalation via Codestar create project and associate team member permissions
|Low
|Medium

|AWS IAM policy allows Privilege escalation via EC2 describe and SSM list and send command permissions
|Low
|Medium

|AWS IAM policy allows Privilege escalation via EC2 describe and SSM session permissions
|Low
|Medium

|AWS IAM policy allows Privilege escalation via EC2 Instance Connect permissions
|Low
|Medium

|AWS IAM policy allows Privilege escalation via Glue Dev Endpoint permissions
|Low
|Medium

|AWS IAM policy allows Privilege escalation via PassRole & Lambda create & invoke Function permissions
|Low
|Medium

|AWS IAM policy allows Privilege escalation via PassRole & Lambda create Function & add permissions
|Low
|Medium

|AWS IAM policy allows Privilege escalation via PassRole & SageMaker create notebook permissions
|Low
|Medium

|AWS IAM policy allows Privilege escalation via PassRole & SageMaker create training job permissions
|Low
|Medium

|AWS Lambda Function with data destruction permissions 
|High
|Medium

|AWS Lambda with IAM role attached has credentials exposure permissions
|Low
|Medium

|Azure AD user with permissions to manage Azure permissions broadly that was not used in the last 90 days
|High
|Medium

|Azure IAM effective permissions are over-privileged (90 days)
|Low
|Medium

|Azure VM instance associated managed identities with Key Vault management access (data access is not included)
|High
|Medium

|GCP App Engine Web Service Assigned IAM Role Update Permissions Which Could Lead to Privilege Escalation
|High
|Medium

|GCP App Engine Web Service Assigned Permissions to Edit IAM Policy for Service Accounts Which Could Lead to Privilege Escalation
|High
|Medium

|GCP Cloud Run Instance Assigned Permissions to Retrieve Service Account Tokens Which Could Lead to Privilege Escalation
|High
|Medium

|GCP Compute Engine entities with predefined Admin roles
|High
|Medium

|GCP Compute Instance (VM/Cloud Function) Assigned Permissions to Retrieve Service Account Tokens Which Could Lead to Privilege Escalation
|High
|Medium

|GCP IAM effective permissions are over-privileged (90 days)
|Low
|Medium

|GCP service accounts with 'Editor' role on folder level
|High
|Medium

|GCP service accounts with 'Editor' role on org level
|High
|Medium

|GCP service accounts with 'Owner' role on folder level
|High
|Medium

|GCP service accounts with 'Owner' role on org level
|High
|Medium

|GCP VM instance with data destruction permissions
|High
|Medium

|GCP VM instance with database management write access permissions
|Low
|Medium

|GCP VM instance with permissions to impersonate a service account
|High
|Medium

|AWS EC2 instance with the creation of a new Group with attached policy permission
|Critical
|High

|AWS EC2 instance with the creation of a new Role with attached policy permission
|Critical
|High

|AWS EC2 instance with the creation of a new User with attached policy permission
|Critical
|High

|AWS S3 Bucket with Data Destruction Permissions is Publicly Accessible Through Resource-Based Policies
|Low
|High

|Azure Lateral Movement Through SSH Key Replacement and Managed Identity Exploitation on VM
|Medium
|High

|Azure Lateral Movement via VM Command Execution Leveraging Managed Identity 
|Medium
|High

|AWS EC2 instance with the creation of a new Group with attached policy permission
|Medium
|High

|Cloud Service account with high privileges is inactive for 90 days and is assigned to a resource
|Medium
|High

|Service Account with Cross Cloud Administrative Access
|Medium
|High

|Third-Party Service Account with High Privileges at the Folder or Organization Level
|Medium
|High

|User with Administrative Permissions Has Active Access Keys Which Are Unused Over 90 Days
|Medium
|High

|AWS Role With Administrative Permissions Can Be Assumed By All Users
|High
|Critical

|AWS Secret Manager Secret is Publicly Accessible Through Resource-Based Policies
|High
|Critical

|===

Additionally, the following changes will be made:

. AWS IAM policy allows access and decrypt Secrets Manager Secrets permissions
will be renamed to: AWS EC2 with access to read and decrypt Secret Manager Secrets

. AWS EC2 with IAM role with destruction permissions for AWS Key Management Service (KMS) - Will be removed. Instead, use the policy listed above.


[#new-compliance-benchmarks-and-updates]
=== New Compliance Benchmarks and Updates

[cols="50%a,50%a"]
|===
|*Compliance Benchmark*
|*Description*

|*MITRE ATT&CK v15.1 Cloud IaaS for Enterprise*

|New Mappings are added for  MITRE ATT&CK v15.1 Cloud IaaS for Enterprise. As new mappings are added compliance score may vary.


|===



[#api-ingestions]
=== API Ingestions

[cols="50%a,50%a"]
|===
|*Service*
|*API Details*


|*Amazon API Gateway*
//RLP-153376
|*aws-apigatewayv2-authorizer*

Additional permission needed:

* `apigateway:GET`

The Security Audit role includes the permission.


|*Amazon API Gateway*
//RLP-153377
|*aws-apigatewayv2-domain-name*

Additional permission needed:

* `apigateway:GET`

The Security Audit role includes the permission.


|*Amazon API Gateway*
//RLP-153378
|*aws-apigatewayv2-integration*

Additional permission needed:

* `apigateway:GET`

The Security Audit role includes the permission.

|*Amazon Cognito*
//RLP-153025
|*aws-cognito-user-pool-client*

Additional permissions needed:

* `cognito-idp:ListUserPools`
* `cognito-idp:ListUserPoolClients`
* `cognito-idp:DescribeUserPoolClient`

The Security Audit role includes the permissions.


|*Amazon CloudWatch Synthetics*
//RLP-154503
|*aws-cloudwatch-synthetics-canary*

Additional permission needed:

* `synthetics:DescribeCanaries`

The Security Audit role includes the permission.


|*Amazon DynamoDB*
//RLP-154007
|*aws-dynamo-db-global-table*

Additional permissions needed:

* `dynamodb:ListGlobalTables`
* `dynamodb:DescribeGlobalTable`

The Security Audit role includes the permissions.

|*Amazon DynamoDB*
//RLP-154419
|*aws-dynamo-db-backup*

Additional permissions needed:

* `dynamodb:ListBackups`
* `dynamodb:DescribeBackup`

The Security Audit role does not include the permissions. You must manually add the permissions to the CFT template to enable them.

|*Amazon DynamoDB*
//RLP-154485

tt:[Update]
|*aws-dynamodb-describe-table*

The attribute 'timeToLiveDescription' will be appended to this existing Prisma Cloud API.

|*Amazon EventBridge*
//RLP-154083
|*aws-event-bridge-global-endpoint*

Additional permission needed:

* `events:ListEndpoints`

The Security Audit role includes the permission.


|*Amazon EventBridge Scheduler*
//RLP-154084
|*aws-event-bridge-scheduler-schedule*

Additional permissions needed:

* `scheduler:ListSchedules`
* `scheduler:GetSchedule`

The Security Audit role does not include the permissions. You must manually add the permissions to the CFT template to enable them.


|*Amazon GuardDuty*
//RLP-154080
|*aws-guardduty-member-account-admin-info*

Additional permissions needed:

* `guardduty:ListDetectors`
* `guardduty:GetAdministratorAccount`

The Security Audit role includes the permissions.


|*Amazon GuardDuty*
//RLP-154081
|*aws-guardduty-trusted-ip-list*

Additional permissions needed:

* `guardduty:ListDetectors` 
* `guardduty:ListIPSets`
* `guardduty:GetIPSet`

The Security Audit role includes the permissions.

|*Amazon GuardDuty*
//RLP-154082
|*aws-guardduty-threat-ip-list*

Additional permissions needed:

* `guardduty:ListDetectors` 
* `guardduty:ListThreatIntelSets`
* `guardduty:GetThreatIntelSet`

The Security Audit role includes the permissions.


|*AWS IAM*
//RLP-153372
|*aws-iam-instance-profile*

Additional permissions needed:

* `iam:ListInstanceProfiles`
* `iam:GetInstanceProfile`

The Security Audit role includes the permissions.


|*AWS IAM Identity Center*
//RLP-154484
|*aws-iam-identity-center-permission-set-provisioning-status*

Additional permissions needed:

* `sso:ListInstances`
* `sso:ListPermissionSetProvisioningStatus`
* `sso:DescribePermissionSetProvisioningStatus`

The Security Audit role includes the permissions with the exception of `sso:DescribePermissionSetProvisioningStatus`.


|*AWS IAM Identity Center*
//RLP-154483
|*aws-iam-identity-center-permission-set*

Additional permissions needed:

* `sso:ListInstances`
* `sso:ListPermissionSets`
* `sso:DescribePermissionSets`

The Security Audit role includes the permissions.


|*AWS IAM Identity Center*
//RLP-154462
|*aws-iam-identity-center-application*

Additional permissions needed:

* `sso:ListInstances`
* `sso:ListApplications`
* `sso:ListApplicationAssignments`

The Security Audit role includes the permissions.


|*AWS KMS*
//RLP-154486

tt:[Update]
|*aws-kms-get-key-rotation-status*

Additional permissions needed:

* `kms:ListKeyRotations`

The Security Audit role does not include the permissions. The attributes 'nextRotationDate', 'rotationPeriodInDays' and 'previousKeyRotations'
will be appended to the existing prisma API 'aws-kms-get-key-rotation-status'.


|*AWS Lambda*
//RLP-153373
|*aws-lambda-event-source-mapping*

Additional permissions needed:

* `lambda:ListEventSourceMappings`
* `lambda:GetEventSourceMapping`

The Security Audit role includes the `lambda:ListEventSourceMappings` permission. Create a new/custom role for `lambda:GetEventSourceMapping` permissions.


|*AWS Lambda*
//RLP-153374
|*aws-lambda-get-layer-version*

Additional permissions needed:

* `lambda:ListLayers`
* `lambda:ListLayerVersions`
* `lambda:GetLayerVersion`

The Security Audit role includes the `lambda:ListLayers` permission. Create a new/custom role for the `lambda:GetLayerVersion` permission.


|*Amazon VPC Lattice*
//RLP-154086
|*aws-vpc-lattice-service*

Additional permissions needed:

* `vpc-lattice:ListServices`
* `vpc-lattice:GetService`
* `vpc-lattice:ListTagsForResource`

The Security Audit role does not include the permissions. You must manually add the permissions to the CFT template to enable them.


|*Amazon VPC Lattice*
//RLP-154085
|*aws-vpc-lattice-target-group*

Additional permissions needed:

* `vpc-lattice:ListTargetGroups
* `vpc-lattice:GetTargetGroup`
* `vpc-lattice:ListTagsForResource`

The Security Audit role does not include the permissions. You must manually add the permissions to the CFT template to enable them.


|*Amazon VPC Lattice*
//RLP-154502
|*aws-vpc-lattice-service-listener*

Additional permissions needed:

* `vpc-lattice:ListServices`
* `vpc-lattice:ListListeners` 
* `vpc-lattice:GetListener`
* `vpc-lattice:ListTagsForResource`

The Security Audit role does not include the permissions. You must manually add the permissions to the CFT template to enable them.


|*Amazon VPC Lattice*
//RLP-154499
|*aws-vpc-lattice-service-network-vpc-association*

Additional permissions needed:

* `vpc-lattice:ListServiceNetworks`
* `vpc-lattice:ListServiceNetworkVpcAssociations`
* `vpc-lattice:ListTagsForResource`

The Security Audit role does not include the permissions. You must manually add the permissions to the CFT template to enable them.

|*Amazon VPC Lattice*
//RLP-154501
|*aws-vpc-lattice-service-network-service-association*

Additional permissions needed:

* `vpc-lattice:ListServices`
* `vpc-lattice:ListServiceNetworkServiceAssociations`
* `vpc-lattice:ListTagsForResource`

The Security Audit role does not include the permissions. You must manually add the permissions to the CFT template to enable them.



|*Azure Container Registry*
//RLP-154500
|*azure-container-registry-cache-rules*

Additional permissions needed:

* `Microsoft.ContainerRegistry/registries/read`
* `Microsoft.ContainerRegistry/registries/cacheRules/read`

The Reader role includes the permissions.


|*Azure Data Protection*
//RLP-154220
|*azure-data-protection-backup-vaults*

Additional permission needed:

* `Microsoft.DataProtection/backupVaults/read`

The Reader role includes the permission.


|*Azure Data Protection*
//RLP-154223
|*azure-data-protection-backup-instances*

Additional permissions needed:

* `Microsoft.DataProtection/backupVaults/read`
* `Microsoft.DataProtection/backupVaults/backupInstances/read`

The Reader role includes the permissions.


|*Azure Data Protection*
//RLP-154225
|*azure-data-protection-backup-policies*

Additional permissions needed:

* `Microsoft.DataProtection/backupVaults/read`
* `Microsoft.DataProtection/backupVaults/backupPolicies/read`

The Reader role includes the permissions.


|*Azure Data Protection*
//RLP-154227
|*azure-data-protection-jobs*

Additional permissions needed:

* `Microsoft.DataProtection/backupVaults/read`
* `Microsoft.DataProtection/backupVaults/backupJobs/read`

The Reader role includes the permissions.


|*Azure Data Protection*
//RLP-154229
|*azure-data-protection-recovery-points*

Additional permissions needed:

* `Microsoft.DataProtection/backupVaults/read`
* `Microsoft.DataProtection/backupVaults/backupInstances/read`
* `Microsoft.DataProtection/backupVaults/backupInstances/recoveryPoints/read`

The Reader role includes the permissions.


|*Azure Network Manager*
//RLP-154459
|*azure-network-manager*

Additional permission needed:

* `Microsoft.Network/networkManagers/read`

The Reader role includes the permission.


|*Azure SQL Databases*
//RLP-154253/154255/154257

tt:[Update]
|*azure-sql-db-data-masking-policies*
*azure-sql-db-data-masking-rules*
*azure-sql-db-transparent-data-encryption*

This API now restricts data fetching to when the database is in the 'Online' or 'Ready' states. This ensures operations are only performed during these optimal states, This targeted approach prevents data fetching in any other non-active states effectively reducing costs and improving performance.

Behaviour when the database transitions into a 'Paused' state or any other non-optimal state:

* Data ingestion for affected resources is suspended.
* The deleted status for these specific resources in Prisma is set to "true".
* All alerts related to the paused resources are automatically marked as resolved during this pause.
* Upon the database's return to an 'Online' state, and when data ingestion recommences:

* The "deleted" status in Prisma is reverted to "false".
* Any alerts that were marked as resolved during the pause are reopened.


|*Google Dataproc Clusters*
//RLP-154496

|*gcloud-dataproc-serverless-batch*

Additional permissions required:

* `dataproc.batches.list`

The Viewer role includes the permission.


|*Google Dataproc Clusters*
//RLP-154497

|*gcloud-dataproc-serverless-session*

Additional permissions required:

* `dataproc.sessions.list`

The Viewer role includes the permission. 

[NOTE:]
Only ACTIVE sessions will be ingested and TERMINATED sessions will be deleted in the Prisma Cloud console.


|*Google Dataproc Clusters*
//RLP-154498

|*gcloud-dataproc-serverless-session-template*

Additional permissions required:

* `dataproc.sessionTemplates.list`

The Viewer role includes the permission.

|===


[#deprecation-notices]
=== Deprecation Notices

[cols="35%a,10%a,10%a,45%a"]
|===

|*Deprecated Endpoints or Parameters*
|*Deprecated Release*
|*Sunset Release*
|*Replacement Endpoints*



|tt:[*Audit Logs API*]
//RLP-151119

Starting from November 2024, you must transition to the new Audit Logs API. Prisma Cloud will provide a migration period of six months after which the https://pan.dev/prisma-cloud/api/cspm/rl-audit-logs/[current API] will be deprecated.

Once the deprecation period is over, you will have access to only the new API with pagination and filter support.

|24.11.1

|25.5.1

|https://pan.dev/prisma-cloud/api/cspm/get-audit-logs/[POST /audit/api/v1/log]



|tt:[*Prisma Cloud CSPM REST API for Compliance Posture*]

//RLP-120514, RLP-145823, Abinaya - They are not planning to sunset the APIs anytime soon and they want the sunset column to be left blank.

* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture/[get /compliance/posture]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture/[post /compliance/posture]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-trend/[get /compliance/posture/trend]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-trend/[post /compliance/posture/trend]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-trend-for-standard/[get /compliance/posture/trend/{complianceId}]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-trend-for-standard/[post /compliance/posture/trend/{complianceId}]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-trend-for-requirement/[get /compliance/posture/trend/{complianceId}/{requirementId}]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-trend-for-requirement/[post /compliance/posture/trend/{complianceId}/{requirementId}]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-for-standard/[get /compliance/posture/{complianceId}]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-for-standard/[post /compliance/posture/{complianceId}]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-for-requirement/[get /compliance/posture/{complianceId}/{requirementId}]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-for-requirement/[post /compliance/posture/{complianceId}/{requirementId}]

tt:[*Prisma Cloud CSPM REST API for Asset Explorer and Reports*]

* https://pan.dev/prisma-cloud/api/cspm/save-report/[post /report]
* https://pan.dev/prisma-cloud/api/cspm/get-resource-scan-info/[get /resource/scan_info]
* https://pan.dev/prisma-cloud/api/cspm/post-resource-scan-info/[post /resource/scan_info]

tt:[*Prisma Cloud CSPM REST API for Asset Inventory*]

* https://pan.dev/prisma-cloud/api/cspm/asset-inventory-v-2/[get /v2/inventory]
* https://pan.dev/prisma-cloud/api/cspm/post-method-for-asset-inventory-v-2/[post /v2/inventory]
* https://pan.dev/prisma-cloud/api/cspm/asset-inventory-trend-v-2/[get /v2/inventory/trend]
* https://pan.dev/prisma-cloud/api/cspm/post-method-asset-inventory-trend-v-2/[post /v2/inventory/trend]


|23.10.1

|NA

|tt:[*Prisma Cloud CSPM REST API for Compliance Posture*]

* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-v-2/[get /v2/compliance/posture]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-v-2/[post /v2/compliance/posture]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-trend-v-2/[get /v2/compliance/posture/trend]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-trend-v-2/[post /compliance/posture/trend]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-trend-for-standard-v-2/[get /v2/compliance/posture/trend/{complianceId}]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-trend-for-standard-v-2/[post /v2/compliance/posture/trend/{complianceId}]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-trend-for-requirement-v-2/[get /v2/compliance/posture/trend/{complianceId}/{requirementId}]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-trend-for-requirement-v-2/[post /v2/compliance/posture/trend/{complianceId}/{requirementId}]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-for-standard-v-2/[get /v2/compliance/posture/{complianceId}]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-for-standard-v-2/[post /v2/compliance/posture/{complianceId}]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-for-requirement-v-2/[get /v2/compliance/posture/{complianceId}/{requirementId}]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-for-requirement-v-2/[post /v2/compliance/posture/{complianceId}/{requirementId}]

tt:[*Prisma Cloud CSPM REST API for Asset Explorer and Reports*]

* https://pan.dev/prisma-cloud/api/cspm/save-report-v-2/[post /v2/report]
* https://pan.dev/prisma-cloud/api/cspm/get-resource-scan-info-v-2/[get /v2/resource/scan_info]
* https://pan.dev/prisma-cloud/api/cspm/post-resource-scan-info-v-2/[post /v2/resource/scan_info]

tt:[*Prisma Cloud CSPM REST API for Asset Inventory*]

* https://pan.dev/prisma-cloud/api/cspm/asset-inventory-v-3/[get /v3/inventory]
* https://pan.dev/prisma-cloud/api/cspm/post-method-for-asset-inventory-v-3/[post /v3/inventory]
* https://pan.dev/prisma-cloud/api/cspm/asset-inventory-trend-v-3/[get /v3/inventory/trend]
* https://pan.dev/prisma-cloud/api/cspm/post-method-asset-inventory-trend-v-3/[post /v3/inventory/trend]

|tt:[*Asset Explorer APIs*]
//RLP-139337
|24.8.1
|NA

|The `accountGroup` response parameter was introduced in error and is now deprecated for Get Asset - https://pan.dev/prisma-cloud/api/cspm/get-asset-details-by-id/[GET - uai/v1/asset] API endpoint.


|tt:[*Deprecation of End Timestamp in Config Search*]
//RLP-126583, suset release TBD
| - 
| - 
|The end timestamp in the date selector for Config Search will soon be deprecated after which it will be ignored for all existing RQLs. You will only need to choose a start timestamp without having to specify the end timestamp.

|tt:[*Prisma Cloud CSPM REST API for Alerts*]
//RLP-25031, RLP-25937

Some Alert API request parameters and response object properties are now deprecated.

Query parameter `risk.grade` is deprecated for the following requests:

*  `GET /alert`
*  `GET /v2/alert`
*  `GET /alert/policy` 

Request body parameter `risk.grade` is deprecated for the following requests:

*  `POST /alert`
*  `POST /v2/alert`
*  `POST /alert/policy`

Response object property `riskDetail` is deprecated for the following requests:

*  `GET /alert`
*  `POST /alert`
*  `GET /alert/policy`
*  `POST /alert/policy`
*  `GET /alert/{id}`
*  `GET /v2/alert`
*  `POST /v2/alert`

Response object property `risk.grade.options` is deprecated for the following request:

* `GET /filter/alert/suggest`

| -
| -
| NA

//tt:[*Change to Compliance Trendline and Deprecation of Compliance Filters*]
//RLP-126719, need to check if this notice can be moved to current features in 24.1.2
//- 
//- 
//To provide better performance, the *Compliance trendline* will start displaying data only from the past one year. Prisma Cloud will not retain the snapshots of data older than one year.
//The Compliance-related filters (*Compliance Requirement, Compliance Standard, and Compliance Section*) will not be available on Asset Inventory (*Inventory > Assets*).

|===