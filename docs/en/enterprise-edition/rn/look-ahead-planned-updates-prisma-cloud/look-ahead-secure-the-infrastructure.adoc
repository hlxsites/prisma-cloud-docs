[#ida01a4ab4-6a2c-429d-95be-86d8ac88a7b4]
== Look Ahead—Planned Updates to Secure the Infrastructure

Review changes planned in the next Prisma Cloud release to ensure the security of your infrastructure.

Read this section to learn about what is planned in the 24.11.1 CSPM Platform, Agentless Container Host, Agentless Host Security, CIEM, Data Security, and CDEM releases. 

The Look Ahead announcements are for an upcoming release and is not a cumulative list of all announcements.

[NOTE]
====
The details and functionalities listed below are a preview and the actual release date is subject to change.
====

//* <<announcement>>
* <<changes-in-existing-behavior>>
* <<new-policies>>
* <<policy-updates>>
//* <<iam-policy-update>>
//* <<new-compliance-benchmarks-and-updates>>
* <<api-ingestions>>
* <<deprecation-notices>>



[#changes-in-existing-behavior]
=== Changes in Existing Behavior

[cols="50%a,50%a"]
|===
|*Feature*
|*Description*


|*Audit Logs Pagination and Filter*
//RLP-151119

|Starting with the 24.11.1 release, the Audit Logs will include enhancements to improve performance, reduce data load times, and provide more granular control over data retrieval:

* The Audit Logs page will display paginated data, which will enhance navigation through extensive logs and the filtering options will provide you with more control over your log data. 

* You will also be able to use the new API to programatically leverage the new pagination and filter capabilities to streamline your use cases. 

|*Governance Dashboard and Policy Endpoint Updates*
//RLP-150508

|Starting with the 24.11.1 release, a new filter option for *Asset Type* will be added to the *Governance* page. This will allow users to filter the policy list based on the type of asset associated with the policy.

The https://pan.dev/prisma-cloud/api/cspm/get-policies-v-2/[GET /v2/policy] endpoint will have a new query parameter `resource.type` to enable filtering the policy list by asset type. The response will also include the `resource.type` to indicate the Asset Type associated with each returned policy.

The CSV download from the *Governance* page will also include a new column *Asset Type*.

|*Google Kubernetes Engine*
//RLP-150422

|Starting with the 11.1 release, the JSON resource attributes `isMasterVersionSupported` and `isNodeVersionSupported` for *gcloud-container-describe-clusters* API will be updated to align with the CSP *GetServerConfig* API. This change will provide accurate results for policy violation alerts related to the default policies— *GCP GKE unsupported Master node version* and *GCP GKE unsupported node version*.

*Impact—* No impact on existing alerts. New alerts will be generated against policy violations based on the complete GKE version used for clusters and nodes. If you have custom policies, you must manually update them to receive the alerts.

|*AWS Identity Store User Count Updates*
//RLp-151885

|Starting with the 24.11.1 release, Prisma Cloud will no longer ingest AWS Identity Store users that are visible to, but not owned by, AWS accounts. Going forward, only users directly owned by an AWS account will be ingested.

*Impact*: Any existing alerts for AWS Identity Store users in accounts that do not own the respective Identity Stores will be automatically closed.


// |*GCP API Update*
//RLP-150422 (Older version of blurb above, remove after confirming)

// |*API*: gcloud-container-describe-clusters

// *Change*: The Prisma cloud API will be updated to compute attributes `isMasterVersionSupported` and `isNodeVersionSupported` to provide results based on the latest improvements made by the GCP team with respect to the GetServerConfig API. This enhancement is planned to provide more accurate results for the alerts based on the default policies.

// *Issue*: The default policies GCP GKE unsupported Master node version and GCP GKE unsupported node version are currently checking the GCP GKE version based on major and minor values. To provide accurate results, we are enhancing the Prisma API attribute to compare complete versions from the GCP API.

//*Impact*: New alerts might be triggered based on the complete GKE version used for clusters and nodes.If you have custom policies, you must manually update them to check using the updated attribute.


|*Rate Limits — RQL Service APIs*
//RLP-151274

|Starting with the 24.12.1 release, to improve Prisma Cloud performance, rate limits will be implemented for the RQL service APIs.

*Impact—* Requests exceeding the limits will result in an *HTTP 429* Too Many Requests response.

|===


[#new-policies]
=== New Policies

Learn about the new policies and upcoming policy changes for new and existing Prisma Cloud System policies.

==== Access the Look Ahead for New Policies

To learn about the new policies that will be added in the next release:


. Find the Prisma Cloud policies folder on GitHub.
+
The folder contains RQL based Config, IAM, Network, and Audit Event policies in JSON format. https://github.com/PaloAltoNetworks/prisma-cloud-policies[View the GitHub repo].

. Select the branch for which you want to review policy updates.
+
The *Master* branch represents the Prisma Cloud release that is generally available. You can switch to a previous release or the next release branch, to review the policies that were published previously or are planned for the upcoming release.
+
Because Prisma Cloud typically has 2 releases in a month, the release naming convention in GitHub is PCS-<year>.<month>.<release-chronology, 1 or 2>. For example, PCS-24.11.1.

. Review the updates.
+
Use the changelog.md file for a cumulative list of all policies that are added to a specific release. The policies are grouped by new policies and updated policies.
+
Use the *policies* folder to review the JSON for each policy that is added or updated as listed in the changelog. The filename for each policy matches the policy name listed in the changelog. Within each policy file, the JSON field names are described aptly to help you easily identify the characteristic it represents. The JSON field named searchModel.query provides the RQL for the policy.


[#policy-updates]
=== Policy Updates

[cols="35%a,65%a"]
|===
|*Policy Updates*
|*Description*

|*AWS KMS Key policy overly permissive*
//RLP-151215

|The RQL will be updated to consider the `effect` field, which also defines whether the Key policy is overly permissive. 

*Current RQL–*: 
----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-kms-get-key-rotation-status' AND json.rule = keyMetadata.keyState equals Enabled and policies.default.Statement[?any(Principal.AWS equals * and Condition does not exist)] exists
----

*Updated RQL–*:
----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-kms-get-key-rotation-status' AND json.rule = keyMetadata.keyState equals Enabled and policies.default.Statement[?any(Principal.AWS equals * and Effect equal ignore case allow and Condition does not exist)] exists
----

*Policy Type*: Config

*Policy Severity*: Medium

*Alert Impact*: Low

*Impact*:  Open alerts where the key policy contains effect as `Deny` will be resolved.


|*AWS MFA not enabled for IAM users*
//RLP-151568

|The RQL will be updated to exclude alerting for root users. 

*Current RQL–*: 
----
config from cloud.resource where cloud.type = 'aws' and api.name='aws-iam-get-credential-report' AND json.rule='password_enabled equals true and mfa_active is false'
----

*Updated RQL–*:
----
config from cloud.resource where cloud.type = 'aws' and api.name='aws-iam-get-credential-report' AND json.rule='user does not equal "<root_account>" and password_enabled equals true and mfa_active is false'
----

*Policy Type*: Config

*Policy Severity*: Low

*Alert Impact*: Low

*Impact*: Open Alerts for root users will be resolved.


|*Azure DNS Zone having dangling DNS Record vulnerable to subdomain takeover associated with Web App Service*
//RLP-152208

|The policy that flags Azure DNS zones with dangling DNS records will be updated. This change will prevent false positives for stopped resources and ensure only genuine vulnerabilities are flagged.

*Current RQL–*: 
----
config from cloud.resource where api.name = 'azure-dns-recordsets' AND json.rule = type contains CNAME and properties.CNAMERecord.cname contains "azurewebsites.net" as X; config from cloud.resource where api.name = 'azure-app-service' AND json.rule = properties.state equal ignore case Running as Y;  filter 'not ($.Y.properties.hostNames contains $.X.properties.CNAMERecord.cname) '; show X;
----

*Updated RQL–*:
----
config from cloud.resource where api.name = 'azure-dns-recordsets' AND json.rule = type contains CNAME and properties.CNAMERecord.cname contains "azurewebsites.net" as X; config from cloud.resource where api.name = 'azure-app-service' as Y; filter 'not ($.Y.properties.hostNames contains $.X.properties.CNAMERecord.cname) '; show X;
----

*Policy Type*: Config

*Policy Severity*: High

*Alert Impact*: Low

*Impact*: Alerts will be reduced as existing false positives will be resolved as `Policy Updated`.


|*Azure Logic App configured with public network access*
//RLP-150603

|RQL will be updated to avoid false positives in case the Logic App has public access disabled using default behavior with a private endpoint configured.

*Current RQL–*: 
----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = 'properties.state equal ignore case running and kind contains workflowapp and ((properties.publicNetworkAccess exists and properties.publicNetworkAccess equal ignore case Enabled) or (properties.publicNetworkAccess does not exist)) and config.ipSecurityRestrictions[?any((action equals Allow and ipAddress equals Any) or (action equals Allow and ipAddress equals 0.0.0.0/0))] exists'
----

*Updated RQL–*:
----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = 'properties.state equal ignore case running and kind contains workflowapp and ((properties.publicNetworkAccess exists and properties.publicNetworkAccess equal ignore case Enabled) or (properties.publicNetworkAccess does not exist and (properties.privateLinkIdentifiers does not exist or properties.privateLinkIdentifiers is empty))) and config.ipSecurityRestrictions[?any((action equals Allow and ipAddress equals Any) or (action equals Allow and ipAddress equals 0.0.0.0/0))] exists'
----

*Policy Type*: Config

*Policy Severity*: Medium

*Alert Impact*: Low

*Impact*: Open alerts on the Logic App have public access disabled using default behavior with a private endpoint configured will be resolved.


|*GCP SQL Instances do not have valid SSL configuration*
//RLP-150532

|*Current Policy Description–*

This policy identifies GCP SQL instances that do not have valid SSL configuration with an unexpired SSL certificate. Cloud SQL supports connecting to an instance using the Secure Socket Layer (SSL) protocol. If Cloud SQL Auth proxy is not used for authentication, it is recommended to utilize SSL for connection to SQL Instance, ensuring the security for data in transit.

*Updated Policy Description–*

This policy identifies GCP SQL instances that either lack SSL configuration or have SSL certificates that have expired.

If an SQL instance is not configured to use SSL, it may accept unencrypted and insecure connections, leading to potential risks such as data interception and authentication vulnerabilities.

It is a best practice to enable SSL configuration to ensure data security and integrity when communicating with a GCP SQL instance.

*Current Policy RQL–*
----
config from cloud.resource where cloud.type = 'gcp' AND api.name='gcloud-sql-instances-list' and json.rule = "(settings.ipConfiguration.requireSsl is true and _DateTime.ageInDays(serverCaCert.expirationTime) > -1) or not (settings.ipConfiguration.requireSsl is true)"
----
*Updated Policy RQL–*
----
config from cloud.resource where cloud.type = 'gcp' AND api.name='gcloud-sql-instances-list' and json.rule = "(settings.ipConfiguration.sslMode equal ignore case TRUSTED_CLIENT_CERTIFICATE_REQUIRED and _DateTime.ageInDays(serverCaCert.expirationTime) > -1) or settings.ipConfiguration.sslMode equal ignore case ALLOW_UNENCRYPTED_AND_ENCRYPTED"
----
 
*Policy Type*: Config

*Policy Severity*: Low

*Impact*: 

Low. Alerts will be triggered in case the SQL instance is configured with SSL mode as ALLOW_UNENCRYPTED_AND_ENCRYPTED or TRUSTED_CLIENT_CERTIFICATE_REQUIRED with expired certificate

Open Alerts will be resolved in case the SQL instance is configured with SSL mode as ENCRYPTED_ONLY or TRUSTED_CLIENT_CERTIFICATE_REQUIRED with valid certificate. 

|===


[#iam-policy-update]
=== IAM Policy Updates

The policy *Severity* levels for the following IAM policies will be adjusted to better align with the potential risks they pose.

*Impact—* If your alert rules use the *Policy Severity* filter, you may notice a slight change in the number of alerts. However, this change will not affect custom policies or policies where you have manually set the severity levels. For policies included in alert rules that are not based on severity, the number of alerts will remain unchanged.

If you have any questions, reach out to your Prisma Cloud Customer Success Representative.

[cols="70%a,15%a,15%a"]
|===
|*Policy Name*
|*Current Severity*
|*Updated Severity*

|AWS IAM effective permissions are over-privileged (7 days) 
|Low 
|Informational 

|AWS IAM User with AWS Organization management permissions 
|Low 
|Informational 

|AWS IAM User with IAM policy management permissions 
|High 
|Informational 

|AWS IAM User with IAM write permissions 
|Low 
|Informational 

|AWS Okta User with AWS Organization management permissions 
|Low 
|Informational 

|AWS Okta User with IAM write permissions 
|Low 
|Informational 

|Azure AD user with the Azure built-in roles of Contributor 
|High 
|Informational 

|Azure AD user with the Azure built-in roles of Owner 
|High 
|Informational 

|Azure AD user with the Azure built-in roles of Reader 
|Low 
|Informational 

|Azure AD users with broad Key Vault access through Built-in Azure roles 
|High 
|Informational 

|Azure AD users with broad Key Vault management access 
|Critical 
|Informational 

|Azure entities with risky permissions 
|Low 
|Informational 

|Azure IAM effective permissions are over-privileged (7 days) 
|Low 
|Informational 

|Azure Managed Identity (user assigned or system assigned) with broad Key Vault access through Built-in Azure roles 
|High 
|Informational 

|Azure Managed Identity (user assigned or system assigned) with broad Key Vault management access 
|High 
|Informational 

|Azure Managed Identity (user assigned or system assigned) with the Azure built-in roles of Contributor 
|High 
|Informational 

|Azure Managed Identity (user assigned or system assigned) with the Azure built-in roles of Owner 
|High 
|Informational 

|Azure Managed Identity (user assigned or system assigned) with the Azure built-in roles of Reader 
|Low 
|Informational 

|Azure Service Principals with broad Key Vault access through Built-in Azure roles 
|High 
|Informational 

|Azure Service Principals with broad Key Vault management access 
|Low 
|Informational 

|GCP IAM effective permissions are over-privileged (7 days) 
|Low 
|Informational 

|GCP service accounts with permissions to deploy new resources 
|High 
|Informational 

|GCP User with IAM write access level permissions 
|Low 
|Informational 

|GCP users with permissions to deploy new resources 
|High 
|Informational 

|GCP users with Service Account Token Creator role 
|High 
|Informational 

|Okta user with effective permissions to create AWS IAM users 
|Low 
|Informational 

|AWS EC2 instance with data destruction permissions 
|High 
|Low 

|AWS EC2 instance with privilege escalation risk permissions 
|High 
|Low 

|AWS Lateral Movement to Data Services Through Redshift Cluster Creation 
|High 
|Low 

|AWS Okta User with IAM policy management permissions 
|High 
|Low 

|Azure AD user with effective permissions to create AWS IAM users 
|High 
|Low 

|Azure VM associated with entities that have risky permissions 
|High 
|Low 

|GCP App Engine Web Service Assigned Cloud Function Creation Permissions Which Could Lead to Privilege Escalation 
|High 
|Low 

|GCP App Engine Web Service Assigned Cloud Function IAM Policy Edit Permissions Which Could Lead to Privilege Escalation 
|High 
|Low 

|GCP App Engine Web Service Assigned Cloud Run Creation Which Could Lead to Privilege Escalation 
|High 
|Low 

|GCP App Engine Web Service Assigned Cloud Run IAM Policy Edit Permissions Which Could Lead to Privilege Escalation 
|High 
|Low 

|GCP App Engine Web Service Assigned Cloud Run Jobs IAM Policy Edit Permissions Which Could Lead to Privilege Escalation 
|High 
|Low 

|GCP App Engine Web Service Assigned Resource Manager Permissions Which Could Lead to Privilege Escalation 
|High 
|Low 

|GCP Cloud Run Instance Assigned Cloud Function Creation Permissions Which Could Lead to Privilege Escalation 
|High 
|Low 

|GCP Cloud Run Instance Assigned Cloud Function IAM Policy Edit Permissions Which Could Lead to Privilege Escalation 
|High 
|Low 

|GCP Cloud Run Instance Assigned Cloud Run Creation Which Could Lead to Privilege Escalation 
|High 
|Low 

|GCP Cloud Run Instance Assigned Cloud Run Jobs IAM Policy Edit Permissions Which Could Lead to Privilege Escalation 
|High 
|Low 

|GCP Cloud Run Instance Assigned Resource Manager Permissions Which Could Lead to Privilege Escalation 
|High 
|Low 

|GCP Cloud Run Job Public Execution via Default Compute SA Modification 
|High 
|Low 

|GCP Compute Instance (VM/Cloud Function) Assigned Cloud Function Creation Permissions Which Could Lead to Privilege Escalation 
|High 
|Low 

|GCP Compute Instance (VM/Cloud Function) Assigned Cloud Run Creation Permissions Which Could Lead to Privilege Escalation 
|High 
|Low 

|GCP Compute Instance (VM/Cloud Function) Assigned Cloud Run IAM Policy Edit Permissions Which Could Lead to Privilege Escalation 
|High 
|Low 

|GCP Compute Instance (VM/Cloud Function) Assigned Cloud Run Jobs IAM Policy Edit Permissions Which Could Lead to Privilege Escalation 
|High 
|Low 

|GCP Compute Instance (VM/Cloud Function) Assigned Resource Manager Permissions Which Could Lead to Privilege Escalation 
|High 
|Low 

|GCP entities with permissions to impersonate a service account in another project 
|High 
|Low 

|GCP Lateral Access Expansion by Making Cloud Run Publicly Executable 
|High 
|Low 

|Publicly Readable Lambda 
|Medium 
|Low 

|Third-party service account with a Lateral Movement to Data Services Through Redshift Cluster Creation 
|High 
|Low 

|Third-party Service Account With Lateral Movement Through CloudFormation Stack Creation 
|High 
|Low 

|AWS Compute Instance (EC2/Lambda) Assigned CloudFormation Creation Permissions Which Could Lead to Privilege Escalation 
|High 
|Medium 

|AWS Compute Instance (EC2/Lambda) Assigned Glue DevEndpoint Creation Permissions Which Could Lead to Privilege Escalation 
|High 
|Medium 

|AWS Compute Instance (EC2/Lambda) Assigned Lambda Creation Permissions Which Could Lead to Privilege Escalation 
|High 
|Medium 

|AWS Compute Instance (EC2/Lambda) Assigned Permissions to Run EC2 Instances Which Could Lead to Privilege Escalation 
|High 
|Medium 

|AWS EC2 machine with write access permission to resource-based policies 
|Low 
|Medium 

|AWS EC2 with IAM role attached has credentials exposure permissions 
|Low 
|Medium 

|AWS IAM policy allows Privilege escalation via Codestar create project and associate team member permissions 
|Low 
|Medium 

|AWS IAM policy allows Privilege escalation via EC2 describe and SSM list and send command permissions 
|Low 
|Medium 

|AWS IAM policy allows Privilege escalation via EC2 describe and SSM session permissions 
|Low 
|Medium 

|AWS IAM policy allows Privilege escalation via EC2 Instance Connect permissions 
|Low 
|Medium 

|AWS IAM policy allows Privilege escalation via Glue Dev Endpoint permissions 
|Low 
|Medium 

|AWS IAM policy allows Privilege escalation via PassRole & Lambda create & invoke Function permissions 
|Low 
|Medium 

|AWS IAM policy allows Privilege escalation via PassRole & Lambda create Function & add permissions 
|Low 
|Medium 

|AWS IAM policy allows Privilege escalation via PassRole & SageMaker create notebook permissions 
|Low 
|Medium 

|AWS IAM policy allows Privilege escalation via PassRole & SageMaker create processing job permissions 
|Low 
|Medium 

|AWS IAM policy allows Privilege escalation via PassRole & SageMaker create training job permissions 
|Low 
|Medium 

|AWS Lambda Function with data destruction permissions 
|High 
|Medium 

|AWS Lambda with IAM role attached has credentials exposure permissions 
|Low 
|Medium 

|Azure AD user with permissions to manage Azure permissions broadly that was not used in the last 90 days 
|High 
|Medium 

|Azure IAM effective permissions are over-privileged (90 days) 
|Low 
|Medium 

|Azure VM instance associated managed identities with Key Vault management access (data access is not included) 
|High 
|Medium 

|Azure VM instance with data destruction permissions 
|High 
|Medium 

|GCP App Engine Web Service Assigned IAM Role Update Permissions Which Could Lead to Privilege Escalation 
|High 
|Medium 

|GCP App Engine Web Service Assigned Permissions to Edit IAM Policy for Service Accounts Which Could Lead to Privilege Escalation 
|High 
|Medium 

|GCP Cloud Run Instance Assigned Permissions to Retrieve Service Account Tokens Which Could Lead to Privilege Escalation 
|High 
|Medium 

|GCP Compute Engine entities with predefined Admin roles 
|High 
|Medium 

|GCP Compute Instance (VM/Cloud Function) Assigned Permissions to Retrieve Service Account Tokens Which Could Lead to Privilege Escalation 
|High 
|Medium 

|GCP IAM effective permissions are over-privileged (90 days) 
|Low 
|Medium 

|GCP service accounts with 'Editor' role on folder level 
|High 
|Medium 

|GCP service accounts with 'Editor' role on org level 
|High 
|Medium 

|GCP service accounts with 'Owner' role on folder level 
|High 
|Medium 

|GCP service accounts with 'Owner' role on org level 
|High 
|Medium 

|GCP VM instance with data destruction permissions 
|High 
|Medium 

|GCP VM instance with database management write access permissions 
|Low 
|Medium 

|GCP VM instance with permissions to impersonate a service account 
|High 
|Medium 

|AWS EC2 instance with the creation of a new Group with attached policy permission 
|Critical 
|High 

|AWS EC2 instance with the creation of a new Role with attached policy permission 
|Critical 
|High 

|AWS EC2 instance with the creation of a new User with attached policy permission 
|Critical 
|High 

|AWS IAM policy allows access and decrypt Secrets Manager Secrets permissions 
|Low 
|High 

|AWS S3 Bucket with Data Destruction Permissions is Publicly Accessible Through Resource-Based Policies 
|Low 
|High 

|Azure Lateral Movement Through SSH Key Replacement and Managed Identity Exploitation on VM 
|Medium 
|High 

|Azure Lateral Movement via VM Command Execution Leveraging Managed Identity 
|Medium 
|High 

|Cloud Service account with high privileges is inactive for 90 days and is assigned to a resource 
|Medium 
|High 

|Service Account with Cross Cloud Administrative Access 
|Medium 
|High 

|Third-Party Service Account with High Privileges at the Folder or Organization Level 
|Medium 
|High 

|User with Administrative Permissions Has Active Access Keys Which Are Unused Over 90 Days 
|Medium 
|High 

|AWS Role With Administrative Permissions Can Be Assumed By All Users 
|High 
|Critical 

|AWS Secret Manager Secret is Publicly Accessible Through Resource-Based Policies 
|High 
|Critical 

|===

//[#new-compliance-benchmarks-and-updates]
//=== New Compliance Benchmarks and Updates

//[cols="50%a,50%a"]
//|===
//|*Compliance Benchmark*
//|*Description*



//|===

[#api-ingestions]
=== API Ingestions


[cols="50%a,50%a"]
|===
|*Service*
|*API Details*


|*Amazon AppStream 2.0*
//RLP-131272

|*aws-app-stream-image*

Additional permission required:

* `appstream:DescribeImages`

The Security Audit role does not include the above permission.

|*Amazon AppStream 2.0*
//RLP-131580

|*aws-app-stream-image-builder*

Additional permission required:

* `appstream:DescribeImageBuilders`

The Security Audit role does not include the above permission.


|*AWS Lake Formation*
//RLP-145943

|*aws-lake-formation-lf-tags*

Additional permissions required:

* `lakeformation:ListLFTags`
* `lakeformation:GetLFTag`

The Security Audit role does not include the above permissions.

|*AWS Lake Formation*
//RLP-145948

|*aws-lake-formation-resource*

Additional permissions required:

* `lakeformation:DescribeResource`
* `lakeformation:ListResources`

The Security Audit role does not include the above permissions.


|*AWS Lake Formation*
//RLP-145953

|*aws-lake-formation-permission*

Additional permission required:

* `lakeformation:ListPermissions`

The Security Audit role does not include the above permission.


|*AWS KMS*
//RLP-147125

|*aws-kms-grant*

Additional permissions required:

* `kms:ListKeys`
* `kms:ListGrants`

The Security Audit role includes the above permissions.


|*Amazon Comprehend*
//RLP-149186

|*aws-comprehend-flywheel*

Additional permissions required:

* `comprehend:ListFlywheels`
* `comprehend:DescribeFlywheel`
* `comprehend:ListTagsForResource`

The Security Audit role includes the above permissions.

|*AWS Elastic Disaster Recovery*
//RLP-149199

|*aws-drs-source-network*

Additional permission required:

* `drs:DescribeSourceNetworks`

The Security Audit role does not include the above permission.

|*AWS Control Tower*
//RLP-149201

|*aws-controltower-landing-zone*

Additional permissions required:

* `controltower:ListLandingZones`
* `controltower:GetLandingZone`
* `controltower:ListTagsForResource`

The Security Audit role does not include the above permissions.

|*Amazon DataZone*
//RLP-145162

|*aws-datazone-domain*

Additional permissions required:

* `datazone:ListDomains`
* `datazone:GetDomain`

The Security Audit role does not include the above permissions.

|*Amazon QuickSight*
//RLP-147089

|*aws-quicksight-ip-restriction*

Additional permission required:

* `quicksight:DescribeIpRestriction`

The Security Audit role includes the above permission.


|*Amazon Cognito*
//RLP-149194

|*aws-cognito-user-pool*

This API has been updated to include the following new field in the resource JSON:

* `mfaConfiguration`


|*AWS Signer*
//RLP-149946

|*aws-signer-signing-job*

Additional permissions required:

* `signer:ListSigningJobs`
* `signer:DescribeSigningJob`

The Security Audit role does not includes the above permissions.


|*AWS Fault Injection Service*
//RLP-149964

|*aws-fis-experiment*

Additional permissions required:

* `fis:ListExperiments`
* `fis:GetExperiment`

The Security Audit role does not include the above permissions.


|*AWS CodeDeploy*
//RLP-149984

|*aws-code-deploy-deployment-instance*

Additional permissions required:

* `codedeploy:ListDeployments`
* `codedeploy:ListDeploymentTargets`
* `codedeploy:BatchGetDeploymentTargets`

The Security Audit role includes the above permissions.


|*Amazon DataZone*
//RLP-150946

|*aws-datazone-data-source*

Additional permissions required:

* `datazone:ListDomains`
* `datazone:ListProjects`
* `datazone:ListDataSources`
* `datazone:GetDataSource`

The Security Audit role includes the above permissions.


|*Amazon EC2*
//RLP-151029

|*aws-ec2-reserved-instance*

Additional permission required:

* `ec2:DescribeReservedInstances`

The Security Audit role includes the above permission.


|*Amazon DocumentDB*
//RLP-151030

|*aws-docdb-db-instance*

Additional permissions required:

* `rds:DescribeDBInstances`
* `rds:ListTagsForResource`

The Security Audit role includes the above permissions.


|*Amazon EventBridge*
//RLP-151031

|*aws-events-api-destination*

Additional permission required:

* `events:ListApiDestinations`

The Security Audit role includes the above permission.


|*Azure Event Grid*
//RLP-148912

|*azure-event-grid-topic-diagnostic-settings*

Additional permissions required:

* `Microsoft.EventGrid/topics/read`
* `Microsoft.Insights/DiagnosticSettings/Read`

The Reader role includes the above permissions.

|*Azure Kusto*
//RLP-148923

|*azure-kusto-clusters-diagnostic-settings*

Additional permissions required:

* `Microsoft.Kusto/clusters/read`
* `Microsoft.Insights/DiagnosticSettings/Read`

The Reader role includes the above permissions.

|*Azure Synapse Analytics*
//RLP-148928

|*azure-synapse-workspace-sql-pools-geo-backup-policies*

Additional permissions required:

* `Microsoft.Synapse/workspaces/read`
* `Microsoft.Synapse/workspaces/sqlPools/read`
* `Microsoft.Synapse/workspaces/sqlPools/geoBackupPolicies/read`

The Reader role includes the above permissions.

|*Azure Database for PostgreSQL*
//RLP-148932

|*azure-postgresql-flexible-server-database*

Additional permissions required:

* `Microsoft.DBforPostgreSQL/flexibleServers/read`
* `Microsoft.DBforPostgreSQL/flexibleServers/databases/read`

The Reader role includes the above permissions.

|*Azure Database for MySQL*
//RLP-148935

|*azure-mysql-flexible-server-database*

Additional permissions required:

* `Microsoft.DBforMySQL/flexibleServers/read`
* `Microsoft.DBforMySQL/flexibleServers/databases/read`

The Reader role includes the above permissions.


|*Azure SQL Database*
//RLP-149746

|*azure-sql-db-transparent-data-encryption*

Additional permissions required:

* `Microsoft.Sql/managedInstances/read`
* `Microsoft.Sql/managedInstances/databases/read`
* `Microsoft.Sql/managedInstances/databases/transparentDataEncryption/read`

The Reader role includes the above permissions.


|*Azure API Management Service*
//RLP-151219

|*azure-api-management-service-identity-provider*

Additional permissions required:

* `Microsoft.ApiManagement/service/read`
* `Microsoft.ApiManagement/service/identityProviders/read`

The Reader role includes the above permissions.


|*Azure API Management Service*
//RLP-151222

|*azure-api-management-service-alert-rules*

Additional permission required:

* `Microsoft.Insights/MetricAlerts/Read`

The Reader role includes the above permission.


|*Azure API Management Service*
//RLP-151308

|*azure-api-management-service-products*

Additional permissions required:

* `Microsoft.ApiManagement/service/read`
* `Microsoft.ApiManagement/service/products/read`

The Reader role includes the above permissions.


|*Azure API Management Service*
//RLP-151313

|*azure-api-management-service-api-policy*

Additional permissions required:

* `Microsoft.ApiManagement/service/read`
* `Microsoft.ApiManagement/service/apis/read`
* `Microsoft.ApiManagement/service/apis/policies/read`

The Reader role includes the above permissions.


|*Azure API Management Service*
//RLP-151317

|*azure-api-management-service-product-policy*

Additional permissions required:

* `Microsoft.ApiManagement/service/read`
* `Microsoft.ApiManagement/service/products/read`
* `Microsoft.ApiManagement/service/products/policies/read`

The Reader role includes the above permissions.

|*Azure API Management Services*
//RLP-151338

|*azure-api-management-service-api-diagnostics*

Additional permissions required:

* `Microsoft.ApiManagement/service/read`
* `Microsoft.ApiManagement/service/apis/diagnostics/read`

The Reader role includes the above permissions.


|*Google Cloud VM Manager*
//RLP-149002

|*gcloud-vm-manager-patch-deployment*

Additional permission required:

* `osconfig.patchDeployments.list`

The Viewer role includes the above permission.


|*Google Cloud VM Manager*
//RLP-149029

|*gcloud-vm-manager-feature-settings*

Additional permission required:

* `osconfig.projectFeatureSettings.get`

The Viewer role includes the above permission.


|*Google Cloud Dataflow*
//RLP-149030

|*gcloud-dataflow-job*

Additional permission required:

* `dataflow.jobs.list`

The Viewer role includes the above permission.


|*Google Cloud Dataflow Data Pipeline*
//RLP-149031

|*gcloud-dataflow-data-pipeline*

Additional permission required:

* `datapipelines.pipelines.list`

The Viewer role includes the above permission.


|*Google Cloud Memorystore*
//RLP-149032

|*gcloud-redis-cluster*

Additional permission required:

* `redis.clusters.list`

The Viewer role includes the above permission.


|*Google Cloud Storage*
//RLP-150324

|*gcloud-storage-hmac-key*

Additional permission required:

* `storage.hmacKeys.list`

The Viewer role includes the above permission.


|*Google Service Infrastructure Service Management*
//RLP-150325

|*gcloud-service-management-managed-service*

Additional permissions required:

* `servicemanagement.services.list` 
* `servicemanagement.services.getIamPolicy` 
* `servicemanagement.services.get`

The Service Management Administrator role includes the above permissions.


|*Google Cloud SQL*
//RLP-150326

|*gcloud-sql-instance-database*

Additional permissions required:

* `cloudsql.instances.list`
* `cloudsql.databases.list`

The Viewer role includes the above permissions.


|*Google Cloud SQL*
//RLP-150327

|*gcloud-sql-instance-backup-run*

Additional permissions required:

* `cloudsql.instances.list`
* `cloudsql.backupRuns.list`

The Viewer role includes the above permissions.


|*Google API Gateway*
//RLP-150328

|*gcloud-apigateway-api*

Additional permissions required:

* `apigateway.apis.list`
* `apigateway.apis.getIamPolicy`

The Viewer role includes the above permissions.


|*Google Bigquery Reservation*
//RLP-151171

|*gcloud-bigquery-reservation*

Additional permission required:

* `bigquery.reservations.list`

The Viewer role includes the above permission.


|*Google Bigquery Reservation*
//RLP-151172

|*gcloud-bigquery-reservation*

Additional permissions required:

* `bigquery.reservations.list`
* `bigquery.reservationAssignments.list`

The Viewer role includes the above permissions.


|*Google Bigquery Reservation*
//RLP-151173

|*gcloud-bigquery-reservation-bi-engine-reservation*

Additional permission required:

* `bigquery.bireservations.get`

The Viewer role includes the above permission.


|*Google API Gateway*
//RLP-151174

|*gcloud-apigateway-api-config*

Additional permissions required:

* `apigateway.apis.list`
* `apigateway.apiconfigs.list`

The Viewer role includes the above permissions.


|*Google Cloud IAM*
//RLP-151175

|*gcloud-organization-iam-workforce-pool*

Additional permissions required:

* `iam.googleapis.com/workforcePools.getIamPolicy`
* `iam.googleapis.com/workforcePools.list`

The Viewer role includes the above permissions.


|*Google Cloud IAM*
//RLP-151175

|*gcloud-organization-iam-workforce-pool-provider*

Additional permissions required:

* `iam.googleapis.com/workforcePools.list`
* `iam.googleapis.com/workforcePoolProviders.list`

The Viewer role includes the above permissions.


|*OCI Vaults*
//RLP-149803

|*oci-vault-secrets*

Additional permission required:

* `SECRET_INSPECT`

The Reader role includes the above permission.


|*OCI Object Storage*
//RLP-149823

|*oci-object-storage-preauthenticated-requests*

Additional permissions required:

* `OBJECTSTORAGE_NAMESPACE_READ`
* `BUCKET_INSPECT`
* `BUCKET_READ`

The Reader role includes the above permissions.


|===


//[#new-compliance-benchmarks-and-updates]
//=== New Compliance Benchmarks and Updates

//[cols="50%a,50%a"]
//|===
//|*Compliance Benchmark*
//|*Description*

//|

//|

//|===


[#deprecation-notices]
=== Deprecation Notices

[cols="35%a,10%a,10%a,45%a"]
|===

|*Deprecated Endpoints or Parameters*
|*Deprecated Release*
|*Sunset Release*
|*Replacement Endpoints*

|tt:[*Audit Logs API*]
//RLP-151119

Starting from November 2024, you must transition to the new Audit Logs API. Prisma Cloud will provide a migration period of six months after which the https://pan.dev/prisma-cloud/api/cspm/rl-audit-logs/[current API] will be deprecated.

Once the deprecation period is over, you will have access to only the new API with pagination and filter support.

|24.11.1

|25.5.1

|Will be provided in the 24.11.1 Release Notes.


|tt:[*Vulnerabilities Dashboard APIs*]
//RLP-147410

* *Get Vulnerability Overview Endpoints*

** https://pan.dev/prisma-cloud/api/cspm/vulnerability-dashboard-overview/[GET /uve/api/v1/dashboard/vulnerabilities/overview]

** https://pan.dev/prisma-cloud/api/cspm/vulnerability-dashboard-overview-v-2/[GET /uve/api/v2/dashboard/vulnerabilities/overview]

* *Get Prioritized Vulnerabilities Endpoints*

** https://pan.dev/prisma-cloud/api/cspm/prioritised-vulnerability/[GET /uve/api/v1/dashboard/vulnerabilities/prioritised]

** https://pan.dev/prisma-cloud/api/cspm/prioritised-vulnerability-v-2/[GET /uve/api/v2/dashboard/vulnerabilities/prioritised]

** https://pan.dev/prisma-cloud/api/cspm/prioritised-vulnerability-v-3/[GET /uve/api/v3/dashboard/vulnerabilities/prioritised]

* *Get Top Impacting Vulnerabilities Endpoint*

** https://pan.dev/prisma-cloud/api/cspm/top-prioritised-vulnerability/[GET /uve/api/v1/dashboard/vulnerabilities/prioritised-vuln]

* *Get CVE Overview Endpoint*
** https://pan.dev/prisma-cloud/api/cspm/cve-overview/[GET /uve/api/v1/dashboard/vulnerabilities/cve-overview]

|24.8.1
|24.11.1

|* *Get Vulnerability Overview Endpoint*

** https://pan.dev/prisma-cloud/api/cspm/vulnerability-dashboard-overview-v-3/[GET /uve/api/v3/dashboard/vulnerabilities/overview]

* *Get Prioritized Vulnerabilities Endpoint* 

** https://pan.dev/prisma-cloud/api/cspm/prioritised-vulnerability-v-4/[GET /uve/api/v4/dashboard/vulnerabilities/prioritised]

* *Get Top Impacting Vulnerabilities*
** https://pan.dev/prisma-cloud/api/cspm/top-prioritised-vulnerability-v-2/[GET /uve/api/v2/dashboard/vulnerabilities/prioritised-vuln]

* *Get CVE Overview Endpoint*
** https://pan.dev/prisma-cloud/api/cspm/cve-overview-v-2/[GET /uve/api/v2/dashboard/vulnerabilities/cve-overview]


|tt:[*Prisma Cloud CSPM REST API for Compliance Posture*]

//RLP-120514, RLP-145823, Abinaya - They are not planning to sunset the APIs anytime soon and they want the sunset column to be left blank.

* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture/[get /compliance/posture]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture/[post /compliance/posture]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-trend/[get /compliance/posture/trend]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-trend/[post /compliance/posture/trend]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-trend-for-standard/[get /compliance/posture/trend/{complianceId}]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-trend-for-standard/[post /compliance/posture/trend/{complianceId}]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-trend-for-requirement/[get /compliance/posture/trend/{complianceId}/{requirementId}]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-trend-for-requirement/[post /compliance/posture/trend/{complianceId}/{requirementId}]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-for-standard/[get /compliance/posture/{complianceId}]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-for-standard/[post /compliance/posture/{complianceId}]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-for-requirement/[get /compliance/posture/{complianceId}/{requirementId}]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-for-requirement/[post /compliance/posture/{complianceId}/{requirementId}]

tt:[*Prisma Cloud CSPM REST API for Asset Explorer and Reports*]

* https://pan.dev/prisma-cloud/api/cspm/save-report/[post /report]
* https://pan.dev/prisma-cloud/api/cspm/get-resource-scan-info/[get /resource/scan_info]
* https://pan.dev/prisma-cloud/api/cspm/post-resource-scan-info/[post /resource/scan_info]

tt:[*Prisma Cloud CSPM REST API for Asset Inventory*]

* https://pan.dev/prisma-cloud/api/cspm/asset-inventory-v-2/[get /v2/inventory]
* https://pan.dev/prisma-cloud/api/cspm/post-method-for-asset-inventory-v-2/[post /v2/inventory]
* https://pan.dev/prisma-cloud/api/cspm/asset-inventory-trend-v-2/[get /v2/inventory/trend]
* https://pan.dev/prisma-cloud/api/cspm/post-method-asset-inventory-trend-v-2/[post /v2/inventory/trend]


|23.10.1

|NA

|tt:[*Prisma Cloud CSPM REST API for Compliance Posture*]

* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-v-2/[get /v2/compliance/posture]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-v-2/[post /v2/compliance/posture]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-trend-v-2/[get /v2/compliance/posture/trend]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-trend-v-2/[post /compliance/posture/trend]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-trend-for-standard-v-2/[get /v2/compliance/posture/trend/{complianceId}]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-trend-for-standard-v-2/[post /v2/compliance/posture/trend/{complianceId}]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-trend-for-requirement-v-2/[get /v2/compliance/posture/trend/{complianceId}/{requirementId}]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-trend-for-requirement-v-2/[post /v2/compliance/posture/trend/{complianceId}/{requirementId}]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-for-standard-v-2/[get /v2/compliance/posture/{complianceId}]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-for-standard-v-2/[post /v2/compliance/posture/{complianceId}]
* https://pan.dev/prisma-cloud/api/cspm/get-compliance-posture-for-requirement-v-2/[get /v2/compliance/posture/{complianceId}/{requirementId}]
* https://pan.dev/prisma-cloud/api/cspm/post-compliance-posture-for-requirement-v-2/[post /v2/compliance/posture/{complianceId}/{requirementId}]

tt:[*Prisma Cloud CSPM REST API for Asset Explorer and Reports*]

* https://pan.dev/prisma-cloud/api/cspm/save-report-v-2/[post /v2/report]
* https://pan.dev/prisma-cloud/api/cspm/get-resource-scan-info-v-2/[get /v2/resource/scan_info]
* https://pan.dev/prisma-cloud/api/cspm/post-resource-scan-info-v-2/[post /v2/resource/scan_info]

tt:[*Prisma Cloud CSPM REST API for Asset Inventory*]

* https://pan.dev/prisma-cloud/api/cspm/asset-inventory-v-3/[get /v3/inventory]
* https://pan.dev/prisma-cloud/api/cspm/post-method-for-asset-inventory-v-3/[post /v3/inventory]
* https://pan.dev/prisma-cloud/api/cspm/asset-inventory-trend-v-3/[get /v3/inventory/trend]
* https://pan.dev/prisma-cloud/api/cspm/post-method-asset-inventory-trend-v-3/[post /v3/inventory/trend]

|tt:[*Asset Explorer APIs*]
//RLP-139337
|24.8.1
|NA

|The `accountGroup` response parameter was introduced in error and is now deprecated for Get Asset - https://pan.dev/prisma-cloud/api/cspm/get-asset-details-by-id/[GET - uai/v1/asset] API endpoint.


|tt:[*Deprecation of End Timestamp in Config Search*]
//RLP-126583, suset release TBD
| - 
| - 
|The end timestamp in the date selector for Config Search will soon be deprecated after which it will be ignored for all existing RQLs. You will only need to choose a start timestamp without having to specify the end timestamp.

|tt:[*Prisma Cloud CSPM REST API for Alerts*]
//RLP-25031, RLP-25937

Some Alert API request parameters and response object properties are now deprecated.

Query parameter `risk.grade` is deprecated for the following requests:

*  `GET /alert`
*  `GET /v2/alert`
*  `GET /alert/policy` 

Request body parameter `risk.grade` is deprecated for the following requests:

*  `POST /alert`
*  `POST /v2/alert`
*  `POST /alert/policy`

Response object property `riskDetail` is deprecated for the following requests:

*  `GET /alert`
*  `POST /alert`
*  `GET /alert/policy`
*  `POST /alert/policy`
*  `GET /alert/{id}`
*  `GET /v2/alert`
*  `POST /v2/alert`

Response object property `risk.grade.options` is deprecated for the following request:

* `GET /filter/alert/suggest`

| -
| -
| NA

//tt:[*Change to Compliance Trendline and Deprecation of Compliance Filters*]
//RLP-126719, need to check if this notice can be moved to current features in 24.1.2
//- 
//- 
//To provide better performance, the *Compliance trendline* will start displaying data only from the past one year. Prisma Cloud will not retain the snapshots of data older than one year.
//The Compliance-related filters (*Compliance Requirement, Compliance Standard, and Compliance Section*) will not be available on Asset Inventory (*Inventory > Assets*).

|===