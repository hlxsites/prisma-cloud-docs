== Features Introduced in January 2025

Learn what's new on Prisma® Cloud in January 2025.

//* <<new-features>>
* <<enhancements>>
* <<changes-in-existing-behavior>>
//* <<announcement>>
//* <<intelligence-stream-updates>>
* <<api-ingestions>>
* <<new-policies>>
* <<policy-updates>>
* <<iam-policy-updates>>
* <<new-compliance-benchmarks-and-updates>>
* <<rest-api-updates>>
//* <<deprecation-notices>>


[#enhancements]
=== Enhancements
[cols="30%a,70%a"]
|===
|*Feature*
|*Description*


|*Enhanced Remediation*
//RLP-144840

tt:[Secure the Infrastructure]

tt:[25.1.1]

|Enhanced Remediation improves the quality and effectiveness of Prisma Cloud security alert remediation guidance. It leverages artificial intelligence (AI) to assist your teams in enhancing remediation content for existing alerts and policies, while ensuring all recommendations undergo rigorous human review and QA validation. The recommendations now provide AI-assisted remediation steps for Critical and High Alerts. It provides you with a seamless and intuitive experience allowing you to quickly access and understand the remediation steps.

* *Alerts* includes a new *Enhanced Remediation* Saved View. When you select *Enhanced Remediation* filter option as *Yes*, you can view the alerts that you can resolve using enhanced remediation.
+
image::enhanced-remediation-1.png[]

* Click the *Alert ID* to view the new *How to Fix* tab (previously known as Recommendations) with the various remediation options.
+
image::enhanced-remediation-4.png[]

* Expand the accordion to fix the alert with either *Manual Remediation in Console* (previously known as Recommendation Steps), *Remediate with Terraform Template*, or *Remediate with CLI Command*.
+
image::enhanced-remediation-6.png[]

There are multiple clickable boxes for each finding that are part of the Attack Path. For individual alerts, such as standalone policies, there is only one box. For alerts or policies that do not have Terraform or CLI, only Manual remediation is available.

//* The *Policy* table includes a new *AI Remediation* column.


|*Microsoft Entra ID Visibility*
//RLP-153639

tt:[Secure the Infrastructure]

tt:[25.1.1]

|Enhancements to Prisma Cloud's Cloud Infrastructure and Entitlement Management (CIEM) capabilities provide greater visibility and control over Microsoft Azure Entra ID permissions, helping you secure your identities with greater efficiency. You can now investigate not only Azure but also Entra ID specific permissions, such as identifying entities with the Global Administrator role. Use the `grantedby.level.type` attribute in combination with all existing RQL queries to investigate Entra ID permissions.


|*ARM Framework Support for Custom Build Policies*
//BCE-35801

tt:[Secure the Source]

tt:[25.1.1]

|You can now create https://docs.prismacloud.io/en/enterprise-edition/content-collections/governance/custom-build-policies/custom-build-policies[custom build policies] that include ARM. These policies can be applied to both ARM and Bicep using shared arguments and syntax, or you can restrict the policy to either ARM or Bicep. Additionally, the ARM framework now supports both explicit and implicit dependencies.


|*Enhancements to Vulnerability Reporting for Red Hat Enterprise Linux (RHEL) Versions 8 and 9*
//CWP-30827

tt:[Secure the Runtime]

tt:[33.03.138]
|To ensure accurate vulnerability reporting, Intelligence Stream includes RPM module and stream information for RHEL in the reports. This approach improves detection of vulnerabilities and ensures that all associated RPM packages installed by a module are examined during the scan.

*What are RPM Modules and Streams?*

In Red Hat Enterprise Linux (RHEL), an RPM module is a collection of related RPM packages that represent a software component, such as an application, its dependencies, and helper utilities. Starting with RHEL 6 and 7, modules replaced the Software Collections mechanism.

Modules are structured in the following way:

* *Module Streams*: Virtual repositories within the AppStream repository. Each stream corresponds to a specific version of the module and receives independent updates.

* *Stream Activation*: At any time, only one stream of a module can be active, meaning only one version of a component can be installed on a system.

For example, the notation `python39:3.9/python39` indicates the module `python39`, the stream `3.9`, and the source package `python39`.

*Enhancements to Vulnerability Reporting*

* *Module-Based Vulnerability Identification*: Scans will report vulnerabilities based on the module and stream configuration. This ensures accurate detection and avoids false positives or false negatives caused by discrepancies in versioning or backported fixes.

* *Inclusion of RPM Module Metadata in Scan Results*: The enhanced implementation associates RPM packages with their respective modules and streams. The Prisma Cloud console will include this module information in vulnerability scan results.


*Benefits of Module-Aware Vulnerability Reporting*

* *Improved Accuracy*: Matches CVE fixes to the correct module stream.
* *Reduced False Positives*: Avoids misreporting of vulnerabilities fixed in older streams.
* *Comprehensive Coverage*: Links all RPM packages installed by a module to its vulnerabilities.

*NOTE*: 

* This enhancement requires upgrading Defenders to the latest version. 

* The older versions of Defender will remain unaffected by this change, and their behavior remains unchanged.

|*Enhanced Vulnerability Reporting for NuGet Packages*
//CWP-49786

tt:[Secure the Runtime]

tt:[33.03.138]
|Previously, the scanning process included NuGet packages listed in the `.deps.json` files, which were essential for the runtime environment but not related to the application itself. These unrelated packages result in false positives in vulnerability reporting. 

With this enhancement, the scanning process excludes runtime-specific dependencies that are not directly related to the application. This provides a more accurate view of vulnerabilities directly associated with the application, and reduces false positive alerts.

*NOTE*: 

* This enhancement requires upgrading Defenders to the latest version. 

* The updated Defender accurately identifies package dependencies, which leads to fewer false positives.

* The older versions of Defender will remain unaffected by this change, and their behavior remains unchanged.

|*Enhancement to Prevent Action with `fsmon_v2`*
//CWP-62711

tt:[Secure the Runtime]

tt:[33.03.138]

|To enhance the handling of file system events for the Prevent Action in the Runtime Policy, a new version, fsmon_v2, has been developed. This version improves stability by managing timeouts more promptly and in a robust manner, thereby reducing bottlenecks and enhancing overall stability.

While `fsmon_v2` brings significant improvements, it is still under active development, and further enhancements are planned. Currently, `fsmon_v2` is being rolled out gradually. 

This feature is disabled by default. Customers who want to activate this feature should submit a ticket requesting engineering to enable it.

|"last-connected" Field Added to Defender Stats Logs
//CWP-62666

tt:[Secure the Runtime]

tt:[33.03.138]
|A new field, last-connected, has been added to each Defender stats log. This field records the last confirmed connection time between the Defender and the Console, even when the Connected flag is set to false. The timestamp is represented in epoch seconds (UTC), providing customers with a reliable way to track connection history.
|===

[#changes-in-existing-behavior]
=== Changes in Existing Behavior

[cols="50%a,50%a"]

|===
|*Feature*
|*Description*

|*New Rate Limits for Search API*
//RLP-151274

|Starting with the current release, to improve user experience and enhance search performance, rate limits will be implemented for the following APIs:

* *Config Search*
** https://pan.dev/prisma-cloud/api/cspm/search-config/[search/config]
** https://pan.dev/prisma-cloud/api/cspm/search-config-page/[search/config/page]

* *Config Search v1*
** https://pan.dev/prisma-cloud/api/cspm/search-config-by-query/[search/api/v1/config]

Request Rate Limit = 150

*Impact—* Requests exceeding the limits will result in an *HTTP 429* Too Many Requests response. See Prisma Cloud API guidance on https://pan.dev/prisma-cloud/api/cspm/rate-limits/[Rate Limits].


|*Custom IAM Policies Alert Triggers*
//RLP-153861

|Starting with the current release, custom policies regarding unused permissions will trigger alerts when there is zero usage of the action with `""` regex across any of the destinations. If the action has been used on at least one resource that matches the `""` regex, the alert will be resolved.

*Impact—* This change may impact existing alerts for unused permissions with `*` and could potentially dismiss them.


|*Downgraded permissions required to onboard GitLab*
//RLP-153897

|`Organization owner` permissions are no longer required for integrating https://docs.prismacloud.io/en/enterprise-edition/content-collections/application-security/get-started/connect-code-and-build-providers/code-repositories/add-gitlab#user-permissions[GitLab SaaS] or https://docs.prismacloud.io/en/enterprise-edition/content-collections/application-security/get-started/connect-code-and-build-providers/code-repositories/add-gitlab-selfmanaged[GitLab on-prem]. `Maintainer` permissions are sufficient. This change enhances security by adhering to the principle of least privilege.

|===


[#api-ingestions]
=== API Ingestions

[cols="50%a,50%a"]
|===
|*Service*
|*API Details*

|*Amazon Athena*
//RLP-153371
|*aws-athena-table-metadata*

Additional permissions needed:

* `athena:ListDataCatalogs`
* `athena:ListDatabases`
* `athena:ListTableMetadata`
* `glue:GetTables`

The Security Audit role includes the permissions.

|*Amazon CodePipeline*
//RLP-153691

tt:[Update] 
|*aws-code-pipeline-pipeline*

The resource JSON for the API has been updated to include new fields:

* `stages`
* `Deploy`
* `Source`
* `Build`

|*Amazon Cognito*
//RLP-152946
|*aws-cognito-user-pool-group*

Additional permissions needed:

* `cognito-idp:ListUserPools`
* `cognito-idp:ListGroups`
* `cognito-idp:GetGroup`

The Security Audit role only includes the `cognito-idp:ListUserPools` and `cognito-idp:ListGroups` permissions.

You must manually update the `cognito-idp:GetGroup` permission in the CFT template and enable it.

|*Amazon Cognito*
//RLP-153820
|*aws-cognito-user*

Additional permissions needed:

* `cognito-idp:ListUserPools`
* `cognito-idp:ListUsers`

The Security Audit role includes the permissions.

|*Amazon Cognito*
//RLP-154122

tt:[Update] 
|*aws-cognito-user-pool*

The resource JSON for the API has been updated to include new fields:

* `passwordPolicy`
* `AdvancedSecurityMode`
* `riskConfiguration`


|*AWS Directory Service*
//RLP-153814
|*aws-ds-directory-trust*

Additional permission needed:

* `ds:DescribeTrusts`

The Security Audit role does not include the above permission. You must manually update the CFT template to enable it.


|*Amazon EC2*
//RLP-153463
|*aws-ec2-spot-fleet-request*

Additional permission needed:

* `ec2:DescribeSpotFleetRequests`

The Security Audit role includes the permission.

|*Amazon EC2*
//RLP-153463/RLP-153318
|*aws-ec2-serial-console-access-status*

Additional permission needed:

* `ec2:GetSerialConsoleAccessStatus`

The Security Audit role does not include the above permission. You must manually update the CFT template to enable it.

|*Amazon EC2* 
//RLP-153817

tt:[Update] 
|*aws-ec2-describe-images*

The resource JSON for this API includes the `deprecationTime` field.

|*Amazon ElastiCache*
//RLP-152949
|*aws-elasticache-serverless-cache*

Additional permissions needed:

* `elasticache:DescribeServerlessCaches`
* `elasticache:ListTagsForResource`

The Security Audit role includes the permissions.

|*Amazon Elasticsearch Service*
//RLP-153323
|*aws-es-batch-get-collection*

Additional permissions needed:

* `aoss:ListCollections`
* `aoss:BatchGetCollection`
* `aoss:ListTagsForResource`

The Security Audit role includes the permissions.

|*Amazon Elasticsearch Service*
//RLP-153320
|*aws-es-security-config*

Additional permission needed:

* `aoss:ListSecurityConfigs`

The Security Audit role includes the permission.

|*Amazon Fraud Detector*
//RLP-153298
|*aws-fraud-detector-entity-type*

Additional permissions needed:

* `frauddetector:GetEntityTypes`
* `frauddetector:ListTagsForResource`

The Security Audit role does not include the above permissions. You must manually update the CFT template to enable them.

|*Amazon Fraud Detector*
//RLP-152954
|*aws-fraud-detector-label*

Additional permissions needed:

* `frauddetector:GetLabels`
* `frauddetector:ListTagsForResource`

The Security Audit role does not include the above permissions. You must manually update the CFT template to enable them.

|*Amazon Fraud Detector*
//RLP-152945
|*aws-fraud-detector-variable*

Additional permission needed:

* `frauddetector:GetVariables`

The Security Audit role does not include the above permission. You must manually update the CFT template to enable it.

|*AWS Global Accelerator*
//RLP-153286
|*aws-global-accelerator-endpoint-group*

Additional permissions needed:

* `globalaccelerator:ListAccelerators`
* `globalaccelerator:ListListeners`
* `globalaccelerator:DescribeListener`
* `globalaccelerator:ListEndpointGroups`
* `globalaccelerator:DescribeEndpointGroup`

The Security Audit role includes the permissions.

|*AWS Global Accelerator*
//RLP-153284
|*aws-global-accelerator-listener*

Additional permissions needed:

* `globalaccelerator:ListAccelerators`
* `globalaccelerator:ListListeners`
* `globalaccelerator:DescribeListener`

The Security Audit role includes the permissions.


|*AWS Glue*
//RLP-153177
|*aws-glue-dev-endpoint*

Additional permission needed:

* `glue:GetDevEndpoints`

The Security Audit role includes the permission.

|*AWS IAM*
//RLP-153314
|*aws-iam-service-specific-credential*

Additional permissions needed:

* `iam:ListUsers`
* `iam:ListServiceSpecificCredentials`

The Security Audit role includes the permissions.

|*AWS IAM Identity Center*
//RLP-153622
|*aws-iam-identity-center-instance*

Additional permission needed:

* `sso:ListInstances`

The Security Audit role includes the permission.

|*Amazon Lightsail*
//RLP-153464
|*aws-lightsail-container-service*

Additional permission needed:

* `lightsail:GetContainerServices`

The Security Audit role includes the permission.

|*Amazon Lightsail*
//RLP-152947
|*aws-lightsail-key-pair*

Additional permission needed:

* `lightsail:GetKeyPairs`

The Security Audit role does not include the above permission. You must manually update the CFT template to enable it.


|*Amazon MSK*
//RLP-153302
|*aws-msk-configuration*

Additional permissions needed:

* `kafka:ListConfigurations`
* `kafka:DescribeConfiguration`

The Security Audit role includes the permissions.

|*AWS Network Manager*
//RLP-153465
|*aws-network-manager-global-network-device*

Additional permissions needed:

* `networkmanager:DescribeGlobalNetworks`
* `networkmanager:GetDevices`

The Security Audit role only includes the `networkmanager:DescribeGlobalNetworks` permission.

You must manually update the `networkmanager:GetDevices` permission in the CFT template and enable it.

|*Amazon Personalize*
//RLP-153305
|*aws-personalize-dataset-import-job*

Additional permission needed:

* `personalize:ListDatasetImportJobs`

The Security Audit role does not include the above permission. You must manually update the CFT template to enable it.


|*Amazon Recycle Bin*
//RLP-153461
|*aws-recycle-bin-ami-rule*

Additional permissions needed:

* `rbin:ListRules`
* `rbin:GetRule`
* `rbin:ListTagsForResource`

The Security Audit role does not include the above permissions. You must manually update the CFT template to enable them.


|*Amazon SageMaker*
//RLP-153466
|*aws-sagemaker-studio-lifecycle-config*

Additional permissions needed:

* `sagemaker:ListStudioLifecycleConfigs`
* `sagemaker:DescribeStudioLifecycleConfig`

The Security Audit role includes the permissions.

|*Amazon SES*
//RLP-153304
|*aws-ses-template*

Additional permissions needed:

* `ses:ListTemplates`
* `ses:GetTemplate`

The Security Audit role does not include the above permissions. You must manually update the CFT template to enable them.

|*AWS Step Functions*
//RLP-153816

tt:[Update] 
|*aws-step-functions-statemachine*

The resource JSON for this API includes the `definition` field.


|*Amazon Translate*
//RLP-153288
|*aws-translate-text-translation-job*

Additional permissions needed:

* `translate:ListTextTranslationJobs`
* `translate:DescribeTextTranslationJob`

The Security Audit role only includes `translate:ListTextTranslationJobs` permission.

You must manually include `translate:DescribeTextTranslationJob` permission in the CFT template to enable it.


|*Amazon VPC Lattice*
//RLP-153467
|*aws-vpc-lattice-service-network*

Additional permissions needed:

* `vpc-lattice:ListServiceNetworks`
* `vpc-lattice:GetServiceNetwork`
* `vpc-lattice:TagResource`

The Security Audit role does not include the above permissions. You must manually update the CFT template to enable them.


|*AWS Glue DataBrew*
//RLP-153178
|*aws-glue-data-brew-project*

Additional permissions needed:

* `databrew:ListProjects`
* `databrew:DescribeProject`

The Security Audit role includes the permissions.

|*Azure Active Directory*
//RLP-153823
|*azure-active-directory-group-lifecycle-policies*

Additional permission needed:

* `Directory.Read.All`

The Reader role includes the permission.

|*Azure API Management Service*
//RLP-153821
|*azure-api-management-service-apis*

Additional permission needed:

* `Microsoft.ApiManagement/service/apis/read`

The Reader role includes the permission.


|*Azure App Service*
//RLP-153586
|*azure-app-service-web-apps-app-settings*

Additional permissions needed:

* `Microsoft.Web/sites/Read`
* `Microsoft.Web/sites/config/list/Action`

The Reader role includes the permissions.

|*Azure Batch Account*
//RLP-154060
|*azure-batch-account-application*

Additional permissions needed:

* `Microsoft.Batch/batchAccounts/read`
* `Microsoft.Batch/batchAccounts/applications/read`

The Reader role includes the permissions.


|*Azure Database for PostgreSQL*
//RLP-153589
|*azure-postgresql-flexible-server-configurations*

Additional permissions needed:

* `Microsoft.DBforPostgreSQL/flexibleServers/read`
* `Microsoft.DBforPostgreSQL/flexibleServers/configurations/read`

The Reader role includes the permissions.

|*Azure Load Testing*
//RLP-154066
|*azure-loadtest-service-outbound-network-endpoint*

Additional permissions needed:

* `Microsoft.LoadTestService/loadTests/read`
* `Microsoft.LoadTestService/loadTests/outboundNetworkDependenciesEndpoints/read`

The Reader role includes the permissions.


|*Google Identity Aware Proxy*
//RLP-153771
|*gcloud-identity-aware-proxy-all-web-services-settings*

Additional permission needed:

* `iap.web.getSettings`

The Viewer role includes the above permission.


|*Google Identity Aware Proxy*
//RLP-153774
|*gcloud-identity-aware-proxy-compute-settings*

Additional permission needed:

* `iap.webTypes.getSettings`

The Viewer role includes the above permission.


|*Google Identity Aware Proxy Forwarding*
//RLP-153813
|*gcloud-identity-aware-proxy-forwarding-rule-settings*

Additional permission needed:

* `iap.webTypes.getSettings`

The Viewer role includes the above permission.


|*Google Identity Aware Proxy*
//RLP-153769
|*gcloud-identity-aware-proxy-project-settings*

Additional permission needed:

* `iap.webTypes.getSettings`

The Viewer role includes the above permission.

|*OCI Vaults*
//RLP-123337
|*oci-vault-key*

Additional permissions needed:

* `KEY_INSPECT`
* `KEY_READ`

You must update the Terraform template to enable the permissions.

|===

[#new-policies]
=== New Policies

[cols="40%a,60%a"]
|===
|*Policies*
|*Description*

|*AWS Connect instance not configured with contact flow logs*
//RLP-154132

|This Policy identifies the Amazon Connect instance configured with CONTACTFLOW_LOGS set to false in Amazon Connect. Enabling CONTACTFLOW_LOGS in Amazon Connect is crucial as it allows real-time logging of contact flow executions to CloudWatch. This helps in debugging, monitoring, and optimizing customer interactions by tracking steps, conditions, and errors.

It is recommended to enable CONTACTFLOW_LOGS to enhance monitoring and ensure adherence to security policies and regulations.

*Policy Severity—* Informational

*Policy Type—* Config

*RQL—* 
----
config from cloud.resource where api.name = 'aws-connect-instance' AND json.rule = InstanceStatus equals "ACTIVE" and attributes[?any( AttributeType equals "CONTACTFLOW_LOGS" and Value equals "false" )] exists
----


|*AWS Connect instance using publicly accessible S3 bucket*
//RLP-154134

|This policy identifies the S3 bucket used by AWS Connect instances  for storing CHAT_TRANSCRIPTS, CALL_RECORDINGS, and SCREEN_RECORDINGS, which are publicly accessible.The S3 bucket containing CHAT_TRANSCRIPTS, CALL_RECORDINGS, or SCREEN_RECORDINGS being publicly accessible is significant, as it exposes sensitive customer data and internal data to the public.

It is recommended to secure the identified S3 buckets by enforcing stricter access controls and eliminating public read permissions for the reported S3 bucket used for AWS Connect instances.

*Policy Severity—* High

*Policy Type—* Config

*RQL—* 
----
config from cloud.resource where api.name = 'aws-connect-instance' AND json.rule = InstanceStatus equals "ACTIVE" and storageConfig[?any( resourceType is member of ('CHAT_TRANSCRIPTS','CALL_RECORDINGS','SCREEN_RECORDINGS') and storageConfigs[*] exists )] exists as X; config from cloud.resource where api.name='aws-s3api-get-bucket-acl' AND json.rule = "((((acl.grants[?(@.grantee=='AllUsers')] size > 0) or policyStatus.isPublic is true) and publicAccessBlockConfiguration does not exist and accountLevelPublicAccessBlockConfiguration does not exist) or ((acl.grants[?(@.grantee=='AllUsers')] size > 0) and ((publicAccessBlockConfiguration.ignorePublicAcls is false and accountLevelPublicAccessBlockConfiguration does not exist) or (publicAccessBlockConfiguration does not exist and accountLevelPublicAccessBlockConfiguration.ignorePublicAcls is false) or (publicAccessBlockConfiguration.ignorePublicAcls is false and accountLevelPublicAccessBlockConfiguration.ignorePublicAcls is false))) or (policyStatus.isPublic is true and ((publicAccessBlockConfiguration.restrictPublicBuckets is false and accountLevelPublicAccessBlockConfiguration does not exist) or (publicAccessBlockConfiguration does not exist and accountLevelPublicAccessBlockConfiguration.restrictPublicBuckets is false) or (publicAccessBlockConfiguration.restrictPublicBuckets is false and accountLevelPublicAccessBlockConfiguration.restrictPublicBuckets is false))))" as Y; filter ' $.X.storageConfig[*].storageConfigs[*].S3Config.BucketName intersects $.Y.bucketName' ; show Y;
----

|*AWS Connect instance not configured with contact flow logs*
//RLP-154132

|This Policy identifies the Amazon Connect instance configured with CONTACTFLOW_LOGS set to false in Amazon Connect. Enabling CONTACTFLOW_LOGS in Amazon Connect is crucial as it allows real-time logging of contact flow executions to CloudWatch. This helps in debugging, monitoring, and optimizing customer interactions by tracking steps, conditions, and errors.

It is recommended to enable CONTACTFLOW_LOGS to enhance monitoring and ensure adherence to security policies and regulations.

*Policy Severity—* Informational

*Policy Type—* Config

*RQL—* 
----
config from cloud.resource where api.name = 'aws-connect-instance' AND json.rule = InstanceStatus equals "ACTIVE" and attributes[?any( AttributeType equals "CONTACTFLOW_LOGS" and Value equals "false" )] exists
----

|*Azure Blob Storage utilized for Azure Machine Learning training job data*
//RLP-153631

|This policy identifies Azure Blob Storage accounts used for storing data utilized in Azure Machine Learning training jobs. This policy provides visibility into storage utilization for Machine Learning workloads but does not indicate a security or compliance risk.

Azure Blob Storage serves as a robust storage solution for large-scale Machine Learning training data. This policy emphasizes the importance of securing stored data by employing encryption and additional security parameters like firewalls, private endpoints, and access policies to safeguard sensitive information.

As a security best practice, it is recommended to properly configure Azure Blob Storage utilized in Azure Machine Learning training jobs.

*Policy Severity—* Informational

*Policy Type—* Config

*RQL—* 
----
config from cloud.resource where api.name = 'azure-machine-learning-datastores' AND json.rule = properties.datastoreType equal ignore case AzureBlob as X; config from cloud.resource where api.name = 'azure-storage-account-list' as Y; filter ' $.X.properties.accountName equal ignore case $.Y.name ' ; show Y;
----

|*Azure Function App with public access linked to Blob Storage*
//RLP-153632

|This policy identifies Azure Function Apps configured with public access and linked to Azure Blob Storage.

Azure Function Apps often access Blob Storage to retrieve or store data. When public access is enabled for the Function App, it exposes the application and, potentially, the associated Blob Storage to unauthorized access, leading to potential security risks.

As a security best practice, it is recommended to evaluate public access for Azure Function Apps and secure Azure Blob Storage.

*Policy Severity—* Informational

*Policy Type—* Config

*RQL—* 
----
config from cloud.resource where api.name = 'azure-storage-account-list' as X; config from cloud.resource where api.name = 'azure-app-service-web-apps-configurations' as Y; config from cloud.resource where api.name = 'azure-app-service' AND json.rule = 'kind contains functionapp and kind does not contain workflowapp and kind does not equal app and properties.state equal ignore case running and ((properties.publicNetworkAccess exists and properties.publicNetworkAccess equal ignore case Enabled) or (properties.publicNetworkAccess does not exist)) and config.ipSecurityRestrictions[?any((action equals Allow and ipAddress equals Any) or (action equals Allow and ipAddress equals 0.0.0.0/0))] exists' as Z; filter ' $.Y.properties.azureStorageAccounts contains $.X.name and $.Z.name equal ignore case $.Y.name' ; show Z;
----

|*Azure Container Registry with anonymous authentication enabled*
//RLP-153633

|This policy identifies Azure Container Registries with anonymous authentication enabled, allowing unauthenticated access to the registry.

Allowing anonymous pull or access to container registries poses a significant security risk, exposing them to unauthorized users who may retrieve or manipulate container images. To enhance security, disable anonymous access and require authentication through Azure Active Directory (Azure AD). Additionally, turn off local authentication methods such as admin user, repository-scoped access tokens, and anonymous pull to ensure authentication relies solely on Azure AD, providing improved control and accountability.

As a security best practice, it is recommended to disable anonymous authentication for Azure Container Registries.

*Policy Severity—* High

*Policy Type—* Config

*RQL—* 
----
config from cloud.resource where api.name = 'azure-container-registry' AND json.rule = (skuName contains Standard or skuName contains Premium) and properties.provisioningState equal ignore case Succeeded and properties.anonymousPullEnabled is false 
----

|*Azure Container Registry with ARM audience token authentication enabled*
//RLP-153634

|This policy identifies Azure Container Registries that permit ARM audience tokens for authentication.

When ARM audience tokens are enabled, they allow authentication intended for broader Azure services, which could introduce potential security risks. Disabling ARM audience tokens ensures that only ACR-specific tokens are valid, enhancing security by limiting authentication exclusively to Azure Container Registry audience tokens.

As a security best practice, it is recommended to disable ARM audience tokens for Azure Container Registries.

*Policy Severity—* Medium

*Policy Type—* Config

*RQL—* 
----
config from cloud.resource where api.name = 'azure-container-registry' AND json.rule = properties.provisioningState equal ignore case Succeeded and properties.policies.azureADAuthenticationAsArmPolicy.status contains enabled 
----

|*Azure Container Registry with local admin account enabled*
//RLP-154109

|This policy identifies Azure Container Registries having local admin account enabled.

Enabling the admin account allows access to the registry through username and password, bypassing Microsoft Entra ID authentication. Disabling the local admin account improves security by enforcing exclusive use of Microsoft Entra ID identities, which provide centralized management, enhanced auditing, and better control over permissions. By relying solely on Microsoft Entra ID for authentication, the risk of unauthorized access through local credentials is mitigated, ensuring stronger protection for your container registry.

As a security best practice, it is recommended to disable local admin account for Azure Container Registries.

*Policy Severity—* Low

*Policy Type—* Config

*RQL—* 
----
config from cloud.resource where cloud.type = 'azure' and api.name = 'azure-container-registry' AND json.rule = properties.provisioningState equal ignore case Succeeded and properties.adminUserEnabled is true 
----

|*Azure Container Registry with repository scoped access token enabled*
//RLP-154110

|This policy identifies Azure Container Registries having repository scoped access tokens enabled.

Disable repository-scoped access tokens for your registry to prevent access via tokens. Enhancing security involves disabling local authentication methods, including admin user, repository-scoped access tokens, and anonymous pull. This ensures that container registries rely solely on Microsoft Entra ID identities for authentication.

As a security best practice, it is recommended to disable repository scoped access token for Azure Container Registries.

*Policy Severity—* Low

*Policy Type—* Config

*RQL—* 
----
config from cloud.resource where cloud.type = 'azure' and api.name = 'azure-container-registry' AND json.rule = properties.provisioningState equal ignore case Succeeded and tokens[?any( properties.status contains enabled )] exists 
----

|*Azure Container Registry not encrypted with Customer Managed Key (CMK)*
//RLP-154111

|This policy identifies Azure Container Registries that are not encrypted with Customer-Managed Keys (CMK).

By default, Azure Container Registry encrypts data at rest with Microsoft-managed keys. However, for enhanced control, regulatory compliance, and improved security, customer-managed keys enable organizations to encrypt Azure Container Registry data using Azure Key Vault keys that they create, own, and manage. Using CMK ensures that the encryption process aligns with organizational policies, allowing complete control over key lifecycle management, including rotation, access management, and retirement.

As a security best practice, it is recommended to encrypt Azure Container Registries with Customer-Managed Keys (CMK).

*Policy Severity—* Low

*Policy Type—* Config

*RQL—* 
----
config from cloud.resource where cloud.type = 'azure' and api.name = 'azure-container-registry' AND json.rule = properties.provisioningState equal ignore case Succeeded and properties.encryption.status equal ignore case disabled 
----

|*Azure Container Registry with exports enabled*
//RLP-154112

|This policy identifies Azure Container Registries with exports enabled.

Azure Container Registries with exports enabled allows data in the registry to be moved out using commands like acr import or acr transfer. Export functionality can expose registry data, increasing the risk of unauthorized data movement. Disabling exports ensures that data in a registry is accessed only via the dataplane (e.g., docker pull) and cannot be moved out using other methods.

As a security best practice, it is recommended to disable export configuration for Azure Container Registries.

*Policy Severity—* Medium

*Policy Type—* Config

*RQL—* 
----
config from cloud.resource where cloud.type = 'azure' and api.name = 'azure-container-registry' AND json.rule = properties.provisioningState equal ignore case Succeeded and (properties.policies.exportPolicy.status contains enabled or properties.publicNetworkAccess contains enabled) 
----

|*GCP Memorystore for Redis instance not encrypted with CMEK*
//RLP-153619

|This policy identifies Memorystore for Redis instances not encrypted with CMEK.

GCP Memorystore for Redis is a fully managed in-memory data store that simplifies Redis deployment and scaling while ensuring high availability and low-latency access. By using CMEK with Redis instance, you retain complete control over the encryption keys protecting your sensitive data, ensuring that only authorized users with access to these keys can decrypt and access the information. Without CMEK, data is encrypted with Google-managed keys, which may not provide the level of control required for handling sensitive data in certain industries.

It is recommended to encrypt Redis instance data using a Customer-Managed Encryption Key (CMEK).

*Policy Severity—* Informational

*Policy Type—* Config

*RQL—* 
----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-redis-instances-list' AND json.rule = not(customerManagedKey contains cryptoKeys)
----

|*GCP Memorystore for Redis instance does not use in transit encryption*
//RLP-153620

|This policy identifies GCP Memorystore for Redis instances with no in transit encryption.

GCP Memorystore for Redis is a fully managed in-memory data store that simplifies Redis deployment and scaling while ensuring high availability and low-latency access. When in-transit encryption is disabled, all data transmitted between your clients and Redis flows as plaintext over the network, making it vulnerable to man-in-the-middle attacks and packet sniffing, potentially exposing sensitive information like session tokens, personal data, or business secrets.

It is recommended to enable In transit encryption for GCP Memorystore for Redis to prevent malicious actors from intercepting sensitive data.

*Policy Severity—* Low

*Policy Type—* Config

*RQL—* 
----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-redis-instances-list' AND json.rule = transitEncryptionMode does not equal ignore case SERVER_AUTHENTICATION
----

|*GCP Memorystore for Redis instance has AUTH disabled*
//RLP-153621

|This policy identifies GCP Memorystore for Redis instances having AUTH disabled.

GCP Memorystore for Redis is a fully managed in-memory data store that simplifies Redis deployment and scaling while ensuring high availability and low-latency access. When AUTH is disabled, any client that can reach the Redis instance over the network can freely connect and perform operations without providing any credentials, creating a significant security risk to your data.

It is recommended to enable authentication (AUTH) on the GCP Memorystore for Redis to ensure only authorized clients can connect.

*Policy Severity—* Low

*Policy Type—* Config

*RQL—* 
----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-redis-instances-list' AND json.rule = authEnabled is false
----

|*GCP Storage bucket with object versioning disabled*
//RLP-154140

|This policy identifies GCP Storage buckets that have object versioning disabled.

Object versioning is a method of keeping multiple variants of an object in the same storage bucket. Enabling object versioning on storage log buckets will protect your cloud storage data from being overwritten or accidentally deleted.

It is recommended to enable the object versioning feature on all storage buckets.

*Policy Severity—* Medium

*Policy Type—* Config

*RQL—* 
----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-storage-buckets-list' AND json.rule = versioning.enabled is false or versioning does not exist
----

|===

[#policy-updates]
=== Policy Updates

[cols="50%a,50%a"]
|===
|*Policy Updates*
|*Description*

2+|*Policy Updates—Metadata*

|*Azure VM disk configured with public network access*
//RLP-153728

|The policy name and description will be updated.

*Current Policy Name–* Azure VM disk configured with public network access

*Updated Policy Name–* Azure VM disk configured with overly permissive network access

*Current Policy Description–* This policy identifies Azure Virtual Machine disks that are configured with public network access.

Allowing public access to Azure Virtual Machine disk resources increases the risk of unauthorized access and potential security breaches. Public network access exposes sensitive data to external threats, which attackers could exploit to compromise VM disks. Disabling public access and using Azure Private Link reduces exposure, ensuring only trusted networks have access and enhancing the security of your Azure environment by minimizing the risk of data leaks and breaches.

As a security best practice, it is recommended to disable public network access for Azure Virtual Machine disks.

*Updated Policy Description–* This policy identifies Azure Virtual Machine disks that are configured with overly permissive network access.

Enabling public network access provides overly permissive network access on Azure Virtual Machine disks, increasing the risk of unauthorized access and potential security breaches. Public network access exposes sensitive data to external threats, which attackers could exploit to compromise VM disks. Disabling public access and using Azure Private Link reduces exposure, ensuring only trusted networks have access and enhancing the security of your Azure environment by minimizing the risk of data leaks and breaches. 

As a security best practice, it is recommended to disable public network access for Azure Virtual Machine disks. 

*Policy Type–* Config

*Policy Severity–* High

*Impact–* No impact on alerts.

|*AWS Security Group allows all traffic on CIFS port (445)*

tt:[Policy-Fix]

|With this new update, the policy search manager name changed from AWS Security Group allows all traffic on CIFS port (445) to AWS Security Group allows all ingress traffic on CIFS port (445)

*Impact*: No impact on the alerts

2+|*Policy Updates—RQL*

|*Azure Storage account diagnostic setting for blob is disabled*
//RLP-152815

|The policy RQL is updated to reduce false positives when the diagnostic setting is enabled. 

*Current RQL–* 
----
config from cloud.resource where api.name = 'azure-storage-account-list' AND json.rule = properties.provisioningState equal ignore case Succeeded as X; config from cloud.resource where api.name = 'azure-storage-account-blob-diagnostic-settings' AND json.rule = properties.logs[*].enabled all true as Y; filter 'not($.X.name equal ignore case $.Y.StorageAccountName)'; show X;
----

*Updated RQL–*
----
config from cloud.resource where api.name = 'azure-storage-account-list' AND json.rule = properties.provisioningState equal ignore case Succeeded as X; config from cloud.resource where api.name = 'azure-storage-account-blob-diagnostic-settings' AND json.rule = (properties.logs[?(@.categoryGroup)] exists and properties.logs[*].enabled any true) or (properties.logs[?(@.category)] exists and properties.logs[*].enabled all true) as Y; filter 'not($.X.name equal ignore case $.Y.StorageAccountName)'; show X; 
----

*Policy Type–* Config

*Policy Severity–* Low

*Impact–* Low. Open alerts would be resolved when the diagnostic settings are enabled


|*Azure Cosmos DB Virtual network is not configured*
//RLP-153625

|The policy RQL will be updated to reduce false positives by considering the public network access property. 

*Current RQL–* 
----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-cosmos-db' AND json.rule = properties.provisioningState equals Succeeded and properties.virtualNetworkRules[*] does not exist
----

*Updated RQL–*
----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-cosmos-db' AND json.rule = properties.provisioningState equals Succeeded AND properties.publicNetworkAccess equal ignore case Enabled AND properties.virtualNetworkRules[*] is empty
----

*Policy Type–* Config

*Policy Severity–* Low

*Impact–* Medium. New alerts will be generated when the public network access is set to `all` networks. Existing alerts where the public network access is not set to `all` networks will be resolved.

|*Azure storage account has a blob container with public access*
//RLP-153630
|The policy RQL will be updated to include Public network access and Private Endpoint check to increase the accuracy of RQL results.

*Current RQL–* 
----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-storage-account-list' AND json.rule = totalPublicContainers > 0 and (properties.allowBlobPublicAccess is true or properties.allowBlobPublicAccess does not exist)
----

*Updated RQL–*
----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-storage-account-list' AND json.rule = totalPublicContainers > 0 and (properties.allowBlobPublicAccess is true or properties.allowBlobPublicAccess does not exist) and properties.publicNetworkAccess equal ignore case Enabled and networkRuleSet.virtualNetworkRules is empty and (properties.privateEndpointConnections is empty or properties.privateEndpointConnections does not exist)
----

*Policy Type–* Config

*Policy Severity–* High

*Impact–* Medium. Existing alerts will be resolved as `Policy_Updated`.

|*Azure Storage account container storing activity logs is publicly accessible*
//RLP-153630

|The policy RQL will be updated to include Public network access and Private Endpoint check to increase the accuracy of RQL results.  

*Current RQL–* 
----
config from cloud.resource where api.name = 'azure-storage-account-list' AND json.rule= publicContainersList[*] contains insights-operational-logs and (properties.allowBlobPublicAccess is true or properties.allowBlobPublicAccess does not exist) as X; config from cloud.resource where api.name = 'azure-monitor-log-profiles-list' as Y; filter'$.X.id contains $.Y.properties.storageAccountId'; show X;
----

*Updated RQL–*
----
config from cloud.resource where api.name = 'azure-storage-account-list' AND json.rule= 'publicContainersList[*] contains insights-operational-logs and (totalPublicContainers > 0 and (properties.allowBlobPublicAccess is true or properties.allowBlobPublicAccess does not exist) and properties.publicNetworkAccess equal ignore case Enabled and networkRuleSet.virtualNetworkRules is empty and (properties.privateEndpointConnections is empty or properties.privateEndpointConnections does not exist))' as X; config from cloud.resource where api.name = 'azure-monitor-log-profiles-list' as Y; filter '$.X.id contains $.Y.properties.storageAccountId'; show X; 
----

*Policy Type–* Config

*Policy Severity–* Low

*Impact–* Medium. Existing alerts will be resolved as `Policy_Updated`.

|*Azure Storage Account storing Machine Learning workspace high business impact data is publicly accessible*
//RLP-153630

|The policy RQL will be updated to include Public network access and Private Endpoint check to increase the accuracy of RQL results.  

*Current RQL–* 
----
config from cloud.resource where api.name = 'azure-machine-learning-workspace' AND json.rule = 'properties.provisioningState equal ignore case Succeeded and properties.hbiWorkspace is true and properties.storageAccount exists' as X; config from cloud.resource where api.name = 'azure-storage-account-list' AND json.rule = 'totalPublicContainers > 0 and (properties.allowBlobPublicAccess is true or properties.allowBlobPublicAccess does not exist)' as Y; filter '$.X.properties.storageAccount contains $.Y.id'; show Y;
----

*Updated RQL–*
----
config from cloud.resource where api.name = 'azure-machine-learning-workspace' AND json.rule = 'properties.provisioningState equal ignore case Succeeded and properties.hbiWorkspace is true and properties.storageAccount exists' as X; config from cloud.resource where api.name = 'azure-storage-account-list' AND json.rule = 'totalPublicContainers > 0 and (properties.allowBlobPublicAccess is true or properties.allowBlobPublicAccess does not exist) and properties.publicNetworkAccess equal ignore case Enabled and networkRuleSet.virtualNetworkRules is empty and (properties.privateEndpointConnections is empty or properties.privateEndpointConnections does not exist)' as Y; filter '$.X.properties.storageAccount contains $.Y.id'; show Y; 
----

*Policy Type–* Config

*Policy Severity–* High

*Impact–* Medium. Existing alerts will be resolved as `Policy_Updated`.

|*Azure Storage Account storing Cognitive service diagnostic logs is publicly accessible*
//RLP-153630

|The policy RQL will be updated to include Public network access and Private Endpoint check to increase the accuracy of RQL results.  

*Current RQL–* 
----
config from cloud.resource where api.name = 'azure-cognitive-services-account-diagnostic-settings' AND json.rule = (properties.logs[?any(enabled equal ignore case "true")] exists or properties.metrics[?any( enabled equal ignore case "true" )] exists) and properties.storageAccountId exists as X; config from cloud.resource where api.name = 'azure-storage-account-list' AND json.rule = 'totalPublicContainers > 0 and (properties.allowBlobPublicAccess is true or properties.allowBlobPublicAccess does not exist)' as Y; filter '$.X.properties.storageAccountId contains $.Y.id'; show Y;
----

*Updated RQL–*
----
config from cloud.resource where api.name = 'azure-cognitive-services-account-diagnostic-settings' AND json.rule = (properties.logs[?any(enabled equal ignore case "true")] exists or properties.metrics[?any( enabled equal ignore case "true" )] exists) and properties.storageAccountId exists as X; config from cloud.resource where api.name = 'azure-storage-account-list' AND json.rule = 'totalPublicContainers > 0 and (properties.allowBlobPublicAccess is true or properties.allowBlobPublicAccess does not exist) and properties.publicNetworkAccess equal ignore case Enabled and networkRuleSet.virtualNetworkRules is empty and (properties.privateEndpointConnections is empty or properties.privateEndpointConnections does not exist)' as Y; filter '$.X.properties.storageAccountId contains $.Y.id'; show Y;
----

*Policy Type–* Config

*Policy Severity–* Medium

*Impact–* Medium. Existing alerts will be resolved as `Policy_Updated`.

|*GCP VPC Flow logs for the subnet is set to Off*
//RLP-153624

|The policy RQL and recommendation steps will be updated to reduce false positives by excluding unsupported subnet purposes.

*Current RQL–* 
----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-compute-networks-subnets-list' AND json.rule = purpose does not contain INTERNAL_HTTPS_LOAD_BALANCER and purpose does not contain REGIONAL_MANAGED_PROXY and (enableFlowLogs is false or enableFlowLogs does not exist)
----

*Updated RQL–*
----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-compute-networks-subnets-list' AND json.rule = purpose does not contain INTERNAL_HTTPS_LOAD_BALANCER and purpose does not contain REGIONAL_MANAGED_PROXY and purpose does not contain GLOBAL_MANAGED_PROXY and purpose does not contain PRIVATE_SERVICE_CONNECT and (enableFlowLogs is false or enableFlowLogs does not exist)
----

*Policy Type–* Config

*Policy Severity–* Informational

*Impact–* Low. Existing alerts where subnets with purpose `GLOBAL_MANAGED_PROXY` and `PRIVATE_SERVICE_CONNECT` will be resolved.

|*GCP VPC Network subnets have Private Google access disabled*
//RLP-153623

|The policy RQL and recommendation steps will be updated to reduce false positives by excluding unsupported subnet purposes.

*Current RQL–* 
----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-compute-networks-subnets-list' AND json.rule = purpose is not member of (REGIONAL_MANAGED_PROXY, PRIVATE_SERVICE_CONNECT) and (privateIpGoogleAccess does not exist or privateIpGoogleAccess is false)
----

*Updated RQL–*
----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-compute-networks-subnets-list' AND json.rule = purpose is not member of (REGIONAL_MANAGED_PROXY, PRIVATE_SERVICE_CONNECT, GLOBAL_MANAGED_PROXY, PRIVATE_NAT) and (privateIpGoogleAccess does not exist or privateIpGoogleAccess is false)
----

*Policy Type–* Config

*Policy Severity–* Low

*Impact–* Low. Existing alerts related to `GLOBAL_MANAGED_PROXY` and `PRIVATE_NAT` purposes will be resolved.

|*GCP VM instance Confidential VM service disabled*
//RLP-153054

|Policy RQL is updated to reduce the false positives by considering the CSP limitations{}.

*Current RQL–* 
----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-compute-instances-list' AND json.rule = status equal ignore case "RUNNING" and (machineType contains "machineTypes/n2d-" or machineType contains "machineTypes/c2d-") and (confidentialInstanceConfig.enableConfidentialCompute does not exist or confidentialInstanceConfig.enableConfidentialCompute is false)
----

*Updated RQL–*
----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-compute-instances-list' AND json.rule = status equal ignore case "RUNNING" and (machineType contains "machineTypes/n2d-" or machineType contains "machineTypes/c2d-" or machineType contains "machineTypes/c3d-" or machineType contains "machineTypes/c3-standard-")and (disks[*].guestOsFeatures[*].type contains "SEV_CAPABLE" or disks[*].guestOsFeatures[*].type contains "SEV_LIVE_MIGRATABLE_V2" or disks[*].guestOsFeatures[*].type contains "SEV_SNP_CAPABLE" or disks[*].guestOsFeatures[*].type contains "TDX_CAPABLE") and (confidentialInstanceConfig.enableConfidentialCompute does not exist or confidentialInstanceConfig.enableConfidentialCompute is false)
----

*Policy Type–* Config

*Policy Severity–* Medium

*Impact–* Medium. New Alerts would be triggered when the machine type is * c3-standard- and C3D. Open alerts with OS_FEATURE not containing SEV_CAPABLE, SEV_LIVE_MIGRATABLE_V2, SEV_SNP_CAPABLE, and TDX_CAPABLE will be resolved.


|===

[#iam-policy-updates]
=== IAM Policy Updates

The 25.1.1 release includes two new IAM policies and two IAM policy updates.

*New IAM Policies*

[cols="25%a,25%a,30%a,10%a,10%a"]
|===
|*Policy Name*
|*Description*
|*RQL*
|*Cloud*
|*Severity*

|Entra ID user owns an Entra ID service account with permission to add members to a group with admin privileges at the subscription/management group level
|This policy identifies Entra ID users that are owners of an App Registration which is granted Graph API or Entra ID permissions allowing it to add members to a group with administrative permissions at the Subscription or Management Group level
|config from iam where source.cloud.type = 'AZURE' AND source.cloud.azure.user.isAppRegistrationOwner = true AND grantedby.cloud.entity.type = 'Service Principal' AND dest.cloud.azure.group.isadministrative.grantedby.level.type in (('Directory.ReadWrite.All','Group.ReadWrite.All','GroupMember.ReadWrite.All','RoleManagement.ReadWrite.Directory','microsoft.directory/groups.security/owners/update','microsoft.directory/groups.security.assignedMembership/members/update','microsoft.directory/groups.security/members/update','microsoft.directory/groups.security/allProperties/update','microsoft.directory/groups.security/dynamicMembershipRule/update','microsoft.directory/groupsAssignableToRoles/allProperties/update','microsoft.directory/groups/members/update','microsoft.directory/groups/owners/update'), ('Azure Management Group', 'Azure Subscription' ) )
|Azure
|High

|Entra ID user can impersonate an Entra ID application with permission to add members to a group with admin privileges at the subscription/management group level
|This policy identifies Entra ID users that can impersonate an App Registration using the 'Create Credentials' or 'Change Ownership' features, where the App Registration is granted Graph API or Entra ID permissions allowing it to add members to a group with administrative permissions at the Subscription or Management Group level
|config from iam where source.cloud.type = 'AZURE' AND source.cloud.azure.user.canImpersonateAppReg = true AND grantedby.cloud.entity.type = 'Service Principal' AND dest.cloud.azure.group.isadministrative.grantedby.level.type in (('Directory.ReadWrite.All','Group.ReadWrite.All','GroupMember.ReadWrite.All','RoleManagement.ReadWrite.Directory','microsoft.directory/groups.security/owners/update','microsoft.directory/groups.security.assignedMembership/members/update','microsoft.directory/groups.security/members/update','microsoft.directory/groups.security/allProperties/update','microsoft.directory/groups.security/dynamicMembershipRule/update','microsoft.directory/groupsAssignableToRoles/allProperties/update','microsoft.directory/groups/members/update','microsoft.directory/groups/owners/update'), ('Azure Management Group', 'Azure Subscription' ) )
|Azure
|High

|===

*IAM Policy Updates*

[cols="25%a,25%a,30%a,10%a,10%a"]
|===
|*Policy Name*
|*Description*
|*RQL*
|*Cloud*
|*Severity*


|System/User-assigned managed identity with critical Entra ID permissions
|This policy detects Azure system-assigned and user-assigned managed identities that are granted critical Graph API permissions or assigned roles containing high-privilege Entra ID permissions. These permissions, such as the ability to create or modify critical resources, may lead to potential privilege escalation or data exfiltration risks.
|config from iam where source.cloud.type = 'AZURE' AND source.cloud.resource.type IN ('System Assigned','User Assigned','virtualMachines') and grantedby.cloud.entity.type in ('System Assigned','User Assigned') and action.name in ('Application.ReadWrite.All','Directory.ReadWrite.All','microsoft.directory/applications/owners/update','microsoft.directory/applications/credentials/update','RoleManagement.ReadWrite.Directory','microsoft.directory/groups.security/owners/update','microsoft.directory/groups.security.assignedMembership/members/update','microsoft.directory/groups.security/members/update','microsoft.directory/groups.unified/owners/update','microsoft.directory/groups.unified.assignedMembership/members/update','microsoft.directory/groups.unified/members/update','microsoft.directory/groupsAssignableToRoles/allProperties/update','User.ReadWrite.All','microsoft.directory/users/password/update','AppRoleAssignment.ReadWrite.All','microsoft.directory/servicePrincipals/appRoleAssignedTo/update','microsoft.directory/groups/members/update','microsoft.directory/groups/owners/update','Mail.ReadWrite','Files.ReadWrite.All','Sites.ReadWrite.All','Sites.FullControl.All')
|Azure
|High

|AWS resources that are publicly accessible through IAM policies
|This policy identifies the AWS resources which are publicly accessible through IAM policies. The policy considers AWS conditions that limit public access. Ensure that the AWS resources provisioned in your AWS account are not publicly accessible from the Internet to avoid sensitive data exposure and minimize security risks.
|config from iam where dest.cloud.type = ''AWS'' and source.public = true AND grantedby.cloud.policy.condition DOES NOT EXIST
|AWS
|Low

|===



[#new-compliance-benchmarks-and-updates]
=== New Compliance Benchmarks and Updates

[cols="50%a,50%a"]
|===
|*Compliance Benchmark*
|*Description*

|*Center for Internet Security (CIS) v3.0.0 (Azure) Level 1 and Level 2*
//RLP-154121

|Prisma Cloud now supports the latest version of the CIS Microsoft Azure Foundations Benchmark v3.0.0 compliance framework, including Level 1 and Level 2 assessments. The Level 1 benchmark focuses on essential security controls that are critical for protecting Azure resources, while Level 2 provides more stringent requirements for organizations seeking to implement advanced security measures. Noteworthy changes include updated syntax for procedures and a clear distinction between foundational and service category benchmarks.

You can now access this built-in compliance standard and related policies on the "Compliance > Standards" page. Additionally, users can generate reports for immediate viewing or downloading, as well as set up scheduled reports to continuously monitor compliance with the CIS Microsoft Azure Foundations Benchmark v3.0.0 framework over time, ensuring robust governance and security across Azure deployments.

|*Center for Internet Security (CIS) v4.0.0 (AWS) Level 1 and Level 2*
//RLP-154188

|Prisma Cloud now supports the latest version of the CIS Amazon Web Services Foundations Benchmark v4.0.0 compliance framework, including Level 1 and Level 2 assessments. The Level 1 benchmark focuses on essential security controls that are critical for protecting AWS resources, while Level 2 provides more stringent requirements for organizations seeking to implement advanced security measures. Noteworthy changes include updated syntax for procedures and a clear distinction between foundational and service category benchmarks.

You can now access this built-in compliance standard and related policies on the *Compliance > Standards* page. Additionally, users can generate reports for immediate viewing or downloading, as well as set up scheduled reports to continuously monitor compliance with the CIS AWS Foundations Benchmark v4.0.0 framework over time, ensuring robust governance and security across AWS deployments.

|*Health Insurance Portability and Accountability Act (HIPAA)*
//RLP-154120

tt:[Update]

|New Policy mappings are added to HIPAA compliance standard.

*Impact*: As new mappings are introduced, compliance scoring might vary.


|*National Cyber Security Center (NCSC) - Cyber Essentials*
//RLP-154202

|Prisma Cloud now supports the NCSC - Cyber Essentials compliance framework.  The UK's National Cyber Security Centre provided Cyber Essentials as a government backed certification scheme that helps  keep your organisation’s and your customers’ data safe from cyber attacks. The NCSC recommends Cyber Essentials as the minimum standard of cyber security for all organisations.

You can now access this built-in compliance standard and related policies on the *Compliance > Standards* page.


|*National Cyber Security Center (NCSC) -  Cloud Security Principles*
//RLP-154210

|Prisma Cloud now supports the NCSC - Cyber Essentials compliance framework.  The UK's National Cyber Security Centre provided Cyber Essentials as a government backed certification scheme that helps organisations enhance theircloud security posture.  

You can now access this built-in compliance standard and related policies on the *Compliance > Standards* page.


|*Trusted Information Security Assessment Exchange (TISAX)* 
//RLP-154119

|Prisma Cloud now supports the latest version of the TISAX compliance framework. This updated standard emphasizes a structured approach to information security management, particularly for organizations in the automotive industry. Notably, TISAX requires companies to demonstrate their capability to manage information security risks through a defined maturity model, which includes various levels of assessment ranging from basic self-assessment to comprehensive audits by accredited providers.

You can now access this built-in compliance standard and related policies on the *Compliance > Standards* page. Additionally, you can generate reports for immediate viewing or downloading, as well as set up scheduled reports to continuously monitor compliance with the TISAX framework over time. TISAX compliance helps you effectively manage and demonstrate your organization's adherence to stringent information security requirements to help safeguard sensitive automotive data against evolving threats.

|===

[#rest-api-updates]
=== REST API Updates

[cols="37%a,63%a"]
|===
|*Alert Evidence Graph*

tt:[25.1.1]
//RLP-153906

| 

|===

