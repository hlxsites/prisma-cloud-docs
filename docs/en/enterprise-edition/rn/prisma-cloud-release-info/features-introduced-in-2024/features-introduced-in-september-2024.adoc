== Features Introduced in September 2024

Learn what's new on Prisma® Cloud in September 2024.

* <<announcement>>
* <<new-features>>
* <<terraform-template-updates>>
* <<changes-in-existing-behavior>>
* <<api-ingestions>>
* <<new-policies>>
//* <<iam-policies>>
* <<policy-updates>>
* <<new-compliance-benchmarks-and-updates>>
* <<rest-api-updates>>
* <<deprecation-notice>>
//* <<end-of-sale>>

[#announcement]
=== Announcement


[cols="50%a,50%a"]
|===
|*Feature*
|*Description*

| *Lifecycle Support Update*

tt:[Secure the Runtime]

tt:[33.00.169]

//CWP-61282

| Prisma Cloud officially guarantees backward compatibility with up to two previous major versions (N-2).

Although the support lifecycle remains unchanged, starting from version 33.xx, Prisma Cloud will not restrict the usage of Defender versions or REST API calls from up to three major releases before the current version (upto N-3 major releases).

For example, with the current version at 33.xx, API calls and Defenders from version 30.xx will be allowed. However, support and complete backward compatibility is guaranteed for the 32.xx and 31.xx releases.

|===

[#new-features]
=== New Features

[cols="30%a,70%a"]
|===
|*Feature*
|*Description*

|*Package Operational Risks*

tt:[Secure the Source]
//BCE-33800

tt:[24.9.2]

| https://docs.prismacloud.io/en/enterprise-edition/content-collections/application-security/visibility/sbom/sbom#package-op-risk[Package Operational Risk] assesses the operational risk and potential impact of each open-source package in your codebase. This analysis results in package operational risk severity levels categorized into *High*, *Medium*, and *Low*. By prioritizing risks based on these categories, you can effectively focus remediation efforts on the most critical issues.


|*Improved Shared Views*
//RLP-147440

tt:[Secure the Infrastructure]

tt:[24.9.1]

|Enhancements to Saved Views in Prisma Cloud allow you to share custom views with ease. If you are the creator of a custom view, you can now set the default visibility of view when you share it. Navigate to *Home > Alerts > Manage Views* and use the checkbox option to *Make this dashboard visible for all viewers*. Previously, publicly shared views were hidden by default even when shared, and visibility had to toggled on individually. Views can also be toggled off if desired. Learn more about https://docs.prismacloud.io/en/enterprise-edition/content-collections/alerts/saved-views[Saved Views].

image::share-saved-views.png[]


|*Jira Integration Support for Versions 9.0 and Above*

tt:[Secure the Infrastructure]

tt:[24.9.1]

//RLP-141021

|Prisma Cloud has enhanced its Prisma Cloud Technical Documentation https://docs.prismacloud.io/en/enterprise-edition/content-collections/administration/configure-external-integrations-on-prisma-cloud/integrate-prisma-cloud-with-jira[Jira integration] to work with all Jira Cloud and Jira On-Premise versions including 9.0 and above. This enhancement will enable you to receive Prisma Cloud alert notifications in your Jira accounts.  

| *Transition from OVAL to VEX Format for Red Hat Security Data*

tt:[Secure the Runtime]

tt:[33.00.169]

// CWP-61485/CWP-59337

| Prisma Cloud is transitioning from the OVAL format to the new VEX format that Red Hat has introduced and adopted for reporting security data and vulnerabilities in Red Hat artifacts.

*Pre-33.00*: Until you upgrade to a 33.xx release, Prisma Cloud will continue using OVAL for vulnerability scanning with no expected impact.

*33.xx*: After upgrading your Console and Defenders to version 33.00 or later, Prisma Cloud will switch to the VEX format for vulnerability reporting. This transition might result in a change in the number of reported CVEs due to the inherent differences between the VEX and OVAL content.

*Comparison Between OVAL and VEX Formats*: With the OVAL format, Prisma Cloud reports vulnerabilities for each binary found during the scan. However, with the new VEX format, Prisma Cloud will report one vulnerability for the source package and provide information on related binaries.

This means that the number of vulnerabilities with the same CVE ID will be reduced, as Prisma Cloud will report one vulnerability for the RPM package instead of multiple reports for each binary.

*Continued Support*: Prisma Cloud will continue to support OVAL format for two major versions—v33.xx and v34.xx—to maintain compatibility with Defenders in pre-33.xx releases, as long as Red Hat continues to produce OVAL files.

*Expected Console Loading Time in the 33.xx release*: For new Consoles paired with new Defenders, the Console loading time after a restart event will be approximately 1-2 minutes.

*Console Memory Usage in the 33.XX release*: For on-premise users upgrading to the latest Console, the Console memory requirement is 8 GB. This requirement is only for the self-hosted editions.

For a more detailed explanation of this transition, see the https://main%2D%2Dprisma-cloud-docs-website%2D%2Dhlxsites.hlx.live/en/compute-edition/assets/pdf/lookahead-transition-to-vex-format.pdf[Transition from Oval to VEX Files] document.

If you have any concerns or need additional information about this transition, contact support@paloaltonetworks.com.

| *Enhancement to WAAS Agentless Support*

tt:[Secure the Runtime]

tt:[33.00.169]

// CWP-59339

| WAAS agentless rules now support traffic inspection for AWS Application Load Balancers (ALBs) in addition to AWS EC2 instances. Ensure your AWS account is onboarded to the Prisma Cloud console and then configure the ALB rule.

To add the ALB rule access *Defend > WAAS > Add Rule > Add Configuration*. Ensure your CloudFormation template is applied with the necessary permissions to your onboarded AWS account in the region where the ALB resides. You can view the scan results in the Prisma Cloud console to monitor and manage your ALB traffic inspection.

NOTE: This feature is enabled on request. Please contact your Account team for more details.

|===

[#terraform-template-updates]
=== Updates to Terraform Template

[cols="30%a,70%a"]
|===
|*Updates to Terraform Template*
|*Description*

|*Azure*
//PCSUP-24985

tt:[24.9.2]

|The following Azure permissions have been removed from the Prisma Cloud Azure Terraform template since they were deprecated by Azure:

* `Microsoft.MachineLearning/commitmentPlans/read`
* `Microsoft.MachineLearning/webServices/read`
* `Microsoft.MachineLearning/workspaces/read`

|===

[#changes-in-existing-behavior]
=== Changes in Existing Behavior

[cols="50%a,50%a"]
|===
|*Feature*
|*Description*

|*Audit Logs Retention Period*
//RLP-146965, RLP-147876

tt:[24.9.2]

|The Audit logs from AWS, Azure, GCP Cloud providers, and Prisma Cloud are purged from the live system after 120 days or when the total number of logs exceeds 1.2 billion, whichever comes first. Once the logs are purged, they are no longer accessible via RQL queries on the *Investigate* page in Prisma Cloud. However, the data on the logs are retained in an archived, encrypted format for the duration of your contract.

*Impact—* Once the logs are purged, they will not be accessible via RQL queries on the *Investigate* page in Prisma Cloud. However, the data on the logs will be retained in an archived, encrypted format for the duration of your contract. 

To retrieve any purged data, contact your Prisma Cloud Customer Success Representative.


|*Audit Logs Warning*
//RLP-148505

tt:[24.9.1]

|If you have configured your AWS account or organization to ingest audit logs through EventBridge, you might see a warning message stating: 
`Rule <prisma-cloud-your-tenant-id-audit-logs-rule> does not exist on EventBus default in <region>`

This warning is due to performance enhancements in the EventBridge rule configuration, which do not affect system functionality.
To resolve the warning, download the CloudFormation Template (CFT) from *Misconfigurations > Near Real-Time Visibility > Edit*, and update your CFT stack in AWS. For detailed instructions, see https://docs.prismacloud.io/en/enterprise-edition/content-collections/connect/connect-cloud-accounts/onboard-aws/configure-audit-logs#:~:text=Time%20Visibility.-,Configure%20Details.,-Click%20Download%20EventBridge[Configure Audit Logs].

*Impact—* Updating the CFT will result in an increase in the number of EventBridge rules enabling Prisma Cloud to ingest only the relevant audit logs.

|===


[#api-ingestions]
=== API Ingestions

[cols="30%a,70%a"]
|===
|*Service*
|*API Details*

|*Amazon Bedrock*

tt:[24.9.2]
//RLP-148145

|*aws-bedrock-model-invocation-logging-configuration*

Additional permission required:

* `bedrock:GetModelInvocationLoggingConfiguration`

The Security Audit role includes the above permission.

|*Amazon Bedrock*

tt:[24.9.2]
//RLP-148144

|*aws-bedrock-provisioned-model-throughput*

Additional permissions required:

* `bedrock:ListProvisionedModelThroughputs`
* `bedrock:GetProvisionedModelThroughput`
* `bedrock:ListTagsForResource`

The Security Audit role includes the `bedrock:ListTagsForResource` permission.

The Security Audit role does not include the `bedrock:ListProvisionedModelThroughputs` and `bedrock:GetProvisionedModelThroughput` permissions. You must manually add them to the CFT template to enable them.

|*Amazon Bedrock*

tt:[24.9.2]
//RLP-148141

|*aws-bedrock-model-customization-job*

Additional permissions required:

* `bedrock:ListModelCustomizationJobs`
* `bedrock:GetModelCustomizationJob`
* `bedrock:ListTagsForResource`

The Security Audit role includes the `bedrock:ListTagsForResource` permission.

The Security Audit role does not include the `bedrock:ListModelCustomizationJobs` and `bedrock:GetModelCustomizationJob` permissions. You must manually add them to the CFT template to enable them.

|*Amazon Bedrock*

tt:[24.9.2]
//RLP-148135

|*aws-bedrock-knowledgebase*

Additional permissions required:

* `bedrock:ListKnowledgeBases`
* `bedrock:GetKnowledgeBase`
* `bedrock:ListTagsForResource`

The Security Audit role includes the `bedrock:ListTagsForResource` permission.

The Security Audit role does not include the `bedrock:ListKnowledgeBases` and `bedrock:GetKnowledgeBase` permissions. You must manually add them to the CFT template to enable them.


|tt:[Update] *Amazon Dynamo DB*

tt:[24.9.2]
//RLP-149082

|*aws-dynamodb-describe-table*

The `aws-dynamodb-describe-table` is updated to include a new CSP API `GetResourcePolicy` which ingests resource based policy information.

Additional permission required:

* `dynamodb:GetResourcePolicy`

The Security Audit role does not include the above permission. You must manually add the permission to the CFT template to enable it.


|tt:[Update] *Amazon APIs*

tt:[24.9.2]
//RLP-148998

|The resource JSON for the following APIs are updated to include a new field `BucketName`:

* *aws-glue-job*
* *aws-emr-studio*
* *aws-sagemaker-domain*

|*Amazon Redshift*

tt:[24.9.2]
//RLP-148150

|*aws-redshift-serverless-workgroup*

Additional permission required:

* `redshift-serverless:ListWorkgroups`

The Security Audit role includes the above permission.

|*AWS Security Hub*

tt:[24.9.2]
//RLP-148149

|*aws-securityhub-enabled-products-for-import*

Additional permission required:

* `securityhub:ListEnabledProductsForImport`

The Security Audit role includes the above permission.


|tt:[Update] *Google BigQuery Data Transfer*

tt:[24.9.2]
//RLP-149623

|*gcloud-bigquery-data-transfer-config*

Additional permission required:

* `bigquery.transfers.get`

The Viewer role includes the above permission.

tt:[NOTE:] API has been updated to ingest resources from all supported regions except the region `me-central2 due` to platform dependencies.


|*OCI Web Application Firewall*

tt:[24.9.2]
//RLP-148332

|*oci-loadbalancer-waf*

Additional permissions required:

* `WEB_APP_FIREWALL_INSPECT`
* `WEB_APP_FIREWALL_READ`

The Reader role includes the above permissions.

|*Azure Databricks*
//RLP-147853

tt:[24.9.1]

|*azure-databricks-access-connectors*

Additional permission required:

* `Microsoft.Databricks/accessConnectors/read`

The Reader role includes the above permission.

|*Azure Active Directory*
//RLP-128447

tt:[24.9.1]

|*azure-active-directory-admin-consent-request-policy*

Additional permission required:

* `Policy.Read.All`

The Global Reader role includes the above permission.

|*Azure Active Directory*
//RLP-128079

tt:[24.9.1]

|*azure-active-directory-cross-tenant-access-default-settings*

Additional permission required:

* `Policy.Read.All`

The Global Reader role includes the above permission.

|*Azure Active Directory*
//RLP-127879

tt:[24.9.1]

|*azure-active-directory-configured-external-identity-provider*

Additional permission required:

* `IdentityProvider.Read.All`

//The External Identity Provider Administrator or External ID user flow administrator role includes the above permission.

|*Google Cloud Batch Job*
//RLP-148101

tt:[24.9.1]

|*gcloud-cloud-batch-job*

Additional permission required:

* `batch.jobs.list`

The Viewer role includes the above permission.

|*Google Kubernetes Engine*
//RLP-149148

tt:[24.9.1]

|*gcloud-container-describe-clusters*

Additional permission required:

* `container.clusters.getCredentials`

You must manually add the permission to a Custom role.


| WAAS Agentless - Support AWS LB

tt:[33.00.169]

// CWP-59340

| The https://pan.dev/prisma-cloud/api/cwpp/put-policies-firewall-app-agentless/[Set Agentless App Firewall Policy] API request is updated to support AWS Application Load Balancers (ALBs):

* The “trafficMirroring > vpcConfig” property is modified to include three new fields for ALBs:
** lbARN - ARN of the observed load balancer.
** lbName - Load balancer name.
** lbType - Load balance type.

* The following existing fields are now applicable as follows:

** instanceNames -  used only in EC2 rules.
** subnetID - used only in EC2 rules.
** tags - used only in EC2 rules.
** vpcID - must be empty (””) for ALB rules.
** autoScalingEnabled - must be true for ALB rules.

|===


[#new-policies]
=== New Policies

[cols="50%a,50%a"]
|===
|*Policies*
|*Description*

|*AWS S3 bucket used for storing AWS Bedrock Custom model training artifacts*

tt:[24.9.2]
//RLP-149533

|This policy identifies the AWS S3 bucket used for storing AWS Bedrock Custom model training job output.

S3 buckets hold the results and artifacts generated from training models in AWS Bedrock. Ensuring proper configuration and access control is crucial to maintaining the security and integrity of the training output. Improperly secured S3 buckets used for storing AWS Bedrock training output can lead to unauthorized access and potential exposure of model information.

It is recommended to implement strict access controls, enable encryption, and audit permissions to secure AWS S3 buckets for AWS Bedrock training job output and ensure compliance.

NOTE: This policy is designed to identify the S3 buckets utilized for storing results and storing artifacts generated from training custom models in AWS Bedrock. It does not signify any detected misconfiguration or security risk.

*Policy Severity—* Informational

*Policy Type—* Config

----
config from cloud.resource where api.name = 'aws-s3api-get-bucket-acl' as X; config from cloud.resource where api.name = 'aws-bedrock-custom-model' as Y; filter ' $.Y.outputDataConfig.bucketName equals $.X.bucketName'; show X;
----

|*AWS S3 bucket is utilized for AWS Bedrock Custom model training data*

tt:[24.9.2]
//RLP-149529

|This policy identifies the AWS S3 bucket utilized for AWS Bedrock Custom model training job data.

S3 buckets store the datasets required for training Custom models in AWS Bedrock. Proper configuration and access control are essential to ensure the security and integrity of the training data. Improperly configured S3 buckets used for AWS Bedrock Custom model training data can lead to unauthorized access, data breaches, and potential loss of sensitive information.

It is recommended to implement strict access controls, enable encryption, and audit permissions to secure AWS S3 buckets for AWS Bedrock Custom model training data and ensure compliance.

NOTE: This policy is designed to identify the S3 buckets utilized for training custom models in AWS Bedrock. It does not signify any detected misconfiguration or security risk.

*Policy Severity—* Informational

*Policy Type—* Config

----
config from cloud.resource where api.name = 'aws-s3api-get-bucket-acl' as X; config from cloud.resource where api.name = 'aws-bedrock-custom-model' as Y; filter ' $.Y.trainingDataConfig.bucketName equals $.X.bucketName'; show X; 
----

|*AWS Bedrock Custom model encrypted with Customer Managed Key (CMK) is not enabled for regular rotation*

tt:[24.9.2]
//RLP-149520

|This policy identifies AWS Bedrock Custom model encrypted with Customer Managed Key (CMK) is not enabled for regular rotation.

AWS KMS (Key Management Service) allows customers to create master keys to encrypt the Custom model. Not enabling regular rotation for AWS Bedrock custom model key rotation failure can result in potential compliance violations.

As a security best practice, it is important to rotate the keys periodically so that if the keys are compromised, the data in the underlying service is still secure with the new keys.

*Policy Severity—* Informational

*Policy Type—* Config

----
config from cloud.resource where api.name = 'aws-bedrock-custom-model' as X; config from cloud.resource where api.name = 'aws-kms-get-key-rotation-status' AND json.rule = keyMetadata.keyState equals Enabled and keyMetadata.keyManager equal ignore case CUSTOMER and keyMetadata.origin equals AWS_KMS and (rotation_status.keyRotationEnabled is false or rotation_status.keyRotationEnabled equals "null") as Y; filter '$.X.modelKmsKeyArn equals $.Y.key.keyArn'; show X;
----

|*Azure DNS Zone having dangling DNS Record vulnerable to subdomain takeover associated with Azure Storage account blob*

tt:[24.9.2]
//RLP-149355

|This policy identifies DNS records within an Azure DNS zone that point to Azure Storage Account blobs that no longer exist.

A dangling DNS attack happens when a DNS record points to a cloud resource that has been deleted or is inactive, making the subdomain vulnerable to takeover. An attacker can exploit this by creating a new resource with the same name and taking control of the subdomain to serve malicious content. This allows attackers to host harmful content under your subdomain, which could lead to phishing attacks, data breaches, and damage to your reputation. The risk arises because the DNS record still references a non-existent resource, which unauthorized individuals can re-associate with their own resources.

As a security best practice, it is recommended to routinely audit DNS zones and remove or update DNS records pointing to non-existing Azure Storage Account blobs.

*Policy Severity—* High

*Policy Type—* Config

----
config from cloud.resource where api.name = 'azure-dns-recordsets' AND json.rule = type contains CNAME and properties.CNAMERecord.cname contains "web.core.windows.net" as X; config from cloud.resource where api.name = 'azure-storage-account-list' AND json.rule = properties.provisioningState equal ignore case Succeeded and properties.primaryEndpoints.web exists as Y; filter 'not ($.Y.properties.primaryEndpoints.web contains $.X.properties.CNAMERecord.cname) '; show X;
----

|*Azure DNS Zone having dangling DNS Record vulnerable to subdomain takeover associated with Web App Service*

tt:[24.9.2]
//RLP-149354

|This policy identifies DNS records within an Azure DNS zone that point to Azure Web App Services that no longer exist.

A dangling DNS attack happens when a DNS record points to a cloud resource that has been deleted or is inactive, making the subdomain vulnerable to takeover. An attacker can exploit this by creating a new resource with the same name and taking control of the subdomain to serve malicious content. This allows attackers to host harmful content under your subdomain, which could lead to phishing attacks, data breaches, and damage to your reputation. The risk arises because the DNS record still references a non-existent resource, which unauthorized individuals can re-associate with their own resources.

As a security best practice, it is recommended to routinely audit DNS zones and remove or update DNS records pointing to non-existing Web App Services.

*Policy Severity—* High

*Policy Type—* Config

----
config from cloud.resource where api.name = 'azure-dns-recordsets' AND json.rule = type contains CNAME and properties.CNAMERecord.cname contains "azurewebsites.net" as X; config from cloud.resource where api.name = 'azure-app-service' AND json.rule = properties.state equal ignore case Running as Y;  filter 'not ($.Y.properties.hostNames contains $.X.properties.CNAMERecord.cname) '; show X; 
----

|*GCP Storage bucket CMEK not rotated every 90 days*

tt:[24.9.2]
//RLP-148007

|This policy identifies GCP Storage bucket with CMEK that are not rotated every 90 days

A CMEK (Customer-Managed Encryption Key), which is configured for a GCP bucket becomes vulnerable over time due to prolonged use. Without regular rotation, the key is at greater risk of being compromised, which could lead to unauthorized access to the encrypted data in the bucket. This can undermine the security of your data and increase the chances of a breach if the key is exposed or exploited.

It is recommended to configure rotation less than 90 days for CMEKs used for GCP buckets.

*Policy Severity—* Informational

*Policy Type—* Config

----
config from cloud.resource where api.name = 'gcloud-kms-crypto-keys-list' AND json.rule = primary.state equals "ENABLED" and (rotationPeriod does not exist or rotationPeriod greater than 7776000) as X; config from cloud.resource where api.name = 'gcloud-storage-buckets-list' as Y; filter ' $.X.name equals $.Y.encryption.defaultKmsKeyName'; show Y;
----

|*GCP Storage bucket using a disabled CMEK*

tt:[24.9.2]
//RLP-148002

|This policy identifies GCP Storage buckets that are using a disabled CMEK.

CMEK (Customer-Managed Encryption Keys) for GCP buckets allows you to use your own encryption keys to secure data stored in Google Cloud Storage. If a CMEK defined for a GCP bucket is disabled, the data in that bucket becomes inaccessible, as the encryption keys are no longer available to decrypt the data. This can lead to data loss and operational disruption. If not properly managed, CMEK can also introduce risks such as accidental key deletion or mismanagement, which could compromise data availability and security.

It is recommended to review the state of CMEK and enable it to keep the data in the bucket accessible.

*Policy Severity—* Low

*Policy Type—* Config

----
config from cloud.resource where api.name = 'gcloud-kms-crypto-keys-list' AND json.rule = primary.state does not equal "ENABLED" as X; config from cloud.resource where api.name = 'gcloud-storage-buckets-list' as Y; filter ' $.X.name equals $.Y.encryption.defaultKmsKeyName'; show Y;
----

|*GCP VM instance is assigned with public IP*

tt:[24.9.2]
//RLP-147863

|This policy identifies GCP VM instances that are assigned a public IP.

Using a public IP with a GCP VM exposes it directly to the internet, increasing the risk of unauthorized access and attacks. This makes the VM vulnerable to threats such as brute force attempts, DDoS attacks, and other malicious activities. To mitigate these risks, it's safer to use private IPs and secure access methods like VPNs or load balancers.

It is recommended to avoid assigning public IPs to VM instances.

*Policy Severity—* Low

*Policy Type—* Config

----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-compute-instances-list' AND json.rule = name does not start with "gke-" and (networkInterfaces[*].accessConfigs exists or networkInterfaces.ipv6AccessConfigs exists)
----

|*GCP VM instance with Shielded VM Secure Boot disabled*

tt:[24.9.2]
//RLP-147863

|This policy identifies GCP VM instances that have Shielded VM Secure Boot disabled.

Secure Boot is a security feature that ensures only trusted, digitally signed software runs during the boot process of a computer. Enabling it helps protect against malware and unauthorized software by verifying the integrity of the bootloader and operating system. Without Secure Boot, systems are vulnerable to rootkits, bootkits, and other malicious code that can compromise the system from the start, making it difficult to detect and remove such threats.

It is recommended to enable Shielded VM secure boot for GCP VM instances.

*Policy Severity—* Low

*Policy Type—* Config

----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-compute-instances-list' AND json.rule = status equals RUNNING and name does not start with "gke-" and (shieldedInstanceConfig does not exist or shieldedInstanceConfig.enableSecureBoot is false )
----

|*GCP OS Image is publicly accessible*

tt:[24.9.2]
//RLP-147856

|This policy identifies GCP OS Images that are publicly accessible.

Custom GCP OS images are user-created operating system images tailored to specific needs and configurations. Making these images public can expose sensitive data, proprietary software, and security vulnerabilities. This can lead to unauthorized access, data breaches, and system exploitation, compromising your infrastructure's security and integrity.

It is recommended to keep OS images private unless required for organizational needs.

*Policy Severity—* Low

*Policy Type—* Config

----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-compute-image' AND json.rule = iamPolicy.bindings[?any( members contains "allAuthenticatedUsers" )] exists
----

|*OCI Compute Instance with Secure Boot disabled*

tt:[24.9.2]
//RLP-149358

|This policy identifies OCI compute instances in which Secure Boot is disabled.

Secure Boot serves as a security standard ensuring that a machine exclusively boots using Original Equipment Manufacturer (OEM) trusted software. Without the activation of Secure Boot, a compute instance becomes susceptible to booting unauthorized or malicious software, posing a threat to the integrity and security of the instance. Consequently, this vulnerability can lead to unauthorized access, data breaches, or other malicious activities within the instance.

As a security best practice, enabling Secure Boot on all compute instances is strongly recommended to guarantee the exclusive execution of trusted software during the boot process.

*Policy Severity—* Low

*Policy Type—* Config

----
config from cloud.resource where cloud.type = 'oci' AND api.name = 'oci-compute-instance' AND json.rule = lifecycleState equal ignore case running AND (platformConfig does not exist OR platformConfig equal ignore case "null" OR platformConfig.isSecureBootEnabled is false)
----

|*AWS IAM user is not a member of any IAM group*

tt:[24.9.1]
//RLP-148660

|This policy identifies an AWS IAM user as not being a member of any IAM group.

It is generally a best practice to assign IAM users to at least one IAM group. If the IAM users are not in a group, it complicates permission management and auditing, increasing the risk of privilege mismanagement and security oversights. It also leads to higher operational overhead and potential non-compliance with security best practices.

It is recommended to ensure all IAM users are part of at least one IAM group according to your business requirement to simplify permission management, enforce consistent security policies, and reduce the risk of privilege mismanagement.

*Policy Severity—* Informational

*Policy Type—* Config

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-iam-list-users' AND json.rule = groupList is empty
----

|*AWS KMS Customer Managed Key (CMK) is disabled*

tt:[24.9.1]
//RLP-148659

|This policy identifies the AWS KMS Customer Managed Key (CMK) that is disabled.

Ensuring that your Amazon Key Management Service (AWS KMS) key is enabled is important because it determines whether the key can be used to perform cryptographic operations.  If an AWS KMS Key is disabled, any operations dependent on that key, such as encryption or decryption of data, will fail. This can lead to application downtime, data access issues, and potential data loss if not addressed promptly.

It is recommended to enable the AWS KMS Customer Managed Key (CMK) if it is used in the application, to restore cryptographic operations and ensure your applications and services can access encrypted data.

*Policy Severity—* Informational

*Policy Type—* Config

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-kms-get-key-rotation-status' AND json.rule = keyMetadata.enabled is false
----

|*Azure Cognitive Services account hosted with OpenAI is not configured with data loss prevention*

tt:[24.9.1]
//RLP-124566

|This policy identifies Azure Cognitive Services accounts hosted with OpenAI that are not configured with data loss prevention. 

Azure AI services offer data loss prevention capabilities that allow customers to configure the list of outbound URLs their Azure AI services resources can access.

As a best practice, it is recommended to enable the data loss prevention feature in OpenAI-hosted Azure Cognitive Services accounts to prevent data loss.

*Policy Severity—* High

*Policy Type—* Config

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-cognitive-services-account' AND json.rule = kind equal ignore case OpenAI and properties.provisioningState equal ignore case Succeeded and (properties.restrictOutboundNetworkAccess does not exist or properties.restrictOutboundNetworkAccess is false or (properties.restrictOutboundNetworkAccess is true and properties.allowedFqdnList is empty))
----

|*Azure Storage account diagnostic setting for blob is disabled*

tt:[24.9.1]
//RLP-139073

|This policy identifies Azure Storage account blobs that have diagnostic logging disabled.

By enabling diagnostic settings, you can capture various types of activities and events occurring within these storage account blobs. These logs provide valuable insights into the operations, performance, and security of the storage account blobs.

*Policy Severity—* Low

*Policy Type—* Config

----
config from cloud.resource where api.name = 'azure-storage-account-list' AND json.rule = properties.provisioningState equal ignore case Succeeded as X; config from cloud.resource where api.name = 'azure-storage-account-blob-diagnostic-settings' AND json.rule = properties.logs[*].enabled all true as Y; filter 'not($.X.name equal ignore case $.Y.StorageAccountName)'; show X;
----

|*Azure Storage account diagnostic setting for file is disabled*

tt:[24.9.1]
//RLP-139080

|This policy identifies Azure Storage account files that have diagnostic logging disabled.

By enabling diagnostic settings, you can capture various types of activities and events occurring within these storage account files. These logs provide valuable insights into the operations, performance, and security of the storage account files.

As a best practice, it is recommended to enable diagnostic logs on all storage account files.

*Policy Severity—* Low

*Policy Type—* Config

----
config from cloud.resource where api.name = 'azure-storage-account-list' AND json.rule = properties.provisioningState equal ignore case Succeeded as X; config from cloud.resource where api.name = 'azure-storage-account-file-diagnostic-settings' AND json.rule = properties.logs[*].enabled all true as Y; filter 'not($.X.name equal ignore case $.Y.StorageAccountName)'; show X;
----

|*Azure Storage account diagnostic setting for queue is disabled*

tt:[24.9.1]
//RLP-139081

|This policy identifies Azure Storage account queues that have diagnostic logging disabled.

By enabling diagnostic settings, you can capture various types of activities and events occurring within these storage account queues. These logs provide valuable insights into the operations, performance, and security of the storage account queues.

As a best practice, it is recommended to enable diagnostic logs on all storage account queues.

*Policy Severity—* Low

*Policy Type—* Config

----
config from cloud.resource where api.name = 'azure-storage-account-list' AND json.rule = properties.provisioningState equal ignore case Succeeded as X; config from cloud.resource where api.name = 'azure-storage-account-queue-diagnostic-settings' AND json.rule = properties.logs[*].enabled all true as Y; filter 'not($.X.name equal ignore case $.Y.StorageAccountName)'; show X;
----

|*Azure Storage account diagnostic setting for table is disabled*

tt:[24.9.1]
//RLP-139082

|This policy identifies Azure Storage account tables that have diagnostic logging disabled.

By enabling diagnostic settings, you can capture various types of activities and events occurring within these storage account tables. These logs provide valuable insights into the operations, performance, and security of the storage account tables.

As a best practice, it is recommended to enable diagnostic logs on all storage account tables.

*Policy Severity—* Low

*Policy Type—* Config

----
config from cloud.resource where api.name = 'azure-storage-account-list' AND json.rule = properties.provisioningState equal ignore case Succeeded as X; config from cloud.resource where api.name = 'azure-storage-account-table-diagnostic-settings' AND json.rule = properties.logs[*].enabled all true as Y; filter 'not($.X.name equal ignore case $.Y.StorageAccountName)'; show X;
----

|*Azure Application Gateway listener not secured with SSL profile*

tt:[24.9.1]
//RLP-147324

|This policy identifies Azure Application Gateway listeners that are not secured with an SSL profile.

An SSL profile provides a secure channel by encrypting the data transferred between the client and the application gateway. Without SSL profiles, the data transferred is vulnerable to interception, posing security risks. This could lead to potential data breaches and compromise sensitive information.

As a security best practice, it is recommended to secure all Application Gateway listeners with SSL profiles. This ensures data confidentiality and integrity by encrypting traffic.

*Policy Severity—* Low

*Policy Type—* Config

----
config from cloud.resource where cloud.type = 'azure' and api.name = 'azure-application-gateway' AND json.rule = ['properties.provisioningState'] equal ignore case Succeeded AND ['properties.httpListeners'][].['properties.provisioningState'] equal ignore case Succeeded AND ['properties.httpListeners'][].['properties.protocol'] equal ignore case Https AND ['properties.httpListeners'][*].['properties.sslProfile'].['id'] does not exist
----

|*Azure Virtual Desktop workspace diagnostic log is disabled*

tt:[24.9.1]
//RLP-147325

|This policy identifies Azure Virtual Desktop workspaces where diagnostic logs are not enabled.

Diagnostic logs are vital for monitoring and troubleshooting Azure Virtual Desktop, which offers virtual desktops and remote app services. They help detect and resolve issues, optimize performance, and meet security and compliance standards. Without these logs, it’s difficult to track activities and detect anomalies, potentially jeopardizing security and efficiency.

As a best practice, it is recommended to enable diagnostic logs for Azure Virtual Desktop workspaces.

*Policy Severity—* Low

*Policy Type—* Config

----
config from cloud.resource where cloud.type = 'azure' and api.name = 'azure-virtual-desktop-workspace' AND json.rule = diagnostic-settings[?none( properties.logs[?any( enabled is true )] exists )] exists 
----

|*Azure Virtual Desktop disk encryption not configured with Customer Managed Key (CMK)*

tt:[24.9.1]
//RLP-148369

|This policy identifies Azure Virtual Desktop environments where disk encryption is not configured using a Customer Managed Key (CMK). 

Disk encryption is crucial for protecting data in Azure Virtual Desktop environments. By default, disks may be encrypted with Microsoft-managed keys, which might not meet specific security requirements. Using Customer Managed Keys (CMKs) offers better control over encryption, allowing organizations to manage key rotation, access, and revocation, thereby enhancing data security and compliance.

As a best practice, it is recommended to configure disk encryption for Azure Virtual Desktop with a Customer Managed Key (CMK). 

*Policy Severity—* Low

*Policy Type—* Config

----
config from cloud.resource where api.name = 'azure-vm-list' AND json.rule = ['Extensions'].['Microsoft.PowerShell.DSC'].['settings'].['properties'].['hostPoolName'] exists and powerState contains running as X; config from cloud.resource where api.name = 'azure-disk-list' AND json.rule = provisioningState equal ignore case Succeeded and (encryption.type does not contain "EncryptionAtRestWithCustomerKey" or encryption.diskEncryptionSetId does not exist) as Y; filter ' $.X.id equal ignore case $.Y.managedBy '; show Y;
----

|*Azure Virtual Machine not protected with Azure Backup*

tt:[24.9.1]
//RLP-148370

|This policy identifies Azure Virtual Machines that are not protected by Azure Backup.

Without Azure Backup, VMs are at risk of data loss due to accidental deletion, corruption, or ransomware attacks. Unprotected VMs may also not comply with organizational data retention policies and regulatory requirements.

As a best practice, it is recommended to configure Azure Backup for all VMs to ensure data protection and enable recovery options in case of unexpected failures or incidents.

*Policy Severity—* Low

*Policy Type—* Config

----
config from cloud.resource where api.name = 'azure-recovery-service-backup-protected-item' AND json.rule = properties.workloadType equal ignore case VM as X; config from cloud.resource where api.name = 'azure-vm-list' AND json.rule = powerState contains running as Y; filter 'not $.Y.id equal ignore case $.X.properties.virtualMachineId'; show Y;
----

|===


[#policy-updates]
=== Policy Updates

[cols="50%a,50%a"]
|===
|*Policy Updates*
|*Description*

2+|*Policy Updates—RQL*

|*GCP GKE unsupported Master node version*
//RLP-149471

tt:[24.9.2]

|*Changes—* The policy RQL and recommendation steps are updated to support GKE version 1.31.

*Current RQL—* 
----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-container-describe-clusters' AND json.rule = NOT ( currentMasterVersion starts with "1.27." or currentMasterVersion starts with "1.28." or currentMasterVersion starts with "1.29." or currentMasterVersion starts with "1.30." )
----

*Updated RQL—* 
----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-container-describe-clusters' AND json.rule = NOT ( currentMasterVersion starts with "1.27." or currentMasterVersion starts with "1.28." or currentMasterVersion starts with "1.29." or currentMasterVersion starts with "1.30." or currentMasterVersion starts with "1.31." )
----

*Policy Severity—* Medium

*Policy Type—* Config

*Impact—* Low. Existing alerts where the GKE version is 1.31 will be resolved.

|*GCP GKE unsupported node version*
//RLP-149471

tt:[24.9.2]

|*Changes—* The policy RQL and recommendation steps are updated to support GKE version 1.31.

*Current RQL—* 
----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-container-describe-clusters' AND json.rule = NOT ( currentNodeVersion starts with "1.27." or currentNodeVersion starts with "1.28." or currentNodeVersion starts with "1.29." or currentNodeVersion starts with "1.30." )
----

*Updated RQL—* 
----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-container-describe-clusters' AND json.rule = NOT ( currentNodeVersion starts with "1.27." or currentNodeVersion starts with "1.28." or currentNodeVersion starts with "1.29." or currentNodeVersion starts with "1.30."  or currentNodeVersion starts with "1.31.")
----

*Policy Severity—* Medium

*Policy Type—* Config

*Impact—* Low. Existing alerts where the GKE version is 1.31 will be resolved.

|*GCP User managed service account keys are not rotated for 90 days*
//RLP-26599

tt:[24.9.2]

|*Changes—* The policy RQL is updated to exclude disabled service accounts

*Current RQL—* 
----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-iam-service-accounts-keys-list' AND json.rule = 'name contains iam.gserviceaccount.com and (_DateTime.ageInDays($.validAfterTime) > 90) and keyType equals USER_MANAGED'
----

*Updated RQL—* 
----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-iam-service-accounts-keys-list' AND json.rule = 'disabled is false and name contains iam.gserviceaccount.com and (_DateTime.ageInDays($.validAfterTime) > 90) and keyType equals USER_MANAGED'
----

*Policy Severity—* Informational

*Policy Type—* Config

*Impact—* Low. Existing alerts are resolved for the disabled service accounts.


|*Azure Key Vault Firewall is not enabled*
//RLP-148542

tt:[24.9.1]

|*Changes—* The policy RQL is updated to reduce false positives and only generate alerts if public access is enabled.

*Current RQL—* 
----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-key-vault-list' AND json.rule = properties.networkAcls.ipRules[*].value does not exist AND properties.publicNetworkAccess does not equal ignore case "disabled"
----
*Updated RQL—* 
----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-key-vault-list' AND json.rule = (properties.publicNetworkAccess does not equal ignore case disabled and properties.networkAcls does not exist) or (properties.publicNetworkAccess does not equal ignore case disabled and properties.networkAcls.defaultAction equal ignore case allow )
----
*Policy Type—* Config

*Impact—* Low. Open alerts where the public access is enabled and network ACLs default action is denied will be resolved.


|*Azure App Service Web app doesn't use latest TLS version*
//RLP-148541

tt:[24.9.1]

|*Changes—* The updated Policy RQL will not alert for minTlsVersion of 1.3.

*Current Description—* This policy identifies Azure web apps which are not set with latest version of TLS encryption. App service currently allows the web app to set TLS versions 1.0, 1.1 and 1.2. It is highly recommended to use the latest TLS 1.2 version for web app secure connections.

*Updated Description—* This policy identifies Azure web apps that are not configured with the latest version of TLS encryption. Azure Web Apps provide a platform to host and manage web applications securely. 

Using the latest TLS version is crucial for maintaining secure connections. Older versions of TLS, such as 1.0 and 1.1, have known vulnerabilities that can be exploited by attackers. Upgrading to newer versions like TLS 1.2 or 1.3 ensures that the web app is better protected against modern security threats.

It is highly recommended to use the latest TLS version (greater than 1.1) for secure web app connections.

*Current RQL—* 
----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = kind starts with "app" AND config.minTlsVersion does not equal "1.2"
----

*Updated RQL—* 
----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = kind starts with app and config.minTlsVersion is member of ('1.0', '1.1')
----

*Policy Type—* Config

*Policy Severity—* Low

*Impact—* Low. Alert for Azure App Service Web app with minTlsVersion equals 1.3 will be resolved.

2+|*Policy Updates—Metadata*

|*AWS SageMaker endpoint data encryption at rest not configured with CMK*
//RLP-148554

tt:[24.9.1]

|*Changes—* The policy severity level is updated.

*Current Policy Severity—* High

*Updated Policy Severity—* Informational

*Policy Type—* Config

*Impact—* Low

|===


[#new-compliance-benchmarks-and-updates]
=== New Compliance Benchmarks and Updates

[cols="50%a,50%a"]
|===
|*Compliance Benchmark*
|*Description*

|*TX-RAMP Level 1 and Level 2*

tt:[24.9.2]
//RLP-149709

|Prisma Cloud now supports the latest version of Texas Risk and Authorization Management Program (TX-RAMP ) Level 1 and Level 2. TX-RAMP is designed to enhance the security and resilience of cloud services used by Texas state agencies by establishing rigorous cybersecurity standards for cloud service providers.

You can view this built-in standard and the associated policies on the *Compliance > Standards* page. You can also generate reports for immediate viewing or download, or schedule recurring reports to track this compliance standard over time.

|*NYDFS 23 CRR-NY 500.0*

tt:[24.9.2]
//RLP-149643

|New Policy mappings are added for CIS Controls v7.1 & CIS Controls v8.0

*Impact—* No impact on existing alerts. The compliance score may vary as new mappings are added.


|*CIS Controls v7.1 & CIS Controls v8.0*

tt:[24.9.2]
//RLP-148514

|New Policy mappings are introduced to the 'NYDFS 23 CRR-NY 500.0' compliance standard across all clouds.

*Impact—* No impact on existing alerts. The compliance score may vary as new mappings are added.


|*Framework for Adoption of Cloud Services by SEBI Regulated Entities*

tt:[24.9.1]
//RLP-147789

|Prisma Cloud now supports  Consolidated Cybersecurity and Cyber Resilience Framework (CSCRF) released by the Securities and Exchange Board of India (SEBI) for all major cloud providers. CSCRF aims to establish a unified framework that encompasses various strategies to safeguard REs (Regulated Entities) and Market Infrastructure Institutions (MIIs) against cyber risks and incidents. Framework of adoption is part of the SEBI's overall CSRF standard. 

You can view this built-in standard and the associated policies on the *Compliance > Standards* page. You can also generate reports for immediate viewing or download, or schedule recurring reports to track this compliance standard over time.

*Impact*— As new mappings are introduced, compliance scoring might vary.

|===


[#rest-api-updates]
=== REST API Updates

[cols="37%a,63%a"]
|===
|*Change*
|*Description*

|*Asset Explorer APIs*

tt:[24.9.2]
//RLP-149246

|Added `dataSecurity` response objects to support DSPM API integration.

|*AWS Logging Account APIs*

tt:[24.9.2]
//RLP-149970

|New https://pan.dev/prisma-cloud/api/cspm/aws-logging-accounts/[AWS logging account APIs] are introduced to configure and manage AWS logging accounts that are necessary for AWS flow log ingestion.

|*Vulnerabilities Dashboard APIs*

tt:[24.9.2]
//RLP-150474

|The following new UVE POST endpoints have been introduced, offering enhanced filtering capabilities. These serve as alternatives to the deprecated UVE GET endpoints.

* https://pan-dev-f1b58--pr741-5260bkvi.web.app/prisma-cloud/api/cspm/vulnerability-impact-by-stage-v-2/[Get Vulnerability Impact by Stage - POST]

* https://pan.dev/prisma-cloud/api/cspm/vulnerable-assets-v-2/[Get Vulnerable Assets - POST]

* https://pan.dev/prisma-cloud/api/cspm/top-prioritised-vulnerability-v-3/[Get Top Impacting Vulnerabilities - POST]

* https://pan.dev/prisma-cloud/api/cspm/vulnerability-dashboard-overview-v-4/[Get Vulnerability Overview - POST]

* https://pan.dev/prisma-cloud/api/cspm/prioritised-vulnerability-v-5/[Get Prioritized Vulnerabilities - POST]

* https://pan.dev/prisma-cloud/api/cspm/cve-overview-v-3/[Get CVE Overview - POST]

* https://pan.dev/prisma-cloud/api/cspm/list-vulnerable-assets-cve-v-2/[Get Vulnerable Assets by CVE - POST]

A new https://pan.dev/prisma-cloud/api/cspm/c-2-c-trace-api/[C2C Trace Asset Graph endpoint] is introduced to get details about the source of the vulnerability that is displayed in the C2C tracing graph in the UI.

|===

[#deprecation-notice]
=== Deprecation Notice

[cols="37%a,63%a"]
|===
|*Change*
|*Description*

|tt:[*End of support for Azure Active Directory v1 API*]

tt:[This change was first announced in 24.6.2 Look ahead notice]

tt:[24.9.2]
//RLP-143110

|`azure-active-directory-credential-user-registration-details` API is has been deprecated. Due to this change, Prisma Cloud will no longer ingest metadata for `azure-active-directory-credential-user-registration-details API`. 

In RQL, the key will not be available in the `api.name` attribute auto-completion. As a replacement, it is recommended to use the `azure-active-directory-user-registration-details` API.

*Impact*—If you have a saved search or custom policies based on this API, you must delete those manually. The policy alerts will be resolved as *Policy_Deleted*.

|===
