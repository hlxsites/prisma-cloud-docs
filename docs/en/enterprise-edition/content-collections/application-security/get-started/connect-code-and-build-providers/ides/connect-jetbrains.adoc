:topic_type: task

[.task]

== Add Prisma Cloud Code Security Plugin to JetBrains IDE

Integrate the Prisma Cloud Code Security plugin (Prisma Cloud) for JetBrains IDEs to seamlessly enhance security while coding, allowing you to identify issues before you commit your code, reducing the risk of pull requests failing due to undetected issues. Prisma Cloud scans for security policy violations based on both default, out-of-the-box and custom policies.

For information on default Policies, refer to the https://docs.prismacloud.io/en/enterprise-edition/policy-reference/get-started-code-sec-policies/get-started-code-sec-policies[Policies] documentation.

For information on creating custom policies, refer to xref:../../../../governance/custom-build-policies/custom-build-policies.adoc[Custom Build Policies].

The plugin utilizes Prisma Cloud's capabilities to scan these security categories:

* IaC misconfigurations in IaC templates such as Kubernetes and Terraform. For a list of supported IaC frameworks see xref:../../../supported-technologies.adoc[Supported Technologies]
* SCA vulnerabilities: Includes security issues in both direct and transitive open-source dependencies
* Secrets: Security vulnerabilities in your base images
* Licenses: Software license noncompliance

You can prioritize findings and address the most critical issues by filtering the scan results based on severity.

NOTE: The Prisma Cloud Code Security plugin supports all JetBrains products.

=== Prerequisites

//[.procedure]

. Before you begin.
.. Install https://www.python.org/downloads/[Python] v3.7 or above, https://docs.pipenv.org/[Pipenv], or a running https://www.docker.com/products/docker-desktop[Docker] daemon.
+
NOTE: The Prisma Cloud plugin automatically invokes the latest version of Prisma Cloud Code Security.

.. On Prisma Cloud.
+
* Add the Prisma Cloud IP addresses and hostname for Application Security to an xref:../../../../get-started/console-prerequisites.adoc[allow list] to enable access to the Prisma Cloud console
* xref:../../../../administration/create-access-keys.adoc[Generate and copy the Prisma Cloud access key] to enable access to Prisma Cloud. The access key includes a key ID and secret
* Retrieve your Prisma Cloud API URL, which varies depending on the region and cluster on which your tenant is deployed
+
NOTE: For Prisma Cloud API URL, replace *app* in the URL with *api*.

=== Installation

You can install the plugin directly from the VS Code IDE or through the JetBrains Marketplace.  

==== Install through JetBrains IDE 

. In a JetBrains editor, such as PyCharm, select *Settings* > open the *Plugins* panel > search for *Prisma Cloud* > *Install*.
+
NOTE: Restart your IDE if prompted.

==== Install from the JetBrains Marketplace Website

. *Option #1*: Access the Marketplace directly: https://plugins.jetbrains.com/[JetBrains Marketplace]
+
*Option #2*: Access the Marketplace from the Prisma Cloud console: 
+
In *Application Security*, select *Settings* > *Connect Provider* > *Code & Build Providers* > *JetBrains* (under IDEs).

. Select a platform > search for the *Prisma Cloud* plugin > Select *Get*.
. Select *Download* from the *Versions* tab > and then *Got it* in the popup.

NOTE: Restart your IDE if prompted.

=== Configure Plugin Settings

. In your IDE, select *Settings* > *Tools* > *Prisma Cloud*.
+
image::application-security/jetbrains-settings-config-masked.png[]

. Fill in the provided fields:
+
* *Access Key* (required): The Prisma Cloud access key ID generated in step 1.2 above
* *Secret Key* (required): The Prisma Cloud secret key generated in step 1.2 above
* *Prisma URL* (required): Your Prisma URL - see prerequisites in step 1.2 above
* *CA-Certificate* (optional): Add the CA certificate. Format: `.pem` file
. Click *OK*.

=== UI Layout

*Access the Prisma Cloud plugin UI*: Select the Prisma CLoud icon from the menu at the bottom of the IDE. The UI of the Prisma Cloud extension includes the following sections:

image::application-security/jetbrains-ui1.1.png[]

* Left pane: The navigation bar features a tree structure displaying folders categorized by security categories (including IaC misconfigurations, Secrets, Vulnerabilities (SCA), and Licenses), containing errors detected during a scan

* Middle pane: The *Code editor* allows you to review the codebase. It displays a list of findings related to a resource (for IaC misconfigurations) or file, along with remediation options

* Bottom pane: The *Problems Tool* enables you to perform scans and view detailed results. After scans are completed, the left pane of the Problems Tool displays a navigation tree listing folders containing files with detected issues under the *Overview* tab. You can also filter the displayed issues by security category (such as IaC misconfigurations) and severity, with values including H (high), M (medium), L (low), and I (informative). Selecting a file in the Problems Tool opens the issues detected within it in the right pane, where you can access detailed information, code differences (when available), and remediation options

=== Usage

The Prisma Cloud Security extension allows you to conduct comprehensive scans, manage findings efficiently, and remediate issues, all within your coding environment.

// image::application-security/scan-results-masked.png[]

[#scan-code]
=== Scans 

Code scans can be performed on an entire project or selected files.

* *Full scan*: Click either *Scan* or the *Play* button in the *Problems Tool* to initiate a scan of the entire project 

* *File scan*: Open or save a specific file to trigger a scan exclusively for that file

==== Cancel a Scan

You can cancel a scan by clicking the red *Cancel* button that replaces the *Play* button when starting a scan. After cancelling a scan, results from the previous scan remain.

[#analyze-results]
=== Findings

You can manage findings through either the *Code editor* or the *Problems Tool*. 

image::application-security/scan-results-masked.png[]

////
Issues detected during a scan, including context and impact,are displayed in the Code editor and Problems Tool. Scan results include summary details of the violating policies, expanded details (in the Problems Tool) and options to fix, suppress, or a link to documentation including guidelines on remediating the issue based on the Prisma Cloud Code Security fix dictionaries.
////

//==== View and Filter Findings


* In the *Code editor*: Red markers indicate the location of issues in code lines or resources. Hover for details and remediation options. Use the arrows to scroll through all issues detected in the resource. Select *Console* to display a detailed view of the issue in the Problems Tool.
+
NOTE: A resource block declares a resource of a given type with a given local name. The name is used to refer to this resource from elsewhere in the same Terraform module, but has no significance outside of the scope of a module.

The *Problems Tool* organizes findings into categorizes for easy navigation. The *Overview* tab, which opens by default, displays all findings from all categories organized into folders. Click on a specific folder or subsequent subfolders to view all the findings within that folder. You can select a specific category tab to display findings specific to that category. You can refine a search by filtering findings by severity. Values: 'I' (informative), 'L' (Low), 'M' (Medium), 'H' (High), 'C' (Critical). Selecting a finding displays details of the issue, as well as remediation options.


////
====  Manage Findings in the Code editor


. Select a file in the Navigation bar.
+
A description of the issue and remediation options are displayed in the Code Editor.


. Select a remediation option from the available choices. 
+
See Remediation below for more details.


==== Manage Findings in the Problems Tool


. Select a finding in the Navigation bar.
+
A description of the issue and remediation options are displayed in the Problems Tool.
. Select a remediation option from the available choices.
+
See Remediation below for more details.
////


=== Remediation

You can mitigate issues directly through both the *Code editor* or the *Problems Tool*. Options include *Fix*, *Suppress*, or *Documentation*. 

NOTE: Not all types of remediation are available for all issues.

==== Fixes

When selecting an issue in either the Code editor and Problems Tool, a suggested fix is displayed when available. Fixes are applied directly to the code. The following list displays the type of fix available for the different categories of issues.

* *IaC misconfigurations*: The fix modifies the configuration
* *SCA vulnerabilities*: The fix bumps the package version. You can directly fix the specific CVE vulnerability that has been detected during the scan by upgrading the package to the version that includes a fix. You can fix all of the CVE vulnerabilities found in a package by selecting *Fix All* in the *Problems Tool*. This fix upgrades the package to a version that addresses all the issues
* *Secrets* issues: Follow the policy guidelines
* *License* mis-compliance: Follow the policy guidelines

==== Suppression

Suppress an issue to temporarily hide or ignore an issue without fixing it, allowing you to concentrate on more important issues.

NOTE: The suppression is scoped to the file.

. Before you begin, enable *Developer Suppressions* on the Prisma Cloud console.
.. In *Application Security*, select *Settings* > *Application Security* under 'Configure' in the left navbar.
.. Scroll down to *Developer Suppressions* and toggle the switch button *ON*.
. Select an issue > *Suppress* from either the Code editor or Problems Tool.
. Provide a justification for the suppression> *OK*.
+
NOTE: The justification will be added as a commented annotation to your source code.

After suppressing an issue, the file is not scanned for two minutes. This is to prevent the issue from being re-triggered. Saving the file during the hold period will not trigger a scan.

For more information on Suppression, refer to the xref:../../risk-management/monitor-and-manage-code-build/suppress-code-issues.adoc[Suppression] documentation.

==== Documentation

If automated fixes are not available, policy documentation can provide guidance on how to address the issue: 
Select an issue > *Documentation*.
You are redirected to the relevant policy documentation which includes suggested guidelines on how to solve the issue.

////
Cloud Security scans your code for issues and provides remediation suggestions directly in your JetBrains IDE, both in the editor and the *Problems Tool*. Code 

[#troubleshoot]
=== Troubleshoot

Troubleshoot errors directly in the JetBrains UI using the *Event* Log. 
