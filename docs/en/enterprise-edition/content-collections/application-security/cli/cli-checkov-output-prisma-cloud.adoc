== Checkov Output on Prisma Cloud Console


[.task]
Integrate Checkov with Prisma Cloud to view the results of Checkov scans on the Prisma Cloud console.

[.procedure]

. xref:../../../../administration/create-access-keys.adoc[Generate and copy the Prisma Cloud access key] to enable access to Prisma Cloud. The access key includes a key ID and secret.

. Run Checkov: 
+
* Option 1: `checkov -d <directory> --bc-api-key <access key>::<secret key> --prisma-api-url <prisma api url> --repo-id <repo_id> --branch <branch>`

* Option 2: Use the `-f`` file flag: `checkov -f <file_1> <file_2> ... <file_n> --bc-api-key <access key>::<secret key> --prisma-api-url <prisma api url> --repo-id <repo_id> --branch <branch>`

The table below details the arguments used when executing the API token:

[cols="1,2"]
|===
|Argument | Description

|`<access key>::<secret key>`
|Prisma Cloud API key. Format `ACCESS_KEY::SECRET_KEY`

|`<repo_id>`
|Identifying string of the scanned repository, following the standard Git repository naming scheme: `<owner>/<name>`

|`<branch>`
|Branch name to be persisted on the platform. Defaults to the master branch. Ensure the scanned directory supplied in the `-d` flag is currently checked out from the given branch name
|===

=== Environment Variables

To enrich Prisma Cloud's context with CI/CD systems data, we strongly recommend that Checkov uses environment variables.

[cols="1,1,1"]
 
|===
| Environment Variable | Description | Example

| BC_FROM_BRANCH
| Source branch
| feature/foo

| BC_TO_BRANCH
| Target branch
| main

| BC_PR_ID
| Pull request identifier
| 825

| BC_PR_URL
| Link to pull request/merge request
| https://github.com/bridgecrewio/checkov/pull/825

| BC_COMMIT_HASH
| Commit identifier
| 5df50ab857e7a255e4e731877748b539915ad489

| BC_COMMIT_URL
| Link to commit in CI/VCS system
| https://github.com/bridgecrewio/checkov/commit/5df50ab857e7a255e4e731877748b539915ad489

| BC_AUTHOR_NAME
| User associated with the CI trigger
| schosterbarak

| BC_AUTHOR_URL
| Link to the user profile page
| https://github.com/schosterbarak

| BC_RUN_ID
| CI run identifier
| 525220526

| BC_RUN_URL
| Link to the run in the CI system
| https://github.com/bridgecrewio/checkov/actions/runs/525220526

| BC_REPOSITORY_URL
| Link to the GitHub repository
| https://github.com/bridgecrewio/checkov/

| BC_SOURCE
| Name of CI system being integrated
| githubActions

| PRISMA_API_URL
| URL of Prisma app for platform integration
| https://app3.prismacloud.io

| SLS_FILE_MASK
| File names mask for all serverless files
| serverless.yaml,serverless.yml

| CHECKOV_REQUEST_CONNECT_TIMEOUT
| Number of seconds requests will wait to establish a connection to the platform
| 3.1

| CHECKOV_REQUEST_READ_TIMEOUT
| Number of seconds requests will wait for the platform to send a response. This duration matches our timeout settings, so changes are likely unnecessary.
| 30

| CHECKOV_REQUEST_RETRIES
| Number of retries requests will do towards the platform
| 3
|===

=== View Scan Results on the Prisma Cloud Console

An overview of Checkov scan results can be viewed in the Application Security dashboard: In *Application Security*, select the *Dashboards* tab > *Code Security* tab.

image::application-security/cli-checkov-scan-results1.1.png[]

To view scan results and resolve issues on the Prisma Cloud console, in *Application Security* select *Home* > *Projects*. Refer to xref:../risk-management/monitor-and-manage-code-build/monitor-and-manage-code-build.adoc[Monitor and Manage Code Build Issues] for more information. 

