== Jobs are allowed to run on the Jenkins Controller

=== Rule Details

[cols="1,3"]
|===
|Cortex AppSec Rule ID |APPSEC_CICD_52
|Category |PIPELINE_BASED_ACCESS_CONTROLS
|Provider |
|Severity |HIGH
|Mapped CSPM/KSPM Rule |None
|===


=== Description 

The Jenkins instance allows jobs to run on the Jenkins Controller.
The Jenkins Controller is the original node in the Jenkins installation, responsible for administration operations on the Jenkins instance such as job orchestration, node management, and authentication.

Jenkins jobs can be run on the Jenkins Controller or on dedicated agents. Jobs are processes which can access the file system of the underlying execution environment, with the permissions of the operating system user account running the Jenkins process.

Jobs that run on the Jenkins Controller can access the Controller’s file system. Attackers executing a malicious build that runs on the Controller can perform impactful malicious actions on the Jenkins instance, such as getting stored credentials, managing authorization configurations and executing jobs.

For information regarding isolating the Jenkins Controller refer to the Jenkins documentation: https://www.jenkins.io/doc/book/security/controller-isolation/.

=== Recommended Solution - Buildtime

Prevent Jenkins jobs from running on the Controller:
 
. On the Jenkins instance, under **Manage Jenkins**, browse to **Configure System**.
. Set **# of executors** to **0**.

NOTE: Ensure that agents that fit the builds’ needs are configured on the instance.




