== OCI Network Security Groups (NSG) has stateful security rules misconfiguration detected in code

=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_OCI_21
|Category |Networking - Ingress Controls
|Provider |Oracle
|Severity |MEDIUM
|Framework |Terraform
|Mapped CSPM/KSPM Rule |None
|===


=== Impact
This rule identifies the OCI Network Security Groups (NSG) security rules that have stateful ingress rules configured. It is recommended that Network Security Groups (NSG) security rules are configured with stateless ingress rules to slow the impact of a denial-of-service (DoS) attack.

=== How to Fix

*Terraform*

To fix this issue, you should avoid setting the "stateless" attribute for ingress security rules to false.

[source,go]
----
resource "oci_core_network_security_group_security_rule" "example" {
  ...
  direction                 = "INGRESS"
-  stateless                 = false
+  stateless                 = true
}
----

The above code is secure because it sets the ingress security rule to stateless which is more secure.
