== Azure ACR enables anonymous image pulling


=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_138
|Category |IAM - Overly Permissive
|Provider |Azure
|Severity |LOW
|Framework |Terraform, Terraform Plan, ARM, Bicep
|Mapped CSPM/KSPM Rule |None
|===


=== Impact
Disabling anonymous image pulling for your Azure Container Registry (ACR) can help improve the security of your registry.
When anonymous image pulling is enabled, anyone can pull images from your registry without needing to authenticate or have authorization.

=== How to Fix


*Terraform* 


* *Resource:* azurerm_container_registry
* *Arguments:* anonymous_pull_enabled


[source,go]
----
resource "azurerm_container_registry" "ckv_unittest_pass_1" {
  name                   = "containerRegistry1"
  resource_group_name    = azurerm_resource_group.rg.name
  location               = azurerm_resource_group.rg.location
  sku                    = "Premium"
  anonymous_pull_enabled = false
}
----

