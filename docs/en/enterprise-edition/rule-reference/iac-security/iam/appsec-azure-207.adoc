== Azure Cognitive Search Without Managed Identities
// Ensure Azure Cognitive Search service uses managed identities to access Azure resources.

=== Rule Details

[width=45%]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_207
|Category |IAM-AUTHENTICATION_POLICIES
|Provider |AZURE
|Severity |MEDIUM
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===


=== Fix - Buildtime

*Terraform*

*Resource:* 
- azurerm_search_service

*Arguments:* 
- identity

[source,terraform]
----
resource "azurerm_search_service" "example" {
  name                = "example-search-service"
  # ... other configurations ...

+ identity {
+   type = "SystemAssigned"
+ }

  # ... other configurations ...
}
----
