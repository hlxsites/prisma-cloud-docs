== GCP IAM Service account does have admin privileges misconfiguration detected in code


=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_GCP_42
|Category |IAM - Overly Permissive
|Provider |GCP
|Severity |HIGH
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===


=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_GCP_42
|Category |IAM - Overly Permissive
|Provider |GCP
|Severity |HIGH
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===


=== Impact
A service account is a special Google account that belongs to an application or a VM, not to an individual end-user.
The application uses the service account to call the service's Google API so that users are not directly involved.
Service accounts represent service-level security of application or VM Resources, determined by the roles assigned to them.
Enrolling *ServiceAccount* with Admin rights gives full access to an assigned application or a VM.
A ServiceAccount Access holder can perform critical actions, such as delete and update change settings, without user intervention.
We recommend you do not grant Admin privileges for *ServiceAccount*.

=== How to Fix


*Terraform* 


* *Resource:* google_project_iam_member
* *Arguments:* role + member


[source,go]
----
resource "google_project_iam_member" "project" {
  project = "your-project-id"
-  role    = "roles/owner"
-  member  = "user:test@example-project.iam.gserviceaccount.com"
}
----

