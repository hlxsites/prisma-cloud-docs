== AWS Customer Master Key (CMK) rotation is not enabled misconfiguration detected in code


=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AWS_7
|Category - Subcategory |IAM - Expired Key Controls
|Provider |AWS
|Severity |LOW
|Framework |CloudFormation, Terraform, Terraform Plan, Serverless
|Mapped CSPM/KSPM Rule |497f7e2c-b702-47c7-9a07-f0f6404ac896
|===
 


=== How to Fix


*Terraform* 


* *Resource:* aws_kms_key
* *Arguments:* enable_key_rotation - (Optional) Specifies whether key rotation is enabled.
Defaults to false.


[source,go]
----
resource "aws_kms_key" "kms_key_1" {
  ...
  is_enabled              = true
+ enable_key_rotation    = true
}
----


*CloudFormation* 


* *Resource:* `AWS::KMS::Key`
* *Attribute*: `EnableKeyRotation` - (Optional) Specifies whether key rotation is enabled.
Defaults to false.


[source,yaml]
----
Type: AWS::KMS::Key
Properties: 
  ...
+ EnableKeyRotation: true0
----
