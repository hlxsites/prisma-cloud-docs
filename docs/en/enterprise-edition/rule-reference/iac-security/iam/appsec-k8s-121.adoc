== The --peer-client-cert-auth argument is not set to True
// '--peer-client-cert-auth' argument not set to True

=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_K8S_121
|Category |IAM - Authentication policies
|Provider |
|Severity |HIGH
|Framework |Kubernetes, Helm, Kustomize
|Mapped CSPM/KSPM Rule |None
|===


=== Description 


etcd should be configured for peer authentication.
etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects.
These objects are sensitive in nature and should be accessible only by authenticated etcd peers in the etcd cluster.

=== Fix - Buildtime


*Kubernetes* 


* *Kind:* Pod


[source,go]
----
{
 "apiVersion: v1
kind: Pod
metadata:
  name: etcd
  namespace: should-pass
spec:
  hostNetwork: true
  containers:
      - name: "kuku2"
        image: "b.gcr.io/kuar/etcd:2.2.0"
        args:
          ...
+         - "--peer-client-cert-auth=true"
        ...",
}
----

