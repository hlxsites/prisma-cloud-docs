== AKS does not use Azure policies add-on misconfiguration detected in code
// Azure Policy Add-on for Azure Kubernetes Service (AKS) not enabled


=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_116
|Category |IAM - Authentication Policies
|Provider |Azure
|Severity |LOW
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===


=== Impact
Azure Policy Add-on for AKS extends Gatekeeper v3, an admission controller webhook for Open Policy Agent (OPA), to apply at-scale enforcements and safeguards on your clusters in a centralized, consistent manner.

=== How to Fix


*Terraform* 


* *Resource:* azurerm_kubernetes_cluster
* *Arguments:* addon_profile.azure_policy.enabled


[source,go]
----
resource "azurerm_kubernetes_cluster" "example" {
                  ...
+                  addon_profile {
+                    azure_policy {
+                      enabled = true
                    }
                  }         
                }
----
