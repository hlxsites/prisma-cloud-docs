== Secrets are exposed in Azure VM customData misconfiguration detected in code
// Secrets exposed in Azure VM customData


=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_45
|Category - Subcategory |Compute - Credentials and Auth
|Provider |Azure
|Severity |HIGH
|Framework |Terraform, Terraform Plan, ARM, Bicep
|Mapped CSPM/KSPM Rule |None
|===
 

=== How to Fix


*Terraform* 


Remove the following attribute from the Terraform resource.


[source,go]
----
resource "azurerm_virtual_machine" "main" {
  name                  = "${var.prefix}-vm"
  ...
  os_profile {
    ...
-   custom_data = "MY_SECRET_VALUE"
  }
  ...
}
----
