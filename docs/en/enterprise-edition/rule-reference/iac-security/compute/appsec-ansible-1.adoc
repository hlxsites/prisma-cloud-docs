== Disabled Ansible URI certificate validation misconfiguration detected in code

=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_ANSIBLE_1
|Category |Compute - Unsanctioned Resource or Type
|Provider |
|Severity |MEDIUM
|Framework |Ansible
|Mapped CSPM/KSPM Rule |None
|===
 

=== Impact
This policy detects whether Ansible URI tasks enforce certificate validation, thereby enhancing the security of your HTTPS requests. Disabling certificate validation in URI tasks can expose the system to various security issues, including man-in-the-middle (MITM) attacks.


=== How to Fix

*Ansible*

* *Attribute:* uri.validate_certs

To mitigate this risk, ensure that the `validate_certs`` attribute is set to `true`` in your Ansible URI tasks. This setting ensures that SSL certificates are properly validated during HTTPS requests, enhancing the security of your system.

Secure Code Example:



[source,yaml]
----
- name: Example
  hosts: all
  gather_facts: False
  tasks:
    - name: disabled
      uri:
        url: https://www.example.com
        return_content: yes
-        validate_certs: false
+        validate_certs: true
      register: this
      failed_when: "'AWESOME' not in this.content"
----

The above example ensures that the SSL certificate of the specified URL is validated by setting validate_certs to true in Ansible URI tasks.
