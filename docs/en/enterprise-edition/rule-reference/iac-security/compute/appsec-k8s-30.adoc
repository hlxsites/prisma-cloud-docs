== securityContext is not applied to pods and containers in container context
// securityContext not applied to pods and containers in container context

=== Rule Details

[cols="1,3"]
|===
|Cortex AppSec Rule ID |APPSEC_K8S_30
|Category |Compute-Unsanctioned resource or type
|Provider |
|Severity |LOW
|Framework |Kubernetes, Terraform, Helm, Kustomize, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===


=== Description 


*securityContext* defines privilege and access control settings for your pod or container, and holds security configurations that will be applied to a container.
Some fields are present in both *securityContext* and *PodSecurityContext*. When both are set, *securityContext* takes precedence.
Well-defined privilege and access control settings will enhance assurance that your pod is running with the properties it requires to function.

=== Fix - Buildtime


*Kubernetes* 


* *Resource:*  Container / Pod / Deployment / DaemonSet / StatefulSet / ReplicaSet / ReplicationController / Job / CronJob
* *Arguments:* securityContext (Optional)  A field that defines privilege and access control settings for your Pod or Container.


[source,container]
----
apiVersion: v1
kind: Pod
metadata:
  name: <Pod name>
spec:
  containers:
  - name: <container name>
    image: <image>
+   securityContext:
----

[source,pod]
----
apiVersion: v1
kind: Pod
metadata:
  name: <name>
spec:
+  securityContext:
----

[source,cronjob]
----
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: <name>
spec:
  schedule: <>
  jobTemplate:
    spec:
      template:
        spec:
+          securityContext:
----

[source,text]
----
apiVersion: <>
kind: <kind>
metadata:
  name: <name>
spec:
  template:
    spec:
+       securityContext:
----