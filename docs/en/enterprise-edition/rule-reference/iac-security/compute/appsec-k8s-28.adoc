== Admission of containers with NET_RAW capability is not minimized
// Admission of containers with NET_RAW capability not minimized

=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_K8S_28
|Category |Compute - Unsanctioned resource or type
|Provider |
|Severity |LOW
|Framework |Kubernetes, Terraform, Helm, Kustomize, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===


=== Description 


NET_RAW capability allows the binary to use RAW and PACKET sockets as well as binding to any address for transparent proxying.
The _ep_ stands for "`effective`" (active) and "`permitted`" (allowed to be used).
With Docker as the container runtime NET_RAW capability is enabled by default and may be misused by malicious containers.
We recommend you define at least one PodSecurityPolicy (PSP) to prevent containers with NET_RAW capability from launching.

=== Fix - Buildtime


*Kubernetes* 


* *Resource:* Container
* *Arguments:* securityContext:capabilities:drop (Optional)  Capabilites field allows granting certain privileges to a process without granting all the privileges of the root user.
when *drop* includes *ALL* or *NET_RAW*, the *NET_RAW* capability is disabled.


[source,yaml]
----
apiVersion: v1
kind: Pod
metadata:
  name: <Pod name>
spec:
  containers:
  - name: <container name>
    image: <image>
    securityContext:
      capabilities:
        drop:
+        - NET_RAW
+        - ALL
----