== Virtual Machine extensions are installed misconfiguration detected in code


=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_50
|Category |Compute - Unsanctioned Resource or Type
|Provider |Azure
|Severity |MEDIUM
|Framework |ARM, Bicep, Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===


=== Impact
Ensure that your Microsoft Azure virtual machines (VMs) do not have extensions installed in order to follow your organization's security and compliance requirements.
Azure virtual machine extensions are small cloud applications that provide post-deployment configuration and automation tasks for virtual machines.
These extensions run with administrative privileges and could potentially access any configuration file or piece of data on a virtual machine.

=== How to Fix


*Terraform* 


* *Resource:* azurerm_virtual_machine, azurerm_linux_virtual_machine
* *Arguments:* allow_extension_operations


[source,go]
----
resource "azurerm_linux_virtual_machine" "example" {
    ...
 ~  allow_extension_operations=false
  }
----
