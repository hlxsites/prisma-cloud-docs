== AWS MQBroker version is not up to date misconfiguration detected in code


=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AWS_208
|Category |Compute - Unsanctioned Resource or Type
|Provider |AWS
|Severity |LOW
|Framework |Terraform
|Mapped CSPM/KSPM Rule |None
|===
 



=== Impact
This test examines the value of engine version for MQ, and flags if the version is less than the minimum required:


[source,text]
----
minimumActiveMQ = 5.16
minimumRabbitMQ = 3.8
----

Current versions supported can be found here:

https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/activemq-version-management.html
https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/rabbitmq-version-management.html


=== How to Fix


*Terraform* 


Modify the engine version in either aws_mq_configuration or aws_mq_broker, to be higher or equal to the minimums:


[source,go]
----
resource "aws_mq_configuration" "example" {
  description    = "Example Configuration"
  name           = "example"
  engine_type    = "ActiveMQ"
 + engine_version = "5.17.1"

  data = <<DATA
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<broker xmlns="http://activemq.apache.org/schema/core">
  <plugins>
    <forcePersistencyModeBrokerPlugin persistenceFlag="true"/>
    <statisticsBrokerPlugin/>
    <timeStampingBrokerPlugin ttlCeiling="86400000" zeroExpirationOverride="86400000"/>
  </plugins>
</broker>
DATA
}
----
