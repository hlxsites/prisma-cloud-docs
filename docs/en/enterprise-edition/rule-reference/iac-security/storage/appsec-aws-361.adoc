
== AWS Neptune DB clusters have backup retention period less than 7 days misconfiguration detected in code

=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AWS_361
|Category - Subcategory |Storage - Backups
|Provider |AWS
|Severity |LOW
|Framework |Terraform, Terraform Plan, CloudFormation
|Mapped CSPM/KSPM Rule |dccd9e6f-c6c0-41d7-a0af-18b6ff1bf227
|===


=== Impact
This rule checks whether a Neptune DB cluster in AWS (Amazon Web Services) has automated backups enabled and if these backups have an appropriate retention period. A backup is a copy of data that can be used to restore and recover data in the event of a failure or loss. The retention period refers to the length of time that backups are retained or kept. 

The reason why this policy is important is that if automated backups are not enabled or do not have an adequate retention period, there could be a significant risk to the organization. Backups provide a safeguard against data loss, corruption or accidental deletion. Insufficient retention could lead to a situation where essential data cannot be restored because the backup has been discarded. Therefore, neglecting the importance of proper backup strategies could lead to detrimental effects on the business, from downtime to legal or compliance issues.

=== How to Fix

*Terraform*

To fix this issue, ensure that the `backup_retention_period` property in the `aws_neptune_cluster` resource is set to at least 7 days.

[source,go]
----
resource "aws_neptune_cluster" "default" {
  ...
  backup_retention_period = 7
}
----

*CloudFormation*

To fix this issue, ensure that the `BackupRetentionPeriod` property in the `AWS::Neptune::DBCluster` resource is set to at least 7 days.

Example:

[source,yaml]
----
Resources:
  MyNeptuneDBCluster:
    Type: AWS::Neptune::DBCluster
    Properties:
      BackupRetentionPeriod: 7
      ...
----

