== Athena Workgroup is not encrypted


=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AWS_159
|Category |STORAGE-ENCRYPTION
|Provider |AWS
|Severity |MEDIUM
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===


=== Description 


Athena workgroups support full server-side encryption for all data at rest which should be enabled.

=== Fix - Buildtime


*Terraform* 


* *Resource:* aws_athena_workgroup
* *Arguments:*  result_configuration.encryption_configuration


[source,go]
----
resource "aws_athena_workgroup" "test" {
    ...
+ configuration {
        ...
+   result_configuration {
+     output_location = "s3://mys3bucket"
+     encryption_configuration {
+       encryption_option = "SSE_KMS"
+       kms_key_arn       = "mykmsarn"
      }
    }
  }
}
----
