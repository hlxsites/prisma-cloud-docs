== App Configuration Encryption Block Not Set misconfiguration detected in code
// Ensure App configuration encryption block is set.

=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_186
|Category - Subcategory |Storage - Encryption
|Provider |Azure
|Severity |MEDIUM
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===


=== Impact
Encryption is a key aspect of ensuring data confidentiality and integrity. Azure App Configuration supports encryption of the configuration data at rest, which helps safeguard sensitive application data against unauthorized access.

This rule ensures that an encryption block is defined with a Key Vault key identifier in Azure App Configuration resources. This promotes the practice of encrypting sensitive application configuration data.

=== How to Fix

*Terraform*

*Resource:* 
- azurerm_app_configuration

*Arguments:* 
- encryption.key_vault_key_identifier

[source,terraform]
----
resource "azurerm_app_configuration" "example" {
  name                = "example-app-configuration"
  location            = azurerm_resource_group.example.location
  resource_group_name = azurerm_resource_group.example.name
  
  # ... other configurations ...

+ encryption {
+   key_vault_key_identifier = "key-vault-key-id"  // Ensure encryption block with key vault key identifier is set
+ }
}
----

