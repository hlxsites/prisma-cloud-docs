== Azure PostgreSQL does not use the latest version of TLS encryption


=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_147
|Category |Storage - Encryption
|Provider |Azure
|Severity |LOW
|Framework |Terraform
|Mapped CSPM/KSPM Rule |None
|===


=== Impact
The Transport Layer Security (TLS) protocol secures transmission of data between servers and web browsers, over the Internet, using standard encryption technology.
To follow security best practices and the latest PCI compliance standards, enable the latest version of TLS protocol (i.e.
TLS 1.2) for all your PostgreSQL servers.

=== How to Fix


*Terraform* 


* *Resource:* azurerm_postgresql_server
* *Arguments:* ssl_minimal_tls_version_enforced


[source,go]
----
resource "azurerm_postgresql_server" "pass" {
  name = "fail"

  public_network_access_enabled    = true
  ssl_enforcement_enabled          = true
  ssl_minimal_tls_version_enforced = "TLS1_2"
}
----
