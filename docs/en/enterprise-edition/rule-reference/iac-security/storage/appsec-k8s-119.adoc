== The --peer-cert-file and --peer-key-file arguments are not set appropriately
// '--peer-cert-file' and '--peer-key-file' arguments not set appropriately

=== Rule Details

[width=45%]
|===
|Cortex AppSec Rule ID |APPSEC_K8S_119
|Category |Storage-Encryption
|Provider |
|Severity |HIGH
|Framework |Kubernetes, Helm, Kustomize
|Mapped CSPM/KSPM Rule |None
|===


=== Description 


etcd should be configured to make use of TLS encryption for peer connections.
etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects.
These objects are sensitive in nature and should be encrypted in transit and also amongst peers in the etcd clusters.

=== Fix - Buildtime


*Kubernetes* 


* *Kind:* Pod


[source,yaml]
----
{
 "apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - etcd
+   - --peer-cert-file=file.pem
+   - --peer-key-file=file.key
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0",
}
----

