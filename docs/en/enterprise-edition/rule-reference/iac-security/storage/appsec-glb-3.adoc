== Gitlab project defined in Terraform does not prevent secrets
// Gitlab project does not prevent pushing secrets in merge requests


=== Rule Details

[cols="1,3"]
|===
|Cortex AppSec Rule ID |APPSEC_GLB_3
|Category |STORAGE-PERMISSIONS
|Provider |
|Severity |MEDIUM
|Framework |Terraform
|Mapped CSPM/KSPM Rule |None
|===


=== Description 


In GitLab, administrators can turn on the capability to identify and block secrets in merge requests (MR).

=== Fix - Buildtime


*Terraform* 


* Resource: gitlab_project
* Attribute: prevent_secrets


[source,go]
----
resource "gitlab_project" "example-two" {
...
  push_rules {
    ...
+    prevent_secrets        = true
  }
}
----

