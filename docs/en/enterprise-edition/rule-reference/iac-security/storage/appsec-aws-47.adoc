
== AWS DAX cluster not configured with encryption at rest misconfiguration detected in code


=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AWS_47
|Category |Storage - Encryption
|Provider |AWS
|Severity |LOW
|Framework |CloudFormation, Terraform, Terraform Plan, Serverless
|Mapped CSPM/KSPM Rule |2e489c95-268e-4cf1-aa98-5ba89635271a
|===
 



=== Impact
AWS DAX encryption at rest provides an additional layer of data protection, helping secure your data from unauthorized access to underlying storage. Without encryption, anyone with access to the storage media or the network traffic between the DAX cluster and the client could potentially intercept and view the data. We recommend enabling encryption at rest.

NOTE: With encryption at rest, the data persisted by DAX on disk is encrypted using 256-bit Advanced Encryption Standard (AES-256).


=== How to Fix


*Terraform* 


* *Resource:* aws_dax_cluster
* *Arguments:* server_side_encryption - (Optional) Encrypt at rest options, enabled/disabled.


[source,go]
----
resource "aws_dax_cluster" "example" {
  ...
  cluster_name       = "cluster-example"
+ server_side_encryption = enabled
  ...
}
----


*CloudFormation* 


* *Resource:* AWS::DAX::Cluster
* *Arguments:* Properties.SSESpecification.SSEEnabled - (Optional) Encrypt at rest options, enabled/disabled.


[source,yaml]
----
Resources:
  daxCluster:
    Type: AWS::DAX::Cluster
    Properties:
      ...
+     SSESpecification:
+       SSEEnabled: true
----
