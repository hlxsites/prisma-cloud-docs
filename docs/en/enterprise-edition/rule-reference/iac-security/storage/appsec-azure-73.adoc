== Azure Automation account variables are not encrypted


=== Rule Details

[width=45%]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_73
|Category |STORAGE-ENCRYPTION
|Provider |AZURE
|Severity |LOW
|Framework |Terraform, Terraform Plan, ARM, Bicep
|Mapped CSPM/KSPM Rule |9f439679-edfa-482f-8627-bf1d00ebbe7e
|===


=== Description 


If you have Automation Account Variables storing sensitive data that are not already encrypted, then you will need to delete them and recreate them as encrypted variables.
////
=== Fix - Runtime


* In Azure CLI* 




[source,text]
----
{
 "Set-AzAutomationVariable -AutomationAccountName '{AutomationAccountName}' -Encrypted $true -Name '{VariableName}' -ResourceGroupName '{ResourceGroupName}' -Value '{Value}'",
}
----
////
=== Fix - Buildtime


*Terraform* 


* *Resource:* azurerm_automation_variable_int
* *Arguments:* encrypted


[source,go]
----
resource "azurerm_automation_variable_int" "example" {
  ...
+ encrypted               = true
}
----
