== Not all data stored in Aurora is securely encrypted at rest


=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AWS_96
|Category |Storage - Encryption
|Provider |AWS
|Severity |HIGH
|Framework |CloudFormation, Terraform, Terraform Plan, Serverless
|Mapped CSPM/KSPM Rule |None
|===


=== Impact
This policy examines the resource *aws_rds_cluster* to check that encryption is set up.
The property  *storage_encrypted* is examined.

=== How to Fix


*Terraform* 


* *Resource:* aws_rds_cluster
* *Arguments:* storage_encrypted


[source,go]
----
resource "aws_rds_cluster" "example" {
  ...
  cluster_identifier      = "aurora-cluster-demo"
+ storage_encrypted       = true
  ...
}
----


*CloudFormation* 


* *Resource:* AWS::RDS::DBCluster
* *Arguments:* Properties.StorageEncrypted


[source,yaml]
----
Resources:
  Aurora:
    Type: 'AWS::RDS::DBCluster'
    Properties:
      ...
      Engine: 'aurora'
+     StorageEncrypted: true
            ...
----
