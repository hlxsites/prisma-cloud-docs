== AWS fx ontap file system not encrypted using Customer Managed Key


=== Rule Details

[cols="1,3"]
|===
|Cortex AppSec Rule ID |APPSEC_AWS_178
|Category |STORAGE-ENCRYPTION
|Provider |AWS
|Severity |LOW
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===


=== Description

This is a simple check to ensure that  fx ontap file system is using AWS key management - KMS to encrypt its contents.
To resolve add the ARN of your KMS or link on creation of the cluster

=== Fix - Buildtime


*Terraform* 


* *Resource:* aws_fsx_ontap_file_system 
* *Attribute: *kms_key_id - (Optional)

ARN for the KMS Key to encrypt the file system at rest, Defaults to an AWS managed KMS Key.


[source,go]
----
resource "aws_fsx_ontap_file_system" "test" {
  storage_capacity    = 1024
  subnet_ids          = [aws_subnet.test1.id, aws_subnet.test2.id]
  deployment_type     = "MULTI_AZ_1"
  throughput_capacity = 512
  preferred_subnet_id = aws_subnet.test1.id
  + kms_key_id        = "ckv_kms"
}
----
