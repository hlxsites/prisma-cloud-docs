
== Azure Cognitive Services account is not configured with managed identity

=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_238
|Category |AI & Machine Learning - Permissions
|Provider |Azure
|Severity |LOW
|Framework |Terraform, Terraform Plan, ARM, Bicep
|Mapped CSPM/KSPM Rule |31a53a05-29dd-4681-9d5e-94009e8ce9c6
|===


=== Impact
Configuring Azure Cognitive Services accounts with a managed identity enhances security by eliminating the need to store credentials in code or configuration files. It also provides seamless integration with other Azure services and simplifies the management of credentials.

=== Fix - Buildtime

*Terraform*

* *Resource:* azurerm_cognitive_account
* *Arguments:* identity.type

To fix this issue, ensure that your Azure Cognitive Services account is configured with a managed identity in your Terraform configuration.

[source,go]
----
resource "azurerm_cognitive_account" "example" {
  ...
  identity {
+    type = "SystemAssigned"
  }
}
----

*ARM*

* *Resource:* Microsoft.CognitiveServices/accounts
* *Arguments:* identity.type

To fix this issue, ensure that your Azure Cognitive Services account is configured with a managed identity in your ARM configuration.

[source,json]
----
{
    "resources": [
        {
            "type": "Microsoft.CognitiveServices/accounts",
            ...
            "identity": {
+                "type": "SystemAssigned"
            },
        }
    ]
}
----