== Redshift is deployed outside of a VPC


=== Rule Details

[cols="1,3"]
|===
|Cortex AppSec Rule ID |APPSEC_AWS_154
|Category |PUBLIC_EXPOSURE-VPC_VCN_VNET
|Provider |AWS
|Severity |LOW
|Framework |CloudFormation, Terraform, Terraform Plan, Serverless
|Mapped CSPM/KSPM Rule |None
|===


=== Description 


A VPC is a virtual network in the AWS cloud that is isolated from other virtual networks.
When you deploy Redshift in a VPC, you can control the inbound and outbound network traffic to and from your Redshift cluster using security groups and network access control lists (NACLs).
This can help to improve the security of your Redshift cluster and protect it from unauthorized access or attacks.

=== Fix - Buildtime


*Terraform* 


* *Resource:* aws_redshift_cluster
* *Arguments:* cluster_subnet_group_name


[source,go]
----
resource "aws_redshift_cluster" "pass" {
    ...
+ cluster_subnet_group_name="subnet-ebd9cead"
}
----


*CloudFormation* 


* *Resource:* AWS::Redshift::Cluster
* *Arguments:* Properties.ClusterSubnetGroupName


[source,yaml]
----
Type: "AWS::Redshift::Cluster"
  Properties:
    ...
+   ClusterSubnetGroupName: "subnet-ebd9cead"
----
