== Azure Function app configured with public network access
// Ensure that Azure Function App public network access is disabled.

=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_221
|Category |Public Exposure - APIs
|Provider |Azure
|Severity |MEDIUM
|Framework |Terraform
|Mapped CSPM/KSPM Rule |6106ed75-4236-4183-961f-1a15bc403af7
|===


=== Impact
Azure Functions is a serverless compute service that enables you to run event-driven code without having to explicitly provision or manage infrastructure. It's essential to restrict public access to such applications to mitigate potential risks. This rule ensures that the public network access to Azure Function Apps is disabled. 

=== Fix - Buildtime

*Terraform*

*Resources:* 
- azurerm_linux_function_app 
- azurerm_linux_function_app_slot 
- azurerm_windows_function_app 
- azurerm_windows_function_app_slot 

*Arguments:* 
- public_network_access_enabled

[source,terraform]
----
resource "azurerm_linux_function_app" "example" {
  name                = "example-app"
  resource_group_name = azurerm_resource_group.example.name
  location            = azurerm_resource_group.example.location

  # ... other configurations ...

+ public_network_access_enabled = false
}

resource "azurerm_windows_function_app" "example" {
  name                = "example-app"
  resource_group_name = azurerm_resource_group.example.name
  location            = azurerm_resource_group.example.location

  # ... other configurations ...

+ public_network_access_enabled = false
}
# ... Similar configurations for other supported resources ...
----
