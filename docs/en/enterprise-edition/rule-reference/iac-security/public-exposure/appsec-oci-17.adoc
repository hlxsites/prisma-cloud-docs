== OCI VCN Security list has stateful security rules misconfiguration detected in code


=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_OCI_17
|Category - Subcategory |Public Exposure - Ingress Controls
|Provider |Oracle
|Severity |MEDIUM
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===




=== Impact
This rule identifies the OCI Virtual Cloud Networks (VCN) security lists that have stateful ingress rules configured in their security lists.
It is recommended that Virtual Cloud Networks (VCN) security lists are configured with stateless ingress rules to slow the impact of a denial-of-service (DoS) attack.


=== How to Fix


*Terraform* 


* *Resource:* oci_core_security_list
* *Arguments:* vcn_id + ingress_security_rule


[source,go]
----
resource "oci_core_security_list" "pass" {
    compartment_id = oci_identity_compartment.tf-compartment.id
    vcn_id = oci_core_vcn.test_vcn.id
    ingress_security_rules {
        protocol = "all"
        source="192.168.1.0/24"
-        stateless = false
    }
}
----

