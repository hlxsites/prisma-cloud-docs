== Deletion protection disabled for load balancer


=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AWS_113
|Category |Public Exposure - Load Balancing
|Provider |AWS
|Severity |MEDIUM
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===


=== Description 


This policy identifies Elastic Load Balancers v2 (ELBv2) which are configured with deletion protection feature disabled.
Enabling delete protection for these ELBs prevents irreversible data loss resulting from accidental or malicious operations.
For more details refer: https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html#deletion-protection

////
=== Fix - Runtime


AWS Console



. Log in to the AWS console

. In the console, select the specific region from the region drop-down on the top right corner, for which the alert is generated

. Go to the EC2 Dashboard, and select 'Load Balancers'

. Click on the reported Load Balancer

. On the Description tab, choose 'Edit attributes'

. On the Edit load balancer attributes page, select 'Enable' for 'Delete Protection'

. Click on 'Save' to save your changes
////

=== Fix - Buildtime


*Terraform* 


* *Resource:* aws_lb
* *Arguments:* enable_deletion_protection


[source,go]
----
resource "aws_lb" "test_success" {
  ...
+ enable_deletion_protection = true
}
----
