== VNET Using External DNS Addresses
// Ensure that VNET uses local DNS addresses

=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_183
|Category |PUBLIC_EXPOSURE - VPC_VCN_VNET
|Provider |AZURE
|Severity |MEDIUM
|Framework |Terraform, Terraform Plan, ARM, Bicep
|Mapped CSPM/KSPM Rule |None
|===


=== Fix - Buildtime

*Terraform*

*Resource:* 
- azurerm_virtual_network

*Arguments:* 
- dns_servers
- address_space

[source,terraform]
----
resource "azurerm_virtual_network" "example" {
  name                = "example-network"
  location            = azurerm_resource_group.example.location
  resource_group_name = azurerm_resource_group.example.name

  address_space       = ["10.0.0.0/16"]
  
  # ... other configurations ...

+ dns_servers = ["10.0.0.5"]  // Ensure DNS servers are within the VNET's address space
}
----
