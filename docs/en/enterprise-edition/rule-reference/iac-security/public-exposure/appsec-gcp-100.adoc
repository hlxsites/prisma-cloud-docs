== GCP BigQuery Tables are anonymously or publicly accessible

GCP BigQuery tables are the resources in BigQuery that contain your data records, and each BigQuery table belongs to a dataset.
Every BigQuery table inherits the IAM policies attached to it's dataset, but each table can also have it's own IAM policies directly applied.
These table-level IAM policies can be set for public access via the *allUsers* and *allAuthenticatedUsers* IAM principals which can inadvertently expose your data to the public.
We recommend you ensure anonymous and public access to BigQuery tables is not allowed.

=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_GCP_100
|Category |Public Exposure - Storage Buckets
|Provider |GCP
|Severity |HIGH
|Framework |Terraform
|Mapped CSPM/KSPM Rule |None
|===



////

=== Fix - Buildtime


*Terraform* 


* *Resource:* google_bigquery_table_iam_member
* *Field:* member
* *Resource:* google_bigquery_table_iam_binding
* *Field:* members


[source,go]
----
//Option 1
resource "google_bigquery_table_iam_member" "member" {
  dataset_id = google_bigquery_table.default.dataset_id
  table_id = google_bigquery_table.default.table_id
  role = "roles/bigquery.dataOwner"
-  member        = "allUsers"
-  member        = "allAuthenticatedUsers"
}

//Option 2
resource "google_bigquery_table_iam_binding" "binding" {
  dataset_id = google_bigquery_table.default.dataset_id
  table_id = google_bigquery_table.default.table_id
  role = "roles/bigquery.dataOwner"
  members = [
-    "allUsers",
-    "allAuthenticatedUsers"
  ]
}
----
