
== TPU v2 VM is public

=== Rule Details

[cols="1,3"]
|===
|Cortex AppSec Rule ID |APPSEC2_GCP_32
|Category |PUBLIC_EXPOSURE-APIS
|Provider |GCP
|Severity |MEDIUM
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===


=== Description

This policy is checking to ensure that Tensor Processing Units (TPU) virtual machines are set to private in a Google Cloud Platform (GCP) environment. TPUs are Google's custom-developed application-specific integrated circuits (ASICs) used to accelerate machine learning workloads. 

Keeping TPU VMs set to private is necessary as it makes sure the TPU resources are not exposed to the public internet, thereby reducing the risk of unauthorized access. If a TPU is not private, it can be exposed to potential cyber threats including data breaches, hacking, and data corruption. Hence, the non-compliance with this policy can lead to potential security vulnerabilities.

=== Fix - Buildtime

*Terraform*

* *Resource:* google_tpu_v2_vm
* *Arguments:* network_config.enable_external_ips

To fix this issue, set the "enable_external_ips" attribute to "false" in your resource configuration.

[source,go]
----
resource "google_tpu_v2_vm" "tpu_good" {
  ...
  network_config {
    ...
    enable_external_ips = false
  }
}
----

