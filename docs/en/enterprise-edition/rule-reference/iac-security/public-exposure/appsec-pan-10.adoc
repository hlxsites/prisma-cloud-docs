== End-of-session logging disabled on Palo Alto Networks security policies

=== Rule Details

[cols="1,3"]
|===
|Cortex AppSec Rule ID |APPSEC_PAN_10
|Category |PUBLIC_EXPOSURE-ENCRYPTION_AND_PROTOCOLS
|Provider |
|Severity |LOW
|Framework |Ansible
|Mapped CSPM/KSPM Rule |None
|===


=== Description

This policy checks whether security policies in Palo Alto Networks devices are configured to log at the end of a session. End-of-session logging is crucial for maintaining comprehensive security logs, providing valuable information for auditing and forensic analysis.

=== Fix - Buildtime

*Palo Alto Networks*

* *Resource:* panos_security_rule
* *Attribute:* log_end

To mitigate this risk, ensure that the `log_end` attribute in your `panos_security_rule` resources is either set to 'true' or not set at all (since the default value is true).

Secure Code Example:

[source,yaml]
----
- name: Example
  ...
  tasks:
    - name: Security
      paloaltonetworks.panos.panos_security_rule:
        ...
        log_setting: 'default'
-        log_end: false
+        log_end: true
----

In this example, `log_end`` is set to true for each security rule, facilitating comprehensive logging and enhancing the security posture through better visibility into session activities.

