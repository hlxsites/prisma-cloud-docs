== Azure CDN Doesn't Disable HTTP Endpoint misconfiguration detected in code
// Ensure the Azure CDN disables the HTTP endpoint.

=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_197
|Category |Public Exposure - APIs
|Provider |Azure
|Severity |MEDIUM
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===
 

*Description*

Azure Content Delivery Network (CDN) allows for the caching and acceleration of web traffic. It's essential to secure the CDN endpoints to ensure that your content is not tampered with while in transit.

Enabling only HTTPS traffic ensures encrypted transmission, reducing the chances of a Man-in-the-Middle (MitM) attack or data being sent in clear text.

This policy checks that Azure CDN endpoints have disabled the HTTP endpoint, ensuring all connections are made over HTTPS.


=== How to Fix

*Terraform*

*Resource:* 
- azurerm_cdn_endpoint

*Arguments:* 
- is_http_allowed

[source,terraform]
----
resource "azurerm_cdn_endpoint" "example" {
  name                = "example-cdn-endpoint"
  # ... other configurations ...

+ is_http_allowed = false

  # ... other configurations ...
}
----

