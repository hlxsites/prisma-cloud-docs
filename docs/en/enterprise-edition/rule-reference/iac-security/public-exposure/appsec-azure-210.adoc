== Azure Cognitive Search With Global IP Allowance
// Ensure Azure Cognitive Search service allowed IPs does not give public access.

=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_210
|Category |Public Exposure - APIs
|Provider |Azure
|Severity |MEDIUM
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===


=== Fix - Buildtime

*Terraform*

*Resource:* 
- azurerm_search_service

*Arguments:* 
- allowed_ips

[source,terraform]
----
resource "azurerm_search_service" "example" {
  name                = "example-search-service"
  # ... other configurations ...

+ allowed_ips = [
+   "192.168.1.0/24",   # A specific trusted CIDR range.
+   # ... other allowed IPs ...
+ ]

  # ... other configurations ...
}
----
