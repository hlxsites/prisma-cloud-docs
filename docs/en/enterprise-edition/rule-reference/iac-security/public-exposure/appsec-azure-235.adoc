
== Azure Container Instance environment variable with regular value type

=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_235
|Category |PUBLIC_EXPOSURE-ENCRYPTION_AND_PROTOCOLS
|Provider |AZURE
|Severity |LOW
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |e82c581e-41af-46a9-a708-c5a2c3935c02
|===


=== Description

This policy checks for Azure Container Instances (ACI) instances where environment variables are configured with regular values instead of using the secure values property.
Objects with secure values are designed to safeguard sensitive information such as passwords or keys for your application. Using secure values for environment variables is a more secure and flexible practice compared to embedding them in your container's image.


=== Fix - Buildtime

*Terraform*

* *Resource:* azurerm_container_group
* *Arguments:* environment_variables

To fix this issue, ensure that environment variables in your Azure container are securely configured, avoiding the use of regular environment variables. Consider using 'secure_environment_variables' or alternative methods to enhance the security of your environment variables. It is recommended to specify the 'secureValue' property instead of the regular 'value' for the variable's type.

[source,go]
----
resource "azurerm_container_group" "fail_1" {
  ...

  init_container {
    ...
-    environment_variables = {
-      ENV_INIT_FAIL_1 = random_string.pud-random-str
-    }
 }
}
----

