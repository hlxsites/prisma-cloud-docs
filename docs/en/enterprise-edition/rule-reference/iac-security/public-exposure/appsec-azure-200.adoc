== Azure CDN Using Outdated TLS Encryption
// Ensure the Azure CDN endpoint is using the latest version of TLS encryption.

=== Rule Details

[cols="1,3"]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_200
|Category |PUBLIC_EXPOSURE-ENCRYPTION_AND_PROTOCOLS
|Provider |AZURE
|Severity |MEDIUM
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===


=== Fix - Buildtime

*Terraform*

*Resource:* 
- azurerm_cdn_endpoint_custom_domain

*Arguments:* 
- cdn_managed_https or user_managed_https

[source,terraform]
----
resource "azurerm_cdn_endpoint_custom_domain" "example" {
  name                = "example-cdn-custom-domain"
  # ... other configurations ...

  cdn_managed_https {
    # ... other configurations ...
+   tls_version = "TLS12"
    # ... other configurations ...
  }

  # or 

  user_managed_https {
    # ... other configurations ...
+   tls_version = "TLS12"
    # ... other configurations ...
  }

  # ... other configurations ...
}
----

