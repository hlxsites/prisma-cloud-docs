== Azure CDN Using Outdated TLS Encryption misconfiguration detected in code
// Ensure the Azure CDN endpoint is using the latest version of TLS encryption.

=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_200
|Category - Subcategory |Public Exposure - APIs
|Provider |Azure
|Severity |MEDIUM
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===


*Description*

Azure Content Delivery Network (CDN) is a distributed network of servers that can efficiently deliver web content to users. Content Delivery Network (CDN) provides developers with a global solution for rapidly delivering high-bandwidth content by caching blobs and static content of compute instances at physical nodes in the United States and internationally.

This rule ensures that the Azure CDN endpoint uses the latest version of the TLS encryption for its custom domain, helping to secure data in transit against potential man-in-the-middle attacks and vulnerabilities associated with older TLS versions.


=== How to Fix

*Terraform*

*Resource:* 
- azurerm_cdn_endpoint_custom_domain

*Arguments:* 
- cdn_managed_https or user_managed_https

[source,terraform]
----
resource "azurerm_cdn_endpoint_custom_domain" "example" {
  name                = "example-cdn-custom-domain"
  # ... other configurations ...

  cdn_managed_https {
    # ... other configurations ...
+   tls_version = "TLS12"
    # ... other configurations ...
  }

  # or 

  user_managed_https {
    # ... other configurations ...
+   tls_version = "TLS12"
    # ... other configurations ...
  }

  # ... other configurations ...
}
----

