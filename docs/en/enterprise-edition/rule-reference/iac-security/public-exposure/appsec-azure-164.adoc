== Azure Container Registry (ACR) Isn't Configured to Use Signed/Trusted Images
// Ensures that Azure Container Registry (ACR) is configured to use signed or trusted images

=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_164
|Category |PUBLIC_EXPOSURE - ENCRYPTION_AND_PROTOCOLS
|Provider |Azure
|Severity |MEDIUM
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===


=== Description

Using signed or trusted images ensures that the images being used in your deployments are verified and not tampered with. Enabling this feature in Azure Container Registry adds a layer of security by ensuring only signed images can be pulled and run.

This policy checks whether Azure Container Registry has trust policy enabled for signed images.

=== Fix - Buildtime

*Terraform*

* *Resource:* azurerm_container_registry
* *Arguments:* trust_policy_enabled

[source,terraform]
----
resource "azurerm_container_registry" "example" {
  name                     = "exampleContainerRegistry"
  resource_group_name      = azurerm_resource_group.example.name
  location                 = azurerm_resource_group.example.location
  sku                      = "Standard"
  admin_enabled            = false

  # If using azurerm version below 4.0
+ trust_policy {
+   enabled = true
+ }

  # If using azurerm version 4.0 and above
+ trust_policy_enabled     = true
}
----
