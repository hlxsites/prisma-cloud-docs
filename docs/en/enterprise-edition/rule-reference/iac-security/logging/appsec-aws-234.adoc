== AWS ACM certificates does not have logging preference


=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AWS_234
|Category |Logging - Disabled or Missing
|Provider |AWS
|Severity |LOW
|Framework |Terraform
|Mapped CSPM/KSPM Rule |None
|===


=== Description 


To guard against SSL/TLS certificates that are issued by mistake or by a compromised CA, some browsers like Chrome require that public certificates issued for a domain be recorded in a certificate transparency log.
The domain name is recorded, but not the private key.
Certificates that are not logged typically generate an error in the browser.

////
=== Fix - Runtime


Console


It is not possible to adjust transparency logging via console.


CLI




[source,shell]
----
{
 "aws acm request-certificate \\
--domain-name example.com \\
--validation-method DNS \\
--options CertificateTransparencyLoggingPreference=ENABLED \",
}
----
////

=== Fix - Buildtime


*CloudFormation* 




[source,yaml]
----
Resources: 
  Example: 
    Type: "AWS::CertificateManager::Certificate"
    Properties: 
      DomainName: example.com
      ValidationMethod: DNS
+     CertificateTransparencyLoggingPreference: ENABLED
----


*Terraform* 




[source,go]
----
resource "aws_acm_certificate" "example" {
  domain_name       = "example.com"
  validation_method = "DNS"

+ options {
+   certificate_transparency_logging_preference = "ENABLED"
+ }
}
----
