== Server Parameter 'log_retention' is Set to 'OFF' for PostgreSQL Database Server misconfiguration detected in code

=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AZURE_146
|Category |Logging - Retention
|Provider |Azure
|Severity |LOW
|Framework |Terraform, Terraform Plan
|Mapped CSPM/KSPM Rule |None
|===
 


*Description*

Log retention is crucial for auditing, security, and compliance reasons. The retention of logs ensures that you can review events and changes over time, which might be necessary for auditing or troubleshooting. This policy checks whether the PostgreSQL Database Server has enabled the log retention setting.

=== How to Fix

*Terraform*

* *Resource:* azurerm_postgresql_configuration
* *Arguments:* name, value

[source,go]
----
resource "azurerm_postgresql_configuration" "example" {
  name                = "log_retention"
  server_id           = azurerm_postgresql_server.example.id
+ value               = "on"
}
----
