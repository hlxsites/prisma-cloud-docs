== AWS Redshift database does not have audit logging enabled misconfiguration detected in code


=== Rule Details

[cols="1,2"]
|===
|Cortex AppSec Rule ID |APPSEC_AWS_71
|Category - Subcategory |Logging - Disabled or Missing
|Provider |AWS
|Severity |LOW
|Framework |CloudFormation, Terraform, Terraform Plan, Serverless
|Mapped CSPM/KSPM Rule |91c941aa-d110-4b33-9934-aadd86b1a4d9
|===
 



=== Impact
Amazon Redshift logs information about connections and user activities in your database.
These logs help you to monitor the database for security and troubleshooting purposes, a process often referred to as database auditing.
The logs are stored in Amazon S3 buckets.
These provide convenient access with data security features for users who are responsible for monitoring activities in the database.
Enabling S3 bucket logging on Redshift databases allows you to capture all events which may affect the database, this is useful in security and incident response workflows.


=== How to Fix


*Terraform* 


* *Resource:* aws_redshift_cluster
* *Arguments:* logging/enable is set to true.
An example terraform definition of an Amazon Redshift database with logging enabled, resolving the violation:


[source,go]
----
resource "aws_redshift_cluster" "default" {
    ...
    cluster_type       = "single-node"
+   logging {
+     enable = "true"
+   }
  }
----


*CloudFormation* 


* *Resource:* AWS::Redshift::Cluster
* *Arguments:* Properties.BucketName


[source,yaml]
----
Type: "AWS::Redshift::Cluster"
    Properties:
      ...
+     LoggingProperties:
+       BucketName: "your_bucket"
----
