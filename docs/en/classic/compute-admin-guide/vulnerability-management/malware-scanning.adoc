[#malware-scanning]
== Malware Scanning

Besides detecting software vulnerabilities (CVEs) and compliance issues (such as images configured to run as root), Prisma Cloud also detects malware in your container images.
No special configuration is required to enable this feature.
Prisma Cloud supports agent-based and agentless malware scanning

[#agent-based-malware-scanning]
=== Agent-based Malware Scanning

To perform malware analysis, Prisma Cloud uses the inputs from:

* xref:prisma-cloud-vulnerability-feed.adoc[Intelligence Stream]—Searches the feed for a match against the hash for the executable.
* xref:../configure/wildfire.adoc[Wildfire service]—Queries the WildFire service for a match against the hash for the executable. If there is no match and upload is enabled, the file is uploaded for analysis. 
+
NOTE: WildFire is only supported for image scanning when used in CI.
* Custom feeds—Searches for a match for the executable hash against any xref:../configure/custom-feeds.adoc#malware-signatures[custom malware data you import] for image scanning.

NOTE: Malware scanning and detection is supported for Linux container images only.
Windows containers are not supported.


[.task]
=== Detecting malware

The image scanner looks for malware in binaries in the image layers, including the base layer. When Prisma Cloud detects malware in an image, it includes the malware information as a compliance violation in the image scan report.

To review the results of an image scan:

[.procedure]
. Open Console, then go to *Monitor > Vulnerabilities > Images*.

. Click on an image to get a detailed report from the last image scan.

. In the detailed report, click on the *Compliance* tab.
+
The vulnerability ID 422 in issues means that a Defender detected a file with an md5 signature of known malware in your image.

[#agentless-malware-scanning]
=== Agentless Malware Scans

Agentless scanning detects malware through an integration with Palo Alto Networks Advanced WildFire, the industry's leading malware scanning engine.
Malware scanning is supported across all Cloud Service Providers for Linux and Windows hosts and container images, covering files suspected as Malware or Grayware.

Agentless scanning detects malware in binaries and shared libraries on both Linux and Windows operating systems regardless of operating system  providing comprehensive protection. For example, agentless scanning detects malicious ELF files on Windows machines.

Agentless scanning uses Palo Alto Networks Advanced WildFire to scan your container images and hosts for malware.
When agentless scanning checks your hosts and container images for security risks, it calculates the MD5 signatures of the relevant files for malware analysis.
Agentless malware scans use the following process.

. The agentless scan concludes for vulnerabilities and compliance issues.

. Prisma Cloud sends the list of signatures to WildFire to determine their verdicts.

. While a workload is pending verdicts from WildFire, a relevant status shows up in the workload scan results.
+
The possible verdicts are:
+
* Malware
* Grayware
* Benign
+
By default, Prisma Cloud only reports files flagged as malware.

. All verdicts are received and the appropriate status is set on the workload malware status.

Once an agentless scan is complete, go to *Compute > Monitor > Compliance > Images* or to *Compute > Monitor > Compliance > Host* to see the results for a deployed image or a host.
Go to *Compute > Monitor > Compliance* to find the malware scanning results in the Prisma Cloud Compliance Explorer after an agentless scan was completed successfully.

Use the following compliance check IDs in the compliance explorer to identify malware scanning results.
• ID #454 - Host file is flagged as malware by WildFire.
• ID #455 - Image file is flagged as malware by WildFire.

You can filter the results by *Category: Prisma Cloud Labs* to show both image and host file results.
It can take some time for the Malware status to appear in the Host and Image details and the status shows as Pending until Advanced WildFire reports the verdicts.
The malware scanning happens asynchronously from the vulnerability and compliance scanning.
You can see the results of a completed agentless scan for vulnerability and compliance issues in your deployment before the Malware status is resolved.
